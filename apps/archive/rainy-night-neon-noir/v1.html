<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rainy Night Neon Noir</title>
    <meta name="description" content="Moody urban scenes with rain-slicked streets reflecting flickering neon signs">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { background: #0a0a12; overflow: hidden; font-family: monospace; }
        #canvas { position: fixed; top: 0; left: 0; }
        #controls {
            position: fixed; top: 20px; left: 20px; background: rgba(10,10,20,0.9);
            padding: 20px; border-radius: 10px; border: 1px solid rgba(255,100,150,0.3);
            color: #ff9090; z-index: 100;
        }
        h3 { margin-bottom: 15px; color: #ff6090; }
        .control-row { margin: 12px 0; }
        label { display: block; font-size: 11px; margin-bottom: 5px; opacity: 0.7; }
        input[type="range"] { width: 150px; }
        #info { position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); color: rgba(255,100,150,0.5); font-size: 12px; }
    </style>
</head>
<body>
    <canvas id="canvas"></canvas>
    <div id="controls">
        <h3>Neon Noir</h3>
        <div class="control-row">
            <label>Rain Intensity</label>
            <input type="range" id="rain" min="0" max="100" value="70">
        </div>
        <div class="control-row">
            <label>Sign Decay</label>
            <input type="range" id="decay" min="0" max="100" value="30">
        </div>
        <div class="control-row">
            <label>Reflection Strength</label>
            <input type="range" id="reflect" min="0" max="100" value="60">
        </div>
    </div>
    <div id="info">Watch the rain fall on neon-lit streets</div>
    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        let W, H;
        function resize() { W = canvas.width = innerWidth; H = canvas.height = innerHeight; }
        resize(); window.onresize = resize;

        let rainIntensity = 70;
        let signDecay = 30;
        let reflectStrength = 60;
        let raindrops = [];
        let puddles = [];
        let time = 0;

        const signs = [
            { text: 'HOTEL', x: 0.2, color: '#ff0066', flicker: 0.02 },
            { text: 'BAR', x: 0.5, color: '#00ffff', flicker: 0.05 },
            { text: 'OPEN', x: 0.75, color: '#ff6600', flicker: 0.03 }
        ];

        class Raindrop {
            constructor() {
                this.reset();
            }
            reset() {
                this.x = Math.random() * W;
                this.y = -10;
                this.speed = 10 + Math.random() * 10;
                this.length = 10 + Math.random() * 20;
            }
            update() {
                this.y += this.speed;
                this.x -= 2;
                if (this.y > H * 0.7) {
                    if (Math.random() < 0.3) {
                        puddles.push({ x: this.x, y: H * 0.7, size: 0, maxSize: 5 + Math.random() * 10 });
                    }
                    this.reset();
                }
            }
            draw() {
                ctx.beginPath();
                ctx.moveTo(this.x, this.y);
                ctx.lineTo(this.x + 2, this.y + this.length);
                ctx.strokeStyle = 'rgba(150, 170, 200, 0.4)';
                ctx.lineWidth = 1;
                ctx.stroke();
            }
        }

        function initRain() {
            raindrops = [];
            for (let i = 0; i < 200; i++) {
                const drop = new Raindrop();
                drop.y = Math.random() * H;
                raindrops.push(drop);
            }
        }

        function drawSky() {
            const gradient = ctx.createLinearGradient(0, 0, 0, H);
            gradient.addColorStop(0, '#0a0a15');
            gradient.addColorStop(0.5, '#151520');
            gradient.addColorStop(1, '#0a0a12');
            ctx.fillStyle = gradient;
            ctx.fillRect(0, 0, W, H);
        }

        function drawBuildings() {
            for (let i = 0; i < 10; i++) {
                const x = i * W / 10;
                const h = 100 + Math.random() * 200;
                ctx.fillStyle = '#0a0a0a';
                ctx.fillRect(x, H * 0.3 - h, W / 10 - 5, h + H * 0.4);
                for (let wy = 0; wy < h; wy += 20) {
                    for (let wx = 5; wx < W / 10 - 10; wx += 15) {
                        if (Math.random() > 0.5) {
                            ctx.fillStyle = 'rgba(255, 200, 100, 0.3)';
                            ctx.fillRect(x + wx, H * 0.3 - h + wy + 5, 8, 12);
                        }
                    }
                }
            }
        }

        function drawNeonSign(sign, yPos) {
            const x = sign.x * W;
            const isOn = Math.random() > sign.flicker * (signDecay / 30);
            const decay = signDecay / 100;
            if (isOn || decay < 0.5) {
                const alpha = isOn ? (1 - decay * 0.5) : 0.3;
                ctx.font = 'bold 48px monospace';
                ctx.textAlign = 'center';
                ctx.shadowBlur = 30;
                ctx.shadowColor = sign.color;
                ctx.fillStyle = sign.color.replace(')', ', ' + alpha + ')').replace('rgb', 'rgba').replace('#', '');
                ctx.fillStyle = sign.color;
                ctx.globalAlpha = alpha;
                ctx.fillText(sign.text, x, yPos);
                ctx.globalAlpha = 1;
                ctx.shadowBlur = 0;
            }
        }

        function drawStreet() {
            ctx.fillStyle = '#1a1a20';
            ctx.fillRect(0, H * 0.7, W, H * 0.3);
            ctx.fillStyle = 'rgba(255, 255, 100, 0.1)';
            ctx.fillRect(0, H * 0.85, W, 3);
        }

        function drawReflections() {
            const reflectAlpha = reflectStrength / 100 * 0.3;
            signs.forEach(sign => {
                const x = sign.x * W;
                const gradient = ctx.createLinearGradient(x, H * 0.7, x, H);
                gradient.addColorStop(0, sign.color.replace(')', ', ' + reflectAlpha + ')').replace('rgb', 'rgba'));
                gradient.addColorStop(1, 'transparent');
                ctx.fillStyle = gradient;
                ctx.fillRect(x - 100, H * 0.7, 200, H * 0.3);
            });
        }

        function drawPuddles() {
            puddles = puddles.filter(p => {
                p.size += 0.5;
                if (p.size < p.maxSize) {
                    ctx.beginPath();
                    ctx.ellipse(p.x, p.y, p.size * 2, p.size * 0.5, 0, 0, Math.PI * 2);
                    ctx.strokeStyle = 'rgba(150, 170, 200, ' + (1 - p.size / p.maxSize) * 0.3 + ')';
                    ctx.stroke();
                    return true;
                }
                return false;
            });
        }

        function animate() {
            time++;
            drawSky();
            drawBuildings();
            signs.forEach((s, i) => drawNeonSign(s, H * 0.25 + i * 10));
            drawStreet();
            drawReflections();
            const activeDrops = Math.floor(rainIntensity * 2);
            for (let i = 0; i < activeDrops && i < raindrops.length; i++) {
                raindrops[i].update();
                raindrops[i].draw();
            }
            drawPuddles();
            requestAnimationFrame(animate);
        }

        document.getElementById('rain').oninput = e => rainIntensity = parseInt(e.target.value);
        document.getElementById('decay').oninput = e => signDecay = parseInt(e.target.value);
        document.getElementById('reflect').oninput = e => reflectStrength = parseInt(e.target.value);

        initRain();
        animate();
    </script>
</body>
</html>