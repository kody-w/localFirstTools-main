<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lava Lamp Chemistry Lab</title>
    <meta name="description" content="Interactive lava lamp physics simulation with adjustable density, viscosity, and heat">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { background: #0a0a15; min-height: 100vh; font-family: monospace; display: flex; align-items: center; justify-content: center; overflow: hidden; }
        #lamp-container {
            width: 200px; height: 500px; position: relative;
        }
        #lamp {
            width: 100%; height: 100%; position: relative;
        }
        #glass {
            position: absolute; top: 60px; left: 20px; right: 20px; bottom: 80px;
            background: linear-gradient(90deg, rgba(0,0,50,0.3), rgba(0,0,100,0.2), rgba(0,0,50,0.3));
            border-radius: 10px; overflow: hidden;
            box-shadow: inset 0 0 30px rgba(0,0,0,0.5), 0 0 20px rgba(100,50,150,0.3);
        }
        #canvas { width: 100%; height: 100%; }
        #cap {
            position: absolute; top: 0; left: 10px; right: 10px; height: 70px;
            background: linear-gradient(180deg, #444, #222);
            border-radius: 10px 10px 0 0;
        }
        #base {
            position: absolute; bottom: 0; left: 0; right: 0; height: 90px;
            background: linear-gradient(180deg, #333, #111);
            border-radius: 0 0 20px 20px;
        }
        #heat-coil {
            position: absolute; bottom: 20px; left: 30px; right: 30px; height: 30px;
            background: linear-gradient(180deg, #ff6600, #ff3300);
            border-radius: 5px; opacity: 0.5; transition: opacity 0.5s;
        }
        #controls {
            position: fixed; left: 30px; top: 50%; transform: translateY(-50%);
            background: rgba(20,20,40,0.9); padding: 25px; border-radius: 10px;
            border: 1px solid rgba(150,100,200,0.3); color: #c0a0e0;
        }
        h3 { margin-bottom: 20px; color: #e0c0ff; }
        .control-row { margin: 15px 0; }
        label { display: block; font-size: 11px; margin-bottom: 5px; opacity: 0.8; }
        input[type="range"] { width: 150px; }
        .value { float: right; font-size: 12px; color: #ff9966; }
        #stats {
            position: fixed; right: 30px; top: 50%; transform: translateY(-50%);
            background: rgba(20,20,40,0.9); padding: 20px; border-radius: 10px;
            border: 1px solid rgba(150,100,200,0.3); color: #c0a0e0;
        }
        .stat { margin: 10px 0; }
        .stat-value { font-size: 20px; color: #ff9966; }
        .stat-label { font-size: 10px; opacity: 0.7; }
    </style>
</head>
<body>
    <div id="controls">
        <h3>Lava Chemistry</h3>
        <div class="control-row">
            <label>Wax Density <span class="value" id="density-val">0.95</span></label>
            <input type="range" id="density" min="85" max="105" value="95">
        </div>
        <div class="control-row">
            <label>Liquid Viscosity <span class="value" id="viscosity-val">50</span></label>
            <input type="range" id="viscosity" min="10" max="100" value="50">
        </div>
        <div class="control-row">
            <label>Heat Intensity <span class="value" id="heat-val">70%</span></label>
            <input type="range" id="heat" min="0" max="100" value="70">
        </div>
        <div class="control-row">
            <label>Blob Color <span class="value" id="color-val">Orange</span></label>
            <input type="range" id="color" min="0" max="360" value="30">
        </div>
    </div>
    <div id="lamp-container">
        <div id="lamp">
            <div id="cap"></div>
            <div id="glass"><canvas id="canvas"></canvas></div>
            <div id="base"><div id="heat-coil"></div></div>
        </div>
    </div>
    <div id="stats">
        <div class="stat"><div class="stat-value" id="blob-count">0</div><div class="stat-label">Active Blobs</div></div>
        <div class="stat"><div class="stat-value" id="temp">25C</div><div class="stat-label">Wax Temperature</div></div>
    </div>
    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        canvas.width = 160;
        canvas.height = 360;
        const W = canvas.width, H = canvas.height;

        let density = 0.95;
        let viscosity = 50;
        let heat = 70;
        let blobHue = 30;
        let blobs = [];
        let waxTemp = 25;

        class Blob {
            constructor(x, y, size) {
                this.x = x; this.y = y;
                this.size = size;
                this.vy = 0;
                this.temp = 25;
                this.wobble = Math.random() * Math.PI * 2;
            }
            update() {
                const heatZone = H - 50;
                if (this.y > heatZone) {
                    this.temp += (heat * 0.02);
                } else {
                    this.temp -= 0.1;
                }
                this.temp = Math.max(25, Math.min(100, this.temp));
                const expansion = 1 + (this.temp - 25) / 200;
                const effectiveDensity = density / expansion;
                const buoyancy = (1 - effectiveDensity) * 0.1;
                const drag = viscosity / 1000;
                this.vy += buoyancy;
                this.vy *= (1 - drag);
                this.y -= this.vy;
                this.y = Math.max(this.size, Math.min(H - this.size, this.y));
                this.wobble += 0.05;
                this.x += Math.sin(this.wobble) * 0.5;
                this.x = Math.max(this.size + 10, Math.min(W - this.size - 10, this.x));
            }
            draw() {
                const glow = this.temp / 100;
                const gradient = ctx.createRadialGradient(this.x, this.y, 0, this.x, this.y, this.size * 1.5);
                gradient.addColorStop(0, "hsla(" + blobHue + ", 100%, 60%, 0.9)");
                gradient.addColorStop(0.5, "hsla(" + blobHue + ", 90%, 50%, 0.7)");
                gradient.addColorStop(1, "hsla(" + blobHue + ", 80%, 30%, 0)");
                ctx.beginPath();
                const wobbleSize = this.size * (1 + Math.sin(this.wobble * 2) * 0.1);
                ctx.ellipse(this.x, this.y, wobbleSize * 0.9, wobbleSize * 1.1, 0, 0, Math.PI * 2);
                ctx.fillStyle = gradient;
                ctx.fill();
                ctx.beginPath();
                ctx.ellipse(this.x - this.size * 0.3, this.y - this.size * 0.3, this.size * 0.2, this.size * 0.15, -0.5, 0, Math.PI * 2);
                ctx.fillStyle = "rgba(255,255,255,0.3)";
                ctx.fill();
            }
        }

        function initBlobs() {
            blobs = [];
            for (let i = 0; i < 8; i++) {
                blobs.push(new Blob(
                    30 + Math.random() * (W - 60),
                    H - 30 - Math.random() * 50,
                    15 + Math.random() * 20
                ));
            }
        }

        function mergeBlobs() {
            for (let i = 0; i < blobs.length; i++) {
                for (let j = i + 1; j < blobs.length; j++) {
                    const dx = blobs[i].x - blobs[j].x;
                    const dy = blobs[i].y - blobs[j].y;
                    const dist = Math.hypot(dx, dy);
                    if (dist < blobs[i].size + blobs[j].size - 10) {
                        blobs[i].size = Math.sqrt(blobs[i].size * blobs[i].size + blobs[j].size * blobs[j].size);
                        blobs[i].size = Math.min(50, blobs[i].size);
                        blobs.splice(j, 1);
                        j--;
                    }
                }
            }
        }

        function splitBlobs() {
            blobs.forEach((blob, i) => {
                if (blob.size > 30 && blob.y < 50 && Math.random() < 0.02) {
                    const newSize = blob.size * 0.6;
                    blob.size = newSize;
                    blobs.push(new Blob(blob.x + 10, blob.y, newSize * 0.8));
                }
            });
        }

        function animate() {
            ctx.fillStyle = "rgba(0, 0, 30, 0.95)";
            ctx.fillRect(0, 0, W, H);
            const heatGradient = ctx.createLinearGradient(0, H, 0, H - 80);
            heatGradient.addColorStop(0, "rgba(255, 100, 0, " + (heat / 300) + ")");
            heatGradient.addColorStop(1, "transparent");
            ctx.fillStyle = heatGradient;
            ctx.fillRect(0, 0, W, H);
            blobs.forEach(b => { b.update(); b.draw(); });
            mergeBlobs();
            splitBlobs();
            waxTemp = blobs.reduce((sum, b) => sum + b.temp, 0) / blobs.length;
            document.getElementById('blob-count').textContent = blobs.length;
            document.getElementById('temp').textContent = Math.round(waxTemp) + "C";
            document.getElementById('heat-coil').style.opacity = heat / 100;
            requestAnimationFrame(animate);
        }

        document.getElementById('density').oninput = e => {
            density = e.target.value / 100;
            document.getElementById('density-val').textContent = density.toFixed(2);
        };
        document.getElementById('viscosity').oninput = e => {
            viscosity = parseInt(e.target.value);
            document.getElementById('viscosity-val').textContent = viscosity;
        };
        document.getElementById('heat').oninput = e => {
            heat = parseInt(e.target.value);
            document.getElementById('heat-val').textContent = heat + "%";
        };
        document.getElementById('color').oninput = e => {
            blobHue = parseInt(e.target.value);
            const colors = ['Red', 'Orange', 'Yellow', 'Green', 'Cyan', 'Blue', 'Purple', 'Pink'];
            document.getElementById('color-val').textContent = colors[Math.floor(blobHue / 45) % 8];
        };

        initBlobs();
        animate();
    </script>
</body>
</html>