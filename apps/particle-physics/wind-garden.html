<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wind Garden</title>
    <meta name="description" content="Plant wind chimes of different materials and lengths, then control the wind to create harmonies or haunting melodies">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { background: #0f1520; min-height: 100vh; font-family: 'Georgia', serif; color: #90a0b0; overflow: hidden; }
        #canvas { position: fixed; top: 0; left: 0; cursor: crosshair; }
        #controls {
            position: fixed; top: 20px; left: 20px; background: rgba(15,21,32,0.95);
            padding: 20px; border-radius: 10px; border: 1px solid rgba(100,140,180,0.3);
            z-index: 100;
        }
        h3 { margin-bottom: 15px; color: #a0c0e0; font-weight: normal; }
        .control-row { margin: 10px 0; }
        label { display: block; font-size: 11px; margin-bottom: 5px; opacity: 0.8; }
        input[type="range"] { width: 140px; }
        .value { float: right; color: #b0d0f0; font-size: 12px; }
        .material-btn { display: inline-block; padding: 6px 10px; margin: 2px; border-radius: 4px; cursor: pointer; border: 1px solid rgba(100,140,180,0.4); font-size: 11px; }
        .material-btn.active { border-color: white; background: rgba(100,140,180,0.3); }
        button {
            display: block; width: 100%; padding: 10px; margin: 6px 0;
            background: rgba(60,100,140,0.4); border: 1px solid rgba(100,140,180,0.4);
            color: #90b0d0; cursor: pointer; border-radius: 6px; font-family: inherit;
        }
        #stats { position: fixed; top: 20px; right: 20px; font-size: 12px; color: #607090; z-index: 100; text-align: right; }
        #info { position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); font-size: 12px; opacity: 0.5; z-index: 100; }
    </style>
</head>
<body>
    <canvas id="canvas"></canvas>
    <div id="controls">
        <h3>Wind Garden</h3>
        <div class="control-row">
            <label>Material</label>
            <div class="material-btn active" data-material="crystal">Crystal</div>
            <div class="material-btn" data-material="bamboo">Bamboo</div>
            <div class="material-btn" data-material="metal">Metal</div>
        </div>
        <div class="control-row">
            <label>Chime Length <span class="value" id="length-val">50</span></label>
            <input type="range" id="length" min="30" max="100" value="50">
        </div>
        <button id="wind-btn">Drag canvas for wind</button>
        <button id="clear-btn">Clear Garden</button>
    </div>
    <div id="stats">
        <div>Chimes: <span id="chime-count">0</span></div>
        <div>Wind: <span id="wind-strength">Calm</span></div>
    </div>
    <div id="info">Click to plant chimes | Drag across canvas to create wind</div>
    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        let W, H;
        function resize() { W = canvas.width = innerWidth; H = canvas.height = innerHeight; }
        resize(); window.onresize = resize;
        
        let selectedMaterial = 'crystal';
        let chimeLength = 50;
        let time = 0;
        let windX = 0, windY = 0;
        let isDragging = false;
        let lastMouseX = 0, lastMouseY = 0;
        
        const chimes = [];
        const windParticles = [];
        
        const MATERIALS = {
            crystal: { hue: 200, sustain: 0.98, brightness: 80, name: 'Crystal' },
            bamboo: { hue: 40, sustain: 0.9, brightness: 50, name: 'Bamboo' },
            metal: { hue: 220, sustain: 0.995, brightness: 70, name: 'Metal' }
        };
        
        class Chime {
            constructor(x, y, length, material) {
                this.x = x;
                this.y = y;
                this.length = length;
                this.material = MATERIALS[material];
                this.materialType = material;
                this.angle = 0;
                this.velocity = 0;
                this.energy = 0;
                this.swingPhase = Math.random() * Math.PI * 2;
            }
            
            update() {
                const windForce = windX * 0.01;
                this.velocity += windForce;
                this.velocity += -this.angle * 0.05;
                this.velocity *= 0.98;
                this.angle += this.velocity;
                
                if (Math.abs(this.velocity) > 0.02) {
                    this.energy = Math.min(1, this.energy + Math.abs(this.velocity) * 0.5);
                }
                this.energy *= this.material.sustain;
                
                this.swingPhase += 0.02;
            }
            
            draw() {
                const endX = this.x + Math.sin(this.angle) * this.length;
                const endY = this.y + Math.cos(this.angle) * this.length;
                
                ctx.beginPath();
                ctx.moveTo(this.x, this.y - 10);
                ctx.lineTo(this.x, this.y);
                ctx.strokeStyle = 'rgba(100, 120, 140, 0.5)';
                ctx.lineWidth = 1;
                ctx.stroke();
                
                ctx.beginPath();
                ctx.moveTo(this.x, this.y);
                ctx.lineTo(endX, endY);
                
                const alpha = 0.4 + this.energy * 0.4;
                const lightness = this.material.brightness + this.energy * 20;
                ctx.strokeStyle = "hsla(" + this.material.hue + ", 50%, " + lightness + "%, " + alpha + ")";
                ctx.lineWidth = 4 + (100 - this.length) / 20;
                ctx.lineCap = 'round';
                ctx.stroke();
                
                if (this.energy > 0.1) {
                    const glowSize = this.energy * 20;
                    const gradient = ctx.createRadialGradient(endX, endY, 0, endX, endY, glowSize);
                    gradient.addColorStop(0, "hsla(" + this.material.hue + ", 60%, 70%, " + (this.energy * 0.5) + ")");
                    gradient.addColorStop(1, 'transparent');
                    ctx.fillStyle = gradient;
                    ctx.fillRect(endX - glowSize, endY - glowSize, glowSize * 2, glowSize * 2);
                }
                
                ctx.beginPath();
                ctx.arc(this.x, this.y, 5, 0, Math.PI * 2);
                ctx.fillStyle = 'rgba(120, 140, 160, 0.6)';
                ctx.fill();
            }
        }
        
        function createWindParticle() {
            if (Math.abs(windX) < 0.5 && Math.abs(windY) < 0.5) return;
            
            windParticles.push({
                x: windX > 0 ? 0 : W,
                y: Math.random() * H,
                vx: windX * 0.5,
                vy: windY * 0.2,
                life: 1
            });
        }
        
        function drawBackground() {
            const gradient = ctx.createLinearGradient(0, 0, 0, H);
            gradient.addColorStop(0, '#1a2535');
            gradient.addColorStop(0.7, '#0f1520');
            gradient.addColorStop(1, '#0a1015');
            ctx.fillStyle = gradient;
            ctx.fillRect(0, 0, W, H);
            
            for (let i = 0; i < 50; i++) {
                const x = (i * 137 + time * 0.1) % W;
                const y = (i * 89) % (H * 0.4);
                const twinkle = Math.sin(time + i) * 0.3 + 0.7;
                ctx.beginPath();
                ctx.arc(x, y, 0.5 + twinkle * 0.3, 0, Math.PI * 2);
                ctx.fillStyle = "rgba(200, 220, 255, " + (twinkle * 0.4) + ")";
                ctx.fill();
            }
        }
        
        function drawWindParticles() {
            for (let i = windParticles.length - 1; i >= 0; i--) {
                const p = windParticles[i];
                p.x += p.vx;
                p.y += p.vy;
                p.life -= 0.01;
                
                if (p.life <= 0 || p.x < 0 || p.x > W) {
                    windParticles.splice(i, 1);
                    continue;
                }
                
                ctx.beginPath();
                ctx.moveTo(p.x, p.y);
                ctx.lineTo(p.x - p.vx * 5, p.y - p.vy * 5);
                ctx.strokeStyle = "rgba(150, 180, 200, " + (p.life * 0.3) + ")";
                ctx.lineWidth = 1;
                ctx.stroke();
            }
        }
        
        function drawRail() {
            ctx.beginPath();
            ctx.moveTo(50, 80);
            ctx.lineTo(W - 50, 80);
            ctx.strokeStyle = 'rgba(80, 100, 120, 0.4)';
            ctx.lineWidth = 4;
            ctx.stroke();
        }
        
        function getWindStrength() {
            const strength = Math.sqrt(windX * windX + windY * windY);
            if (strength < 1) return 'Calm';
            if (strength < 3) return 'Gentle';
            if (strength < 6) return 'Moderate';
            if (strength < 10) return 'Strong';
            return 'Gusting';
        }
        
        function updateStats() {
            document.getElementById('chime-count').textContent = chimes.length;
            document.getElementById('wind-strength').textContent = getWindStrength();
        }
        
        function animate() {
            time += 0.016;
            
            windX *= 0.98;
            windY *= 0.98;
            
            if (Math.random() < 0.1) createWindParticle();
            
            drawBackground();
            drawWindParticles();
            drawRail();
            
            chimes.forEach(c => {
                c.update();
                c.draw();
            });
            
            updateStats();
            
            requestAnimationFrame(animate);
        }
        
        canvas.onmousedown = e => {
            if (e.clientX < 200 && e.clientY < 300) return;
            isDragging = true;
            lastMouseX = e.clientX;
            lastMouseY = e.clientY;
        };
        
        canvas.onmousemove = e => {
            if (!isDragging) return;
            
            windX += (e.clientX - lastMouseX) * 0.1;
            windY += (e.clientY - lastMouseY) * 0.1;
            
            windX = Math.max(-15, Math.min(15, windX));
            windY = Math.max(-10, Math.min(10, windY));
            
            lastMouseX = e.clientX;
            lastMouseY = e.clientY;
        };
        
        canvas.onmouseup = e => {
            if (!isDragging) {
                if (e.clientX > 200 || e.clientY > 300) {
                    chimes.push(new Chime(e.clientX, 90, chimeLength, selectedMaterial));
                }
            }
            isDragging = false;
        };
        
        document.querySelectorAll('.material-btn').forEach(btn => {
            btn.onclick = () => {
                document.querySelectorAll('.material-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                selectedMaterial = btn.dataset.material;
            };
        });
        
        document.getElementById('length').oninput = e => {
            chimeLength = parseInt(e.target.value);
            document.getElementById('length-val').textContent = e.target.value;
        };
        
        document.getElementById('clear-btn').onclick = () => {
            chimes.length = 0;
        };
        
        for (let i = 0; i < 5; i++) {
            const materials = ['crystal', 'bamboo', 'metal'];
            chimes.push(new Chime(
                200 + i * 150,
                90,
                40 + i * 15,
                materials[i % 3]
            ));
        }
        
        animate();
    </script>
</body>
</html>