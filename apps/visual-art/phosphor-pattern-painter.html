<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Phosphor Pattern Painter</title>
    <meta name="description" content="Paint with CRT phosphor trails that glow and gradually fade like vintage monitor pixels">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { background: #0a0a0a; min-height: 100vh; font-family: monospace; color: #40ff40; overflow: hidden; }
        #canvas { position: fixed; top: 0; left: 0; cursor: crosshair; }
        #scanlines { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 10; background: repeating-linear-gradient(0deg, rgba(0,0,0,0.1) 0px, rgba(0,0,0,0.1) 1px, transparent 1px, transparent 3px); }
        #controls {
            position: fixed; top: 20px; left: 20px; background: rgba(0,20,0,0.9);
            padding: 20px; border-radius: 10px; border: 1px solid rgba(0,255,0,0.3);
            z-index: 100;
        }
        h3 { margin-bottom: 15px; color: #60ff60; text-shadow: 0 0 10px #00ff00; }
        .control-row { margin: 10px 0; }
        label { display: block; font-size: 11px; margin-bottom: 5px; opacity: 0.8; }
        input[type="range"] { width: 140px; }
        .value { float: right; color: #80ff80; font-size: 12px; }
        button {
            display: block; width: 100%; padding: 8px; margin: 6px 0;
            background: rgba(0,80,0,0.5); border: 1px solid rgba(0,255,0,0.4);
            color: #40ff40; cursor: pointer; border-radius: 6px;
        }
        .color-btn { display: inline-block; width: 28px; height: 28px; margin: 3px; border-radius: 50%; cursor: pointer; border: 2px solid transparent; }
        .color-btn.active { border-color: white; }
        #info { position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); font-size: 12px; opacity: 0.5; z-index: 100; text-shadow: 0 0 5px #00ff00; }
    </style>
</head>
<body>
    <canvas id="canvas"></canvas>
    <div id="scanlines"></div>
    <div id="controls">
        <h3>Phosphor Painter</h3>
        <div class="control-row">
            <label>Persistence <span class="value" id="persist-val">85%</span></label>
            <input type="range" id="persist" min="50" max="99" value="85">
        </div>
        <div class="control-row">
            <label>Glow Intensity <span class="value" id="glow-val">70%</span></label>
            <input type="range" id="glow" min="0" max="100" value="70">
        </div>
        <div class="control-row">
            <label>Brush Size <span class="value" id="size-val">8</span></label>
            <input type="range" id="size" min="2" max="30" value="8">
        </div>
        <div class="control-row">
            <label>Phosphor Color</label>
            <div>
                <span class="color-btn active" style="background:#00ff00" data-color="green"></span>
                <span class="color-btn" style="background:#00ffff" data-color="cyan"></span>
                <span class="color-btn" style="background:#ff8800" data-color="amber"></span>
                <span class="color-btn" style="background:#ffffff" data-color="white"></span>
            </div>
        </div>
        <button id="clear-btn">Clear Screen</button>
    </div>
    <div id="info">Draw with phosphor glow | Watch trails fade like CRT pixels</div>
    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        let W, H;
        function resize() { 
            W = canvas.width = innerWidth; 
            H = canvas.height = innerHeight;
            ctx.fillStyle = '#000000';
            ctx.fillRect(0, 0, W, H);
        }
        resize(); window.onresize = resize;
        
        let persistence = 0.85;
        let glowIntensity = 0.7;
        let brushSize = 8;
        let phosphorColor = { r: 0, g: 255, b: 0 };
        let drawing = false;
        let lastX = 0, lastY = 0;
        
        const colors = {
            green: { r: 0, g: 255, b: 0 },
            cyan: { r: 0, g: 255, b: 255 },
            amber: { r: 255, g: 136, b: 0 },
            white: { r: 255, g: 255, b: 255 }
        };
        
        function drawPhosphor(x, y, size) {
            const c = phosphorColor;
            const glow = glowIntensity;
            
            for (let r = size * 2; r > 0; r -= 2) {
                const alpha = (1 - r / (size * 2)) * glow * 0.3;
                ctx.beginPath();
                ctx.arc(x, y, r, 0, Math.PI * 2);
                ctx.fillStyle = "rgba(" + c.r + ", " + c.g + ", " + c.b + ", " + alpha + ")";
                ctx.fill();
            }
            
            ctx.beginPath();
            ctx.arc(x, y, size / 2, 0, Math.PI * 2);
            ctx.fillStyle = "rgba(" + c.r + ", " + c.g + ", " + c.b + ", 1)";
            ctx.fill();
            
            ctx.beginPath();
            ctx.arc(x, y, size / 4, 0, Math.PI * 2);
            ctx.fillStyle = "rgba(255, 255, 255, 0.8)";
            ctx.fill();
        }
        
        function drawLine(x1, y1, x2, y2) {
            const dist = Math.hypot(x2 - x1, y2 - y1);
            const steps = Math.max(1, Math.floor(dist / 3));
            
            for (let i = 0; i <= steps; i++) {
                const t = i / steps;
                const x = x1 + (x2 - x1) * t;
                const y = y1 + (y2 - y1) * t;
                drawPhosphor(x, y, brushSize);
            }
        }
        
        function fade() {
            const imageData = ctx.getImageData(0, 0, W, H);
            const data = imageData.data;
            
            for (let i = 0; i < data.length; i += 4) {
                data[i] *= persistence;
                data[i + 1] *= persistence;
                data[i + 2] *= persistence;
            }
            
            ctx.putImageData(imageData, 0, 0);
        }
        
        function animate() {
            fade();
            requestAnimationFrame(animate);
        }
        
        canvas.onmousedown = e => {
            drawing = true;
            lastX = e.clientX;
            lastY = e.clientY;
            drawPhosphor(lastX, lastY, brushSize);
        };
        
        canvas.onmousemove = e => {
            if (!drawing) return;
            drawLine(lastX, lastY, e.clientX, e.clientY);
            lastX = e.clientX;
            lastY = e.clientY;
        };
        
        canvas.onmouseup = () => drawing = false;
        canvas.onmouseleave = () => drawing = false;
        
        canvas.ontouchstart = e => {
            e.preventDefault();
            drawing = true;
            const touch = e.touches[0];
            lastX = touch.clientX;
            lastY = touch.clientY;
            drawPhosphor(lastX, lastY, brushSize);
        };
        
        canvas.ontouchmove = e => {
            e.preventDefault();
            if (!drawing) return;
            const touch = e.touches[0];
            drawLine(lastX, lastY, touch.clientX, touch.clientY);
            lastX = touch.clientX;
            lastY = touch.clientY;
        };
        
        canvas.ontouchend = () => drawing = false;
        
        document.getElementById('persist').oninput = e => {
            persistence = e.target.value / 100;
            document.getElementById('persist-val').textContent = e.target.value + '%';
        };
        
        document.getElementById('glow').oninput = e => {
            glowIntensity = e.target.value / 100;
            document.getElementById('glow-val').textContent = e.target.value + '%';
        };
        
        document.getElementById('size').oninput = e => {
            brushSize = parseInt(e.target.value);
            document.getElementById('size-val').textContent = brushSize;
        };
        
        document.querySelectorAll('.color-btn').forEach(btn => {
            btn.onclick = () => {
                document.querySelectorAll('.color-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                phosphorColor = colors[btn.dataset.color];
            };
        });
        
        document.getElementById('clear-btn').onclick = () => {
            ctx.fillStyle = '#000000';
            ctx.fillRect(0, 0, W, H);
        };
        
        animate();
    </script>
</body>
</html>