{
  "console": "snes",
  "name": "SNES Collection",
  "year": 1991,
  "icon": "üéµ",
  "theme": {
    "bg": "#1a0a2a",
    "accent": "#aa44ff"
  },
  "render": {
    "width": 256,
    "height": 224,
    "scanlines": true,
    "scanlineAlpha": 0.06
  },
  "audio": {
    "type": "snes-spc",
    "channels": 8
  },
  "games": [
    {
      "id": "chrono-blade",
      "name": "Chrono Blade",
      "icon": "‚öîÔ∏è",
      "desc": "JRPG with ATB combat",
      "code": "if(mode==='init'){G.phase='map';G.px=64;G.py=100;G.xp=0;G.lvl=1;G.score=0;G.over=false;G.win=false;G.steps=0;G.pots=3;G.map=[];for(var i=0;i<16;i++){G.map[i]=[];for(var j=0;j<14;j++)G.map[i][j]=(i===0||i===15||j===0||j===13)?1:Math.random()<0.1?1:0}G.map[4][3]=2;G.map[13][12]=3;G.party=[{n:'Kael',hp:80,mh:80,mp:20,mm:20,atb:0,ak:14,df:5,sp:1.2},{n:'Lyra',hp:60,mh:60,mp:40,mm:40,atb:0,ak:10,df:3,sp:1.0},{n:'Rook',hp:100,mh:100,mp:10,mm:10,atb:0,ak:18,df:8,sp:0.8}];G.en=null;G.bt=-1;G.bs=0;G.dmg=[];G.eatb=0;G.kcd=0;G.bossK=false;G.mt=0;G.ms=''}\nif(mode==='update'){if(G.over||G.win)return;G.kcd=Math.max(0,G.kcd-1);G.dmg=G.dmg.filter(function(d){d.t--;d.y-=0.5;return d.t>0});if(G.mt>0)G.mt--;if(G.phase==='map'){var ox=G.px,oy=G.py,mv=false;if(K('a')||K('ArrowLeft')){G.px-=1.5;mv=true}if(K('d')||K('ArrowRight')){G.px+=1.5;mv=true}if(K('w')||K('ArrowUp')){G.py-=1.5;mv=true}if(K('s')||K('ArrowDown')){G.py+=1.5;mv=true}G.px=Math.max(10,Math.min(246,G.px));G.py=Math.max(10,Math.min(214,G.py));var tx=Math.floor(G.px/16),ty=Math.floor(G.py/16);if(tx>=0&&tx<16&&ty>=0&&ty<14&&G.map[tx][ty]===1){G.px=ox;G.py=oy;tx=Math.floor(G.px/16);ty=Math.floor(G.py/16)}if(G.map[tx]&&G.map[tx][ty]===2){G.party.forEach(function(p){p.hp=p.mh;p.mp=p.mm});if(G.mt<=0){G.ms='Town: HP/MP restored!';G.mt=60}}if(G.map[tx]&&G.map[tx][ty]===3&&!G.bossK){G.phase='bat';G.en={n:'DRAGON',hp:120+G.lvl*20,mh:120+G.lvl*20,ak:18+G.lvl*3,df:4};G.bt=-1;G.bs=0;G.eatb=0;G.party.forEach(function(p){p.atb=0});snd.tone(200,0.15,0.1,'sawtooth')}if(mv){G.steps++;if(G.steps>25&&Math.random()<0.035){G.steps=0;G.phase='bat';var ns=['Goblin','Slime','Bat','Wolf'];G.en={n:ns[Math.floor(Math.random()*ns.length)],hp:20+G.lvl*8,mh:20+G.lvl*8,ak:5+G.lvl*2,df:1+G.lvl};G.bt=-1;G.bs=0;G.eatb=0;G.party.forEach(function(p){p.atb=0});snd.tone(300,0.08,0.06)}}}if(G.phase==='bat'){if(!G.en||G.en.hp<=0){var xg=G.en.n==='DRAGON'?200:25+G.lvl*5;G.xp+=xg;G.score+=xg*10;if(G.xp>=G.lvl*80){G.lvl++;G.party.forEach(function(p){p.mh+=8;p.hp=p.mh;p.mm+=4;p.mp=p.mm;p.ak+=2});G.ms='LEVEL UP!';G.mt=60}if(G.en.n==='DRAGON'){G.bossK=true;G.win=true;snd.win()}else snd.score();G.phase='map';G.en=null;return}var alv=G.party.filter(function(p){return p.hp>0});if(alv.length===0){G.over=true;snd.die();return}if(G.bt===-1){G.party.forEach(function(p,i){if(p.hp>0&&p.atb<100)p.atb+=p.sp*(dt||0.016)*60;if(p.hp>0&&p.atb>=100&&G.bt===-1){G.bt=i;G.bs=0;G.kcd=12;snd.beep()}});G.eatb+=0.7*(dt||0.016)*60;if(G.eatb>=100){G.eatb=0;var ts=G.party.filter(function(p){return p.hp>0});var t=ts[Math.floor(Math.random()*ts.length)];var dm=Math.max(1,G.en.ak-t.df);t.hp=Math.max(0,t.hp-dm);G.dmg.push({x:70,y:62+G.party.indexOf(t)*36,v:dm,t:35,c:'#ff4444'});snd.tone(150,0.06,0.05,'sawtooth')}}else{if(G.kcd<=0){if(K('w')||K('ArrowUp')){G.bs=(G.bs+2)%3;G.kcd=12;snd.beep()}if(K('s')||K('ArrowDown')){G.bs=(G.bs+1)%3;G.kcd=12;snd.beep()}}if((K(' ')||K('Enter'))&&G.kcd<=0){var ch=G.party[G.bt];if(G.bs===0){var dm=Math.max(1,ch.ak-G.en.df+Math.floor(Math.random()*5));G.en.hp=Math.max(0,G.en.hp-dm);G.dmg.push({x:195,y:80,v:dm,t:35,c:'#ffff00'});snd.hit()}else if(G.bs===1){if(ch.mp>=10){ch.mp-=10;var dm=ch.ak*2+Math.floor(Math.random()*8);G.en.hp=Math.max(0,G.en.hp-dm);G.dmg.push({x:195,y:80,v:dm,t:35,c:'#00ffff'});snd.tone(700,0.08,0.08)}else{G.ms='No MP!';G.mt=30}}else{if(G.pots>0){G.pots--;ch.hp=Math.min(ch.mh,ch.hp+30);G.dmg.push({x:70,y:62+G.bt*36,v:'+30',t:35,c:'#44ff44'});snd.pickup()}else{G.ms='No items!';G.mt=30}}ch.atb=0;G.bt=-1;G.kcd=12}}}}\nif(mode==='draw'){if(G.phase==='map'){cls('#2a6a2a');for(var i=0;i<16;i++)for(var j=0;j<14;j++){var c=G.map[i][j];O.fillStyle=c===1?'#1a4a1a':c===2?'#8888cc':c===3&&!G.bossK?'#882222':'#3a8a3a';O.fillRect(i*16,j*16,16,16);if(c===0&&(i+j)%5===0){O.fillStyle='#2a7a2a';O.fillRect(i*16+6,j*16+6,2,2)}if(c===2){O.fillStyle='#ccccdd';O.fillRect(i*16+3,j*16+2,10,10);O.fillStyle='#886644';O.fillRect(i*16+6,j*16+7,4,5)}if(c===3&&!G.bossK){O.fillStyle='#ff4444';O.fillRect(i*16+2,j*16+2,12,12);txt('!',i*16+8,j*16+8,8,'#fff')}}O.fillStyle='#4488ff';O.fillRect(G.px-4,G.py-6,8,12);O.fillStyle='#ffccaa';O.fillRect(G.px-3,G.py-9,6,4);rect(0,0,RW,12,'rgba(0,0,0,0.6)');txt('Lv'+G.lvl+' XP:'+G.xp+'/'+G.lvl*80,70,7,7,'#fff','left');txt('Potions:'+G.pots,RW-5,7,7,'#44ff44','right')}if(G.phase==='bat'){cls('#1a0a2a');rect(0,RH*0.55,RW,RH*0.45,'#2a1a3a');for(var i=0;i<RW;i+=12){O.fillStyle='#3a2a4a';O.fillRect(i,Math.floor(RH*0.55),10,2)}if(G.en&&G.en.hp>0){var ew=G.en.n==='DRAGON'?36:18,eh=G.en.n==='DRAGON'?36:18;O.fillStyle=G.en.n==='DRAGON'?'#cc2222':'#7766aa';O.fillRect(190-ew/2,75-eh/2,ew,eh);O.fillStyle='#ff0';O.fillRect(190-ew/4,75-eh/4,3,3);O.fillRect(190+ew/4-3,75-eh/4,3,3);rect(165,45,50,5,'#333');rect(165,45,Math.max(0,Math.floor(50*G.en.hp/G.en.mh)),5,'#ff4444');txt(G.en.n,190,38,7,'#fff')}G.party.forEach(function(p,i){var y=50+i*36;O.fillStyle=p.hp>0?(G.bt===i?'#ffff44':'#4488ff'):'#444';O.fillRect(25,y,10,14);if(p.hp>0){O.fillStyle='#ffccaa';O.fillRect(27,y-3,6,4)}txt(p.n,50,y-2,6,p.hp>0?'#fff':'#666','left');rect(50,y+6,36,3,'#333');rect(50,y+6,Math.max(0,Math.floor(36*p.hp/p.mh)),3,'#44ff44');rect(50,y+11,36,3,'#222');rect(50,y+11,Math.max(0,Math.floor(36*p.mp/p.mm)),3,'#4466ff');rect(50,y+16,36,2,'#111');rect(50,y+16,Math.max(0,Math.floor(36*Math.min(100,p.atb)/100)),2,'#ffaa00')});if(G.bt>=0){rect(140,155,80,48,'#111');O.strokeStyle='#aa44ff';O.strokeRect(140,155,80,48);var mn=['ATK','MAG','ITM'];for(var i=0;i<3;i++)txt((i===G.bs?'> ':' ')+mn[i],180,167+i*14,8,i===G.bs?'#ffff44':'#aaa')}G.dmg.forEach(function(d){txt(String(d.v),d.x,d.y,11,d.c)})}if(G.mt>0)txt(G.ms,RW/2,RH/2-30,10,'#ffff44');if(G.over)txt('GAME OVER',RW/2,RH/2,14,'#ff4444');if(G.win)txt('VICTORY! DRAGON SLAIN!',RW/2,RH/2,14,'#ffff00');hud('Lv'+G.lvl+' XP:'+G.xp+' Score:'+G.score);controls('WASD/Arrows Move ¬∑ W/S Menu ¬∑ Space/Enter Confirm')}"
    },
    {
      "id": "hyper-kart-gp",
      "name": "Hyper Kart GP",
      "icon": "üèéÔ∏è",
      "desc": "Mode 7 pseudo-3D racer",
      "code": "if(mode==='init'){G.pos=0;G.px=0;G.spd=0;G.lap=0;G.laps=3;G.seg=[];G.score=0;G.item=0;G.itemT=0;G.boost=0;G.over=false;G.won=false;G.aiPos=0;G.aiPx=0;G.aiSpd=2.5;G.time=0;G.bans=[];G.shells=[];for(var i=0;i<200;i++)G.seg.push({curve:(Math.sin(i*0.05)*2+Math.cos(i*0.03)*1.5),hill:Math.sin(i*0.04)*0.5});G.trackLen=200;G.itemBoxes=[];for(var i=20;i<200;i+=25)G.itemBoxes.push({p:i,got:false})}\nif(mode==='update'){if(G.won||G.over)return;G.time+=(dt||0.016);var acc=0;if(K('w')||K('ArrowUp'))acc=0.06;if(K('s')||K('ArrowDown'))acc=-0.08;G.spd+=acc;G.spd*=0.98;if(G.boost>0){G.spd=Math.min(6,G.spd+0.1);G.boost--}G.spd=Math.max(0,Math.min(5,G.spd));if(K('a')||K('ArrowLeft'))G.px-=0.04*(G.spd+0.5);if(K('d')||K('ArrowRight'))G.px+=0.04*(G.spd+0.5);G.px=Math.max(-1,Math.min(1,G.px));var si=Math.floor(G.pos)%G.trackLen;G.px+=G.seg[si].curve*0.002*G.spd;if(Math.abs(G.px)>0.8)G.spd*=0.96;G.pos+=G.spd*0.05;if(G.pos>=G.trackLen){G.pos-=G.trackLen;G.lap++;if(G.lap>=G.laps){G.won=true;G.score+=Math.max(0,Math.floor(5000-G.time*10));snd.win();return}snd.score();G.itemBoxes.forEach(function(b){b.got=false})}G.itemBoxes.forEach(function(b){if(!b.got&&Math.abs((G.pos%G.trackLen)-b.p)<1&&Math.abs(G.px)<0.5){b.got=true;G.item=1+Math.floor(Math.random()*3);snd.pickup()}});if((K(' ')||K('Enter'))&&G.item>0){if(G.item===1){G.boost=40;snd.tone(600,0.08,0.06)}else if(G.item===2){G.shells.push({p:G.pos+2,life:80});snd.shoot()}else if(G.item===3){G.bans.push({p:G.pos-1,px:G.px,life:300});snd.tone(200,0.04,0.04)}G.item=0}G.shells=G.shells.filter(function(s){s.p+=0.2;s.life--;if(Math.abs(s.p-G.aiPos)<1.5){G.aiSpd=0.5;snd.explode();return false}return s.life>0});G.bans=G.bans.filter(function(b){b.life--;if(Math.abs(G.pos-b.p)<1&&Math.abs(G.px-b.px)<0.3){G.spd=0.5;snd.tone(100,0.1,0.08);return false}return b.life>0});G.aiSpd+=(2.8-G.aiSpd)*0.01;G.aiPos+=G.aiSpd*0.05;if(G.aiPos>=G.trackLen)G.aiPos-=G.trackLen;var aSi=Math.floor(G.aiPos)%G.trackLen;G.aiPx+=(G.seg[aSi].curve*-0.01-G.aiPx)*0.05;G.aiPx=Math.max(-0.8,Math.min(0.8,G.aiPx))}\nif(mode==='draw'){cls('#87CEEB');rect(0,RH/2,RW,RH/2,'#4a8a2a');var si=Math.floor(G.pos)%G.trackLen;for(var y=RH-1;y>RH/2;y--){var d=(y-RH/2);var z=100.0/(d+1);var sc=1.0/z;var roadW=RW*0.4*sc;var cx=RW/2-G.px*roadW*2;var segI=Math.floor(G.pos+z*0.5)%G.trackLen;cx-=G.seg[segI].curve*z*8;var rc=((Math.floor(G.pos*2+z))%2===0)?'#666':'#555';var gc=(((Math.floor(z*2))%2===0))?'#3a7a2a':'#4a8a2a';O.fillStyle=gc;O.fillRect(0,y,RW,1);O.fillStyle=rc;O.fillRect(cx-roadW/2,y,roadW,1);O.fillStyle='#fff';if(Math.floor(z*3)%3===0){O.fillRect(cx-roadW/2+2,y,3,1);O.fillRect(cx+roadW/2-5,y,3,1)}O.fillStyle='#ff0';if(Math.floor(z*4)%8===0)O.fillRect(cx-1,y,2,1)}G.itemBoxes.forEach(function(b){if(b.got)return;var dz=(b.p-G.pos%G.trackLen+G.trackLen)%G.trackLen;if(dz>0&&dz<15){var proj=100.0/dz;var bx=RW/2-G.px*proj*20+G.seg[Math.floor(b.p)%G.trackLen].curve*-dz*2;var by=RH/2+proj;var bs=Math.max(2,10*proj/5);O.fillStyle='#ffcc00';O.fillRect(bx-bs/2,by-bs/2,bs,bs);txt('?',bx,by,Math.max(4,bs),''+'#fff')}});var aiDz=(G.aiPos-G.pos%G.trackLen+G.trackLen)%G.trackLen;if(aiDz>0&&aiDz<20){var ap=100.0/aiDz;var ax=RW/2+(G.aiPx-G.px)*ap*20;var ay=RH/2+ap;var as2=Math.max(3,12*ap/5);O.fillStyle='#cc2222';O.fillRect(ax-as2/2,ay-as2,as2,as2)}O.fillStyle='#2244ff';O.fillRect(RW/2-8,RH-30,16,12);O.fillRect(RW/2-10,RH-22,20,6);O.fillStyle='#aaa';O.fillRect(RW/2-10,RH-20,4,3);O.fillRect(RW/2+6,RH-20,4,3);rect(0,0,RW,16,'rgba(0,0,0,0.5)');txt('LAP '+(Math.min(G.lap+1,G.laps))+'/'+G.laps,50,9,8,'#fff','left');txt(G.time.toFixed(1)+'s',RW/2,9,8,'#ffcc00');var itms=['','BOOST','SHELL','BANANA'];if(G.item>0)txt(itms[G.item],RW-10,9,7,'#44ff44','right');if(G.boost>0)txt('BOOST!',RW/2,RH-40,10,'#ff8800');if(G.won){txt('FINISH!',RW/2,RH/2,16,'#ffff00');txt('Score: '+G.score,RW/2,RH/2+20,10,'#fff')}hud('Lap '+(Math.min(G.lap+1,G.laps))+'/'+G.laps+' Time:'+G.time.toFixed(1)+'s');controls('W/S or Up/Down Accel/Brake ¬∑ A/D or Left/Right Steer ¬∑ Space Use Item')}"
    },
    {
      "id": "bounty-star",
      "name": "Bounty Star",
      "icon": "üî´",
      "desc": "Metroidvania explorer",
      "code": "if(mode==='init'){G.rm=0;G.px=40;G.py=160;G.vx=0;G.vy=0;G.dir=1;G.hp=5;G.mhp=5;G.en=20;G.men=20;G.jc=0;G.dblJ=false;G.wSlide=false;G.ground=false;G.wall=0;G.buls=[];G.score=0;G.over=false;G.bcd=0;G.vis={};G.vis[0]=true;G.rooms=[];for(var r=0;r<9;r++){var ps=[];var es=[];ps.push({x:0,y:200,w:256,h:24});ps.push({x:0,y:0,w:256,h:8});ps.push({x:0,y:8,w:8,h:216});ps.push({x:248,y:8,w:8,h:216});for(var p=0;p<4;p++){var px2=30+Math.random()*190,py2=60+Math.random()*120;ps.push({x:px2,y:py2,w:30+Math.random()*30,h:8})}for(var e=0;e<2+Math.floor(r/2);e++)es.push({x:40+Math.random()*180,y:100+Math.random()*80,vx:(Math.random()<0.5?-1:1)*0.8,hp:2+Math.floor(r/3),mhp:2+Math.floor(r/3),alive:true});G.rooms.push({plats:ps,ens:es,boss:r===4?{x:200,y:150,hp:15,mhp:15,vx:1,alive:true}:null,item:r===4?'dblJ':r===7?'wSlide':null,itemGot:false})}G.doors=[[1,3,-1,-1],[2,4,0,-1],[- 1,5,1,-1],[4,6,-1,0],[5,7,3,1],[- 1,8,4,2],[7,-1,-1,3],[8,-1,6,4],[-1,-1,7,5]]}\nif(mode==='update'){if(G.over)return;G.bcd=Math.max(0,G.bcd-1);var rm=G.rooms[G.rm];var spd=2;G.vx=0;if(K('a')||K('ArrowLeft')){G.vx=-spd;G.dir=-1}if(K('d')||K('ArrowRight')){G.vx=spd;G.dir=1}if((K('w')||K('ArrowUp')||K(' '))&&(G.ground||G.wall!==0||(G.dblJ&&G.jc<2))){if(!G.ground&&G.wall===0)G.jc++;else G.jc=1;G.vy=-5;G.ground=false;G.wall=0;snd.jump()}G.vy+=0.25;if(G.wSlide&&G.wall!==0&&G.vy>0.5)G.vy=0.5;G.px+=G.vx;G.py+=G.vy;G.ground=false;G.wall=0;rm.plats.forEach(function(p){if(G.px+5>p.x&&G.px-5<p.x+p.w){if(G.py+12>=p.y&&G.py+12-G.vy<=p.y+2&&G.vy>=0){G.py=p.y-12;G.vy=0;G.ground=true;G.jc=0}}if(G.py+10>p.y&&G.py<p.y+p.h){if(G.px+5>=p.x&&G.px+5-G.vx<=p.x+2){G.px=p.x-5;G.wall=-1}if(G.px-5<=p.x+p.w&&G.px-5-G.vx>=p.x+p.w-2){G.px=p.x+p.w+5;G.wall=1}}});if((K('f')||K('Enter'))&&G.bcd<=0&&G.en>0){G.en--;G.buls.push({x:G.px,y:G.py+4,vx:G.dir*5,life:40});G.bcd=8;snd.shoot()}G.en=Math.min(G.men,G.en+0.02);G.buls=G.buls.filter(function(b){b.x+=b.vx;b.life--;var hit=false;rm.ens.forEach(function(e){if(e.alive&&Math.abs(b.x-e.x)<10&&Math.abs(b.y-e.y)<10){e.hp--;hit=true;if(e.hp<=0){e.alive=false;G.score+=100;snd.hit()}else snd.tone(400,0.03,0.05)}});if(rm.boss&&rm.boss.alive&&Math.abs(b.x-rm.boss.x)<16&&Math.abs(b.y-rm.boss.y)<16){rm.boss.hp--;hit=true;if(rm.boss.hp<=0){rm.boss.alive=false;G.score+=500;if(rm.item==='dblJ')G.dblJ=true;if(rm.item==='wSlide')G.wSlide=true;rm.itemGot=true;snd.win()}else snd.hit()}return !hit&&b.life>0});rm.ens.forEach(function(e){if(!e.alive)return;e.x+=e.vx;if(e.x<16||e.x>240)e.vx*=-1;if(Math.abs(G.px-e.x)<10&&Math.abs(G.py-e.y)<12){G.hp--;snd.tone(150,0.08,0.06,'sawtooth');G.py-=10;G.vy=-3;if(G.hp<=0)G.over=true}});if(rm.boss&&rm.boss.alive){rm.boss.x+=rm.boss.vx;if(rm.boss.x<30||rm.boss.x>226)rm.boss.vx*=-1;if(Math.abs(G.px-rm.boss.x)<14&&Math.abs(G.py-rm.boss.y)<14){G.hp--;snd.tone(150,0.1,0.08,'sawtooth');G.vy=-4;if(G.hp<=0)G.over=true}}var d=G.doors[G.rm];if(G.px>248&&d[0]>=0){G.rm=d[0];G.px=16;G.vis[G.rm]=true;G.buls=[]}if(G.px<8&&d[2]>=0){G.rm=d[2];G.px=240;G.vis[G.rm]=true;G.buls=[]}if(G.py<8&&d[3]>=0){G.rm=d[3];G.py=190;G.vis[G.rm]=true;G.buls=[]}if(G.py>210&&d[1]>=0){G.rm=d[1];G.py=16;G.vis[G.rm]=true;G.buls=[]}}\nif(mode==='draw'){cls('#0a0a1a');var rm=G.rooms[G.rm];rm.plats.forEach(function(p){O.fillStyle='#334';O.fillRect(p.x,p.y,p.w,p.h);O.fillStyle='#556';O.fillRect(p.x,p.y,p.w,2)});rm.ens.forEach(function(e){if(!e.alive)return;O.fillStyle='#cc4444';O.fillRect(e.x-6,e.y-6,12,12);rect(e.x-6,e.y-10,12,3,'#333');rect(e.x-6,e.y-10,Math.floor(12*e.hp/e.mhp),3,'#ff4444')});if(rm.boss&&rm.boss.alive){O.fillStyle='#ff6600';O.fillRect(rm.boss.x-12,rm.boss.y-14,24,28);O.fillStyle='#ffcc00';O.fillRect(rm.boss.x-8,rm.boss.y-10,6,4);O.fillRect(rm.boss.x+2,rm.boss.y-10,6,4);rect(rm.boss.x-12,rm.boss.y-20,24,4,'#333');rect(rm.boss.x-12,rm.boss.y-20,Math.floor(24*rm.boss.hp/rm.boss.mhp),4,'#ff4444')}G.buls.forEach(function(b){O.fillStyle='#44ffff';O.fillRect(b.x-2,b.y-1,4,2)});if(!G.over){O.fillStyle='#22aa44';O.fillRect(G.px-4,G.py-2,8,14);O.fillStyle='#ffccaa';O.fillRect(G.px-3,G.py-5,6,4);if(G.dir===1){O.fillStyle='#666';O.fillRect(G.px+4,G.py+2,4,2)}else{O.fillStyle='#666';O.fillRect(G.px-8,G.py+2,4,2)}}for(var i=0;i<G.mhp;i++){O.fillStyle=i<G.hp?'#ff4444':'#333';O.fillRect(6+i*12,6,10,8)}rect(6,18,40,4,'#222');rect(6,18,Math.floor(40*G.en/G.men),4,'#44aaff');var mmx=RW-38,mmy=6;rect(mmx-1,mmy-1,35,35,'#111');for(var r=0;r<9;r++){var rx=r%3,ry=Math.floor(r/3);var c=r===G.rm?'#44ff44':G.vis[r]?'#336':'#111';O.fillStyle=c;O.fillRect(mmx+rx*10+1,mmy+ry*10+1,8,8)}var ab='';if(G.dblJ)ab+='[2xJMP] ';if(G.wSlide)ab+='[WALL] ';txt(ab,RW/2,RH-8,6,'#aaaaff');if(G.over)txt('GAME OVER',RW/2,RH/2,14,'#ff4444');hud('HP:'+G.hp+' EN:'+Math.floor(G.en)+' Room:'+(G.rm+1)+' Score:'+G.score);controls('A/D Move ¬∑ W/Space Jump ¬∑ F/Enter Shoot ¬∑ Find bosses for abilities')}"
    },
    {
      "id": "street-brawlers",
      "name": "Street Brawlers",
      "icon": "ü•ä",
      "desc": "1v1 fighting game",
      "code": "if(mode==='init'){G.round=1;G.p1w=0;G.p2w=0;G.rndT=0;G.rndMsg='';G.over=false;G.winner='';G.kcd1=0;G.kcd2=0;G.hitstun=[];function mkF(x,d){return{x:x,y:RH-60,vy:0,hp:100,mhp:100,dir:d,st:'idle',stT:0,atk:0,blk:false,spC:0,hit:0,ground:true}}G.p1=mkF(70,1);G.p2=mkF(186,- 1);G.mkF=mkF;G.aiT=0;G.rndMsg='ROUND 1';G.rndT=60;G.sparks=[]}\nif(mode==='update'){if(G.over)return;G.kcd1=Math.max(0,G.kcd1-1);G.kcd2=Math.max(0,G.kcd2-1);G.sparks=G.sparks.filter(function(s){s.x+=s.vx;s.y+=s.vy;s.life--;return s.life>0});if(G.rndT>0){G.rndT--;return}G.hitstun=G.hitstun.filter(function(h){h.t--;return h.t>0});function updF(f,ol,kl,kr,ku,kd,ka,kb){f.hit=Math.max(0,f.hit-1);f.stT=Math.max(0,f.stT-1);if(f.stT>0&&(f.st==='atkL'||f.st==='atkH'||f.st==='spec'||f.st==='hit'))return;f.st='idle';f.blk=false;if(K(kd)){f.blk=true;f.st='block'}if(K(kl)){f.x-=2;f.st='walk'}if(K(kr)){f.x+=2;f.st='walk'}if(K(ku)&&f.ground){f.vy=-6;f.ground=false;snd.jump()}if(K(ka)&&f.stT<=0){f.st='atkL';f.stT=12;f.atk=8;snd.tone(300,0.03,0.04)}if(K(kb)&&f.stT<=0){f.st='atkH';f.stT=20;f.atk=15;snd.tone(250,0.05,0.05)}if(K(ka)&&K(kb)&&f.spC>=50&&f.stT<=2){f.st='spec';f.stT=25;f.atk=25;f.spC=0;snd.tone(600,0.1,0.1);snd.tone(800,0.08,0.08)}f.vy+=0.3;f.y+=f.vy;if(f.y>=RH-60){f.y=RH-60;f.vy=0;f.ground=true}f.x=Math.max(16,Math.min(RW-16,f.x));f.dir=f.x<ol.x?1:-1;if(f.stT>0&&(f.st==='atkL'||f.st==='atkH'||f.st==='spec')){var range=f.st==='spec'?30:20;var hx=f.x+f.dir*range;if(Math.abs(hx-ol.x)<20&&Math.abs(f.y-ol.y)<20&&f.stT===Math.floor(f.stT/2)*2){if(ol.blk){f.atk=Math.floor(f.atk*0.2);snd.tone(500,0.03,0.03)}ol.hp=Math.max(0,ol.hp-f.atk);ol.hit=10;ol.st='hit';ol.stT=10;f.spC=Math.min(100,f.spC+10);for(var s=0;s<3;s++)G.sparks.push({x:hx,y:f.y-10,vx:(Math.random()-0.5)*4,vy:-Math.random()*3,life:10});snd.hit()}}}updF(G.p1,G.p2,'a','d','w','s','j','k');G.aiT--;if(G.aiT<=0){G.aiT=10+Math.floor(Math.random()*20);var dx=G.p1.x-G.p2.x;var dist=Math.abs(dx);G.p2._ml=false;G.p2._mr=false;G.p2._mu=false;G.p2._md=false;G.p2._ma=false;G.p2._mb=false;if(dist>40){if(dx<0)G.p2._ml=true;else G.p2._mr=true}else if(dist<25){G.p2._md=Math.random()<0.3;G.p2._ma=Math.random()<0.5;G.p2._mb=Math.random()<0.3}else{G.p2._ma=Math.random()<0.6;G.p2._mb=Math.random()<0.2;if(Math.random()<0.15)G.p2._mu=true}}var oldK=K;K=function(k){if(k==='ArrowLeft')return G.p2._ml;if(k==='ArrowRight')return G.p2._mr;if(k==='ArrowUp')return G.p2._mu;if(k==='ArrowDown')return G.p2._md;if(k==='1')return G.p2._ma;if(k==='2')return G.p2._mb;return oldK(k)};updF(G.p2,G.p1,'ArrowLeft','ArrowRight','ArrowUp','ArrowDown','1','2');K=oldK;if(G.p1.hp<=0||G.p2.hp<=0){if(G.p1.hp<=0)G.p2w++;else G.p1w++;if(G.p1w>=2||G.p2w>=2){G.over=true;G.winner=G.p1w>=2?'P1':'P2';snd.win()}else{G.round++;G.p1=G.mkF(70,1);G.p2=G.mkF(186,-1);G.rndMsg='ROUND '+G.round;G.rndT=60;snd.score()}}}\nif(mode==='draw'){cls('#1a0a2a');rect(0,RH-44,RW,44,'#2a1a3a');for(var x=0;x<RW;x+=20){O.fillStyle='#3a2a4a';O.fillRect(x,RH-44,18,2)}function drwF(f,c1,c2){var blink=f.hit>0&&f.hit%3<1;O.fillStyle=blink?'#fff':f.blk?'#888':c1;O.fillRect(f.x-6,f.y-20,12,24);O.fillStyle=c2;O.fillRect(f.x-4,f.y-24,8,6);if(f.st==='atkL'||f.st==='atkH'||f.st==='spec'){var alen=f.st==='spec'?18:12;O.fillStyle=f.st==='spec'?'#ffff00':'#fff';O.fillRect(f.x+f.dir*8,f.y-14,f.dir*alen,4)}O.fillStyle='#ddd';O.fillRect(f.x-3,f.y+4,3,6);O.fillRect(f.x+1,f.y+4,3,6)}drwF(G.p1,'#2266cc','#4488ff');drwF(G.p2,'#cc2222','#ff4444');G.sparks.forEach(function(s){O.fillStyle='#ffff44';O.fillRect(s.x,s.y,3,3)});rect(10,8,80,8,'#333');rect(10,8,Math.floor(80*G.p1.hp/100),8,'#44ff44');rect(RW-90,8,80,8,'#333');rect(RW-90,8,Math.floor(80*G.p2.hp/100),8,'#ff4444');rect(10,18,Math.floor(40*G.p1.spC/100),3,'#ffaa00');rect(RW-10-Math.floor(40*G.p2.spC/100),18,Math.floor(40*G.p2.spC/100),3,'#ffaa00');txt('P1',30,6,6,'#4488ff','left');txt('P2',RW-30,6,6,'#ff4444','right');txt(G.p1w+' - '+G.p2w,RW/2,8,8,'#fff');txt('R'+G.round,RW/2,18,6,'#aaa');if(G.rndT>0)txt(G.rndMsg,RW/2,RH/2,16,'#ffff00');if(G.over)txt(G.winner+' WINS!',RW/2,RH/2,16,'#ffff00');hud('P1:'+G.p1.hp+' P2:'+G.p2.hp+' Round '+G.round);controls('P1: WASD+J/K ¬∑ P2: AI ¬∑ J+K=Special(50% bar) ¬∑ S=Block')}"
    },
    {
      "id": "fox-wing",
      "name": "Fox Wing",
      "icon": "ü¶ä",
      "desc": "Mode 7 rail shooter",
      "code": "if(mode==='init'){G.px=RW/2;G.py=RH*0.7;G.lives=3;G.score=0;G.wave=1;G.over=false;G.won=false;G.buls=[];G.ens=[];G.stars=[];G.boss=null;G.bossW=false;G.spawnT=0;G.killC=0;G.needK=5;G.bcd=0;G.roll=0;G.rollD=0;G.tapT=[0,0];G.parts=[];for(var i=0;i<60;i++)G.stars.push({x:Math.random()*RW,y:Math.random()*RH,z:Math.random()*3+1});G.iframes=0}\nif(mode==='update'){if(G.over||G.won)return;G.iframes=Math.max(0,G.iframes-1);G.bcd=Math.max(0,G.bcd-1);G.roll=Math.max(0,G.roll-1);var sp=3;if(K('a')||K('ArrowLeft'))G.px-=sp;if(K('d')||K('ArrowRight'))G.px+=sp;if(K('w')||K('ArrowUp'))G.py-=sp;if(K('s')||K('ArrowDown'))G.py+=sp;G.px=Math.max(10,Math.min(RW-10,G.px));G.py=Math.max(30,Math.min(RH-10,G.py));if(K('a')||K('ArrowLeft')){if(G.tapT[0]>0&&G.tapT[0]<15&&G.roll<=0){G.roll=20;G.rollD=-1;snd.tone(500,0.06,0.06);G.iframes=20}G.tapT[0]=0}else{G.tapT[0]++}if(K('d')||K('ArrowRight')){if(G.tapT[1]>0&&G.tapT[1]<15&&G.roll<=0){G.roll=20;G.rollD=1;snd.tone(500,0.06,0.06);G.iframes=20}G.tapT[1]=0}else{G.tapT[1]++}if((K(' ')||K('Enter')||K('f'))&&G.bcd<=0){G.buls.push({x:G.px,y:G.py-8,life:40});G.bcd=5;snd.shoot()}G.buls=G.buls.filter(function(b){b.y-=6;b.life--;return b.life>0&&b.y>-5});G.stars.forEach(function(s){s.y+=s.z*2;if(s.y>RH){s.y=0;s.x=Math.random()*RW;s.z=Math.random()*3+1}});G.spawnT--;if(G.spawnT<=0&&!G.bossW){G.spawnT=30-G.wave*3;if(G.spawnT<8)G.spawnT=8;G.ens.push({x:30+Math.random()*(RW-60),y:-10,z:0,hp:1+Math.floor(G.wave/3),mhp:1+Math.floor(G.wave/3),spd:1+G.wave*0.2,shootT:60+Math.floor(Math.random()*40)})}G.ens=G.ens.filter(function(e){e.y+=e.spd;e.shootT--;if(e.shootT<=0){e.shootT=40+Math.floor(Math.random()*30);G.parts.push({x:e.x,y:e.y,vx:(G.px-e.x)*0.02,vy:2,life:60,c:'#ff4444',en:true})}var hit=false;G.buls=G.buls.filter(function(b){if(Math.abs(b.x-e.x)<12&&Math.abs(b.y-e.y)<12){hit=true;return false}return true});if(hit){e.hp--;snd.tone(400,0.03,0.04);if(e.hp<=0){G.score+=50*G.wave;G.killC++;for(var i=0;i<4;i++)G.parts.push({x:e.x,y:e.y,vx:(Math.random()-0.5)*4,vy:(Math.random()-0.5)*4,life:15,c:'#ff8800',en:false});snd.explode();return false}}if(e.y>RH+10)return false;if(G.iframes<=0&&G.roll<=0&&Math.abs(G.px-e.x)<10&&Math.abs(G.py-e.y)<10){G.lives--;G.iframes=40;snd.die();if(G.lives<=0)G.over=true;return false}return true});if(G.killC>=G.needK&&!G.bossW){G.bossW=true;G.boss={x:RW/2,y:40,hp:10+G.wave*5,mhp:10+G.wave*5,dir:1,shootT:30};snd.tone(200,0.2,0.1,'sawtooth')}if(G.boss){G.boss.x+=G.boss.dir*1.5;if(G.boss.x<30||G.boss.x>RW-30)G.boss.dir*=-1;G.boss.shootT--;if(G.boss.shootT<=0){G.boss.shootT=20;for(var a=-1;a<=1;a++)G.parts.push({x:G.boss.x+a*15,y:G.boss.y+20,vx:a*1.5,vy:3,life:50,c:'#ff00ff',en:true});snd.tone(200,0.05,0.05)}G.buls=G.buls.filter(function(b){if(Math.abs(b.x-G.boss.x)<20&&Math.abs(b.y-G.boss.y)<16){G.boss.hp--;snd.hit();if(G.boss.hp<=0){G.score+=500*G.wave;for(var i=0;i<10;i++)G.parts.push({x:G.boss.x,y:G.boss.y,vx:(Math.random()-0.5)*6,vy:(Math.random()-0.5)*6,life:25,c:'#ffff00',en:false});G.boss=null;G.bossW=false;G.killC=0;G.wave++;G.needK=5+G.wave*2;if(G.wave>5){G.won=true;snd.win()}else{snd.score()}return false}return false}return true});if(G.boss&&G.iframes<=0&&G.roll<=0&&Math.abs(G.px-G.boss.x)<18&&Math.abs(G.py-G.boss.y)<16){G.lives--;G.iframes=40;snd.die();if(G.lives<=0)G.over=true}}G.parts=G.parts.filter(function(p){p.x+=p.vx;p.y+=p.vy;p.life--;if(p.en&&G.iframes<=0&&G.roll<=0&&Math.abs(p.x-G.px)<8&&Math.abs(p.y-G.py)<8){G.lives--;G.iframes=40;snd.die();if(G.lives<=0)G.over=true;return false}return p.life>0})}\nif(mode==='draw'){cls('#000011');G.stars.forEach(function(s){var b=Math.floor(100+s.z*50);O.fillStyle='rgb('+b+','+b+','+Math.min(255,b+50)+')';O.fillRect(s.x,s.y,s.z>2?2:1,s.z>2?2:1)});for(var y=RH;y>RH*0.6;y--){var d=RH-y;var a=Math.floor(d*0.5);O.fillStyle='rgb(0,'+Math.floor(a*0.4)+','+a+')';O.fillRect(0,y,RW,1);if(d%8<1){O.fillStyle='rgba(100,100,255,0.2)';O.fillRect(0,y,RW,1)}}G.ens.forEach(function(e){O.fillStyle='#aa2222';O.fillRect(e.x-8,e.y-6,16,12);O.fillStyle='#ff4444';O.fillRect(e.x-5,e.y-4,4,3);O.fillRect(e.x+1,e.y-4,4,3);O.fillStyle='#882222';O.fillRect(e.x-10,e.y,6,4);O.fillRect(e.x+4,e.y,6,4)});if(G.boss){O.fillStyle='#880088';O.fillRect(G.boss.x-18,G.boss.y-12,36,24);O.fillStyle='#cc44cc';O.fillRect(G.boss.x-12,G.boss.y-8,8,6);O.fillRect(G.boss.x+4,G.boss.y-8,8,6);O.fillStyle='#aa00aa';O.fillRect(G.boss.x-22,G.boss.y-4,8,8);O.fillRect(G.boss.x+14,G.boss.y-4,8,8);rect(G.boss.x-18,G.boss.y-18,36,3,'#333');rect(G.boss.x-18,G.boss.y-18,Math.floor(36*G.boss.hp/G.boss.mhp),3,'#ff44ff')}G.buls.forEach(function(b){O.fillStyle='#44ff44';O.fillRect(b.x-1,b.y-3,2,6)});G.parts.forEach(function(p){O.fillStyle=p.c;O.fillRect(p.x-1,p.y-1,3,3)});if(!G.over&&!G.won){var blink=G.iframes>0&&G.iframes%4<2;if(!blink){var rAng=G.roll>0?G.rollD*(G.roll/20)*Math.PI*2:0;O.save();O.translate(G.px,G.py);O.rotate(rAng);O.fillStyle='#2266ff';O.fillRect(-8,-6,16,12);O.fillStyle='#44aaff';O.fillRect(-12,-2,6,4);O.fillRect(6,-2,6,4);O.fillStyle='#aaddff';O.fillRect(-3,-8,6,4);O.restore()}}O.fillRect(mx-1,my-6,2,4);O.fillRect(mx-1,my+2,2,4);O.fillRect(mx-6,my-1,4,2);O.fillRect(mx+2,my-1,4,2);rect(0,0,RW,14,'rgba(0,0,0,0.5)');txt('WAVE '+G.wave,50,8,7,'#fff','left');txt(String(G.score),RW/2,8,8,'#ffcc00');for(var i=0;i<G.lives;i++)txt('*',RW-10-i*10,8,8,'#44ff44','right');if(!G.bossW){var prog=Math.min(G.killC,G.needK);txt(prog+'/'+G.needK,RW/2,20,6,'#aaa')}if(G.roll>0)txt('BARREL ROLL!',RW/2,RH-20,8,'#44ffff');if(G.over)txt('GAME OVER',RW/2,RH/2,16,'#ff4444');if(G.won)txt('ALL CLEAR!',RW/2,RH/2,16,'#44ff44');hud('Wave '+G.wave+' Score:'+G.score+' Lives:'+G.lives);controls('WASD/Arrows Move ¬∑ Space/Enter/F Shoot ¬∑ Double-tap L/R Barrel Roll')}"
    }
  ]
}
