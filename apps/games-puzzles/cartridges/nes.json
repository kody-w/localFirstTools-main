{
  "console": "nes",
  "name": "NES Collection",
  "year": 1985,
  "icon": "üéÆ",
  "theme": { "bg": "#1a1a2a", "accent": "#cc0000", "font": "monospace" },
  "render": { "width": 256, "height": 240, "scanlines": true, "scanlineAlpha": 0.07 },
  "audio": { "type": "nes-apu", "channels": 4 },
  "games": [
    {
      "id": "plumber-quest",
      "name": "Plumber's Quest",
      "icon": "üçÑ",
      "desc": "Side-scroll, stomp, power up",
      "code": "if(mode==='init'){G.px=40;G.py=0;G.vy=0;G.ground=false;G.big=false;G.scroll=0;G.score=0;G.lives=3;G.dead=0;G.coins=0;G.vx=0;G.level=[];G.enemies=[];G.blocks=[];G.particles=[];for(var i=0;i<60;i++){var x=i*40;if(i>2){if(Math.random()<.3)G.level.push({x:x,y:RH-60-Math.floor(Math.random()*3)*20,w:40,h:8,type:'ground'});if(Math.random()<.2)G.blocks.push({x:x+10,y:RH-100,type:Math.random()<.5?'coin':'mush',hit:false});if(Math.random()<.15&&i>5)G.enemies.push({x:x,y:RH-36,vx:-.5,alive:true,type:'walk'})}G.level.push({x:x,y:RH-16,w:40,h:16,type:'floor'})}G.flagX=59*40;}\nif(mode==='update'){if(G.dead>0){G.dead--;if(G.dead===0){if(G.lives>0){G.px=40;G.py=0;G.scroll=0;G.vy=0;G.big=false}};return}var spd=2.5;if(K('d')||K('ArrowRight'))G.vx=spd;else if(K('a')||K('ArrowLeft'))G.vx=-spd;else G.vx*=.7;G.px+=G.vx;if((K('w')||K(' ')||K('ArrowUp'))&&G.ground){G.vy=-6;G.ground=false;snd.tone(400,.06,.06);setTimeout(function(){snd.tone(500,.04,.04)},30)}G.vy+=.3;G.py+=G.vy;G.ground=false;var wx=G.px+G.scroll;G.level.forEach(function(p){if(wx+6>p.x&&wx-6<p.x+p.w){if(G.py+16>=p.y&&G.py+16-G.vy<=p.y+2&&G.vy>=0){G.py=p.y-16;G.vy=0;G.ground=true}}});G.blocks.forEach(function(b){if(!b.hit&&Math.abs(wx-b.x-8)<10&&Math.abs(G.py-b.y)<14&&G.vy<0){b.hit=true;G.vy=1;snd.tone(300,.04,.06);if(b.type==='coin'){G.coins++;G.score+=100;snd.tone(880,.05,.08);snd.tone(1100,.05,.06)}else{G.big=true;snd.tone(523,.08,.08);snd.tone(659,.08,.08)}}});G.enemies=G.enemies.filter(function(e){if(!e.alive)return false;e.x+=e.vx;if(Math.abs(wx-e.x)<10&&G.py+14>e.y&&G.py+14<e.y+6&&G.vy>0){e.alive=false;G.vy=-4;G.score+=200;snd.tone(200,.05,.08);return false}if(Math.abs(wx-e.x)<8&&Math.abs(G.py-e.y)<14){if(G.big){G.big=false;snd.tone(200,.15,.06,'sawtooth')}else{G.lives--;G.dead=60;snd.tone(100,.3,.1,'sawtooth')}}return true});if(G.py>RH+20){G.lives--;G.dead=60;snd.tone(80,.3,.1,'sawtooth')}if(G.px>80)G.scroll+=G.px-80,G.px=80;if(G.px<20)G.px=20;if(wx>G.flagX){G.score+=1000;snd.win();G.px=40;G.scroll=0}G.particles=G.particles.filter(function(p){p.y+=p.vy;p.vy+=.1;p.life--;return p.life>0})}\nif(mode==='draw'){cls('#5c94fc');rect(0,RH-16,RW,16,'#c84c0c');for(var x=0;x<RW;x+=16){rect(x,RH-16,14,14,'#e09040');rect(x+1,RH-15,12,5,'#c84c0c')}G.level.forEach(function(p){var sx=p.x-G.scroll;if(sx>-50&&sx<RW+10){if(p.type==='ground'){O.fillStyle='#c84c0c';O.fillRect(sx,p.y,p.w,p.h);O.fillStyle='#00a800';O.fillRect(sx,p.y-2,p.w,2)}}});G.blocks.forEach(function(b){var sx=b.x-G.scroll;if(sx<-20||sx>RW+20)return;if(!b.hit){O.fillStyle=b.type==='coin'?'#ffcc00':'#c84c0c';O.fillRect(sx,b.y,16,16);O.fillStyle='#000';txt('?',sx+8,b.y+8,10,'#fff')}});G.enemies.forEach(function(e){if(!e.alive)return;var sx=e.x-G.scroll;if(sx<-20||sx>RW+20)return;O.fillStyle='#c84c0c';O.fillRect(sx-6,e.y,12,12);O.fillStyle='#fff';O.fillRect(sx-4,e.y+2,3,3);O.fillRect(sx+1,e.y+2,3,3)});var fx=G.flagX-G.scroll;if(fx>-10&&fx<RW+10){rect(fx,RH-90,3,74,'#888');O.fillStyle='#00a800';O.beginPath();O.moveTo(fx+3,RH-90);O.lineTo(fx+18,RH-82);O.lineTo(fx+3,RH-74);O.fill()}if(G.dead<=0&&G.lives>0){var ph=G.big?20:16;O.fillStyle='#cc0000';O.fillRect(G.px-5,G.py,10,ph);O.fillStyle='#ffccaa';O.fillRect(G.px-3,G.py-4,6,6);O.fillStyle='#cc0000';O.fillRect(G.px-4,G.py-6,8,3)}G.particles.forEach(function(p){rect(p.x-G.scroll,p.y,3,3,p.c)});txt(String(G.score).padStart(6,'0'),50,12,8,'#fff','left');txt('x'+G.lives,130,12,8,'#fff','left');txt(G.coins+' COINS',RW-10,12,8,'#ffcc00','right');if(G.lives<=0)txt('GAME OVER',RW/2,RH/2,16,'#fff');hud('SCORE: '+G.score+' ¬∑ COINS: '+G.coins+' ¬∑ LIVES: '+G.lives);controls('A/D or ‚Üê/‚Üí Run ¬∑ W/Space/‚Üë Jump ¬∑ Stomp enemies!')}"
    },
    {
      "id": "hero-of-elara",
      "name": "Hero of Elara",
      "icon": "‚öîÔ∏è",
      "desc": "Top-down action RPG",
      "code": "if(mode==='init'){G.px=128;G.py=180;G.hp=6;G.maxHp=6;G.score=0;G.atk=0;G.dir=0;G.iframes=0;G.room=0;G.enemies=[];G.items=[];G.keys=0;G.sword=true;G.particles=[];function spawnRoom(){G.enemies=[];G.items=[];for(var i=0;i<3+G.room;i++)G.enemies.push({x:40+Math.random()*176,y:30+Math.random()*130,hp:2,vx:(Math.random()-.5),vy:(Math.random()-.5),hit:0});if(Math.random()<.3)G.items.push({x:128,y:100,type:'heart'});if(G.room>0&&Math.random()<.2)G.items.push({x:100+Math.random()*60,y:80,type:'key'})}spawnRoom();G.spawnRoom=spawnRoom}\nif(mode==='update'){var spd=2;if(K('a')||K('ArrowLeft')){G.px-=spd;G.dir=2}if(K('d')||K('ArrowRight')){G.px+=spd;G.dir=0}if(K('w')||K('ArrowUp')){G.py-=spd;G.dir=3}if(K('s')||K('ArrowDown')){G.py+=spd;G.dir=1}G.px=Math.max(8,Math.min(RW-8,G.px));G.py=Math.max(24,Math.min(RH-8,G.py));G.iframes--;if((K(' ')||K('Enter'))&&G.atk<=0)G.atk=8;if(G.atk>0){G.atk--;var dx=[16,0,-16,0][G.dir],dy=[0,16,0,-16][G.dir];var ax=G.px+dx,ay=G.py+dy;G.enemies.forEach(function(e){if(e.hp>0&&Math.abs(ax-e.x)<14&&Math.abs(ay-e.y)<14&&G.atk===5){e.hp--;e.hit=8;snd.tone(300,.04,.08);if(e.hp<=0){G.score+=50;snd.noise(.08,.08,1500);for(var j=0;j<4;j++)G.particles.push({x:e.x,y:e.y,vx:(Math.random()-.5)*3,vy:(Math.random()-.5)*3,life:15,c:'#f80'})}}})}G.enemies.forEach(function(e){if(e.hp<=0)return;e.hit--;e.x+=e.vx;e.y+=e.vy;if(e.x<8||e.x>RW-8)e.vx*=-1;if(e.y<24||e.y>RH-8)e.vy*=-1;if(G.iframes<=0&&Math.abs(e.x-G.px)<10&&Math.abs(e.y-G.py)<10){G.hp--;G.iframes=30;snd.tone(150,.1,.08,'sawtooth');if(G.hp<=0)snd.tone(80,.3,.1,'sawtooth')}});G.enemies=G.enemies.filter(function(e){return e.hp>0});G.items=G.items.filter(function(it){if(Math.abs(it.x-G.px)<10&&Math.abs(it.y-G.py)<10){if(it.type==='heart'){G.hp=Math.min(G.maxHp,G.hp+2);snd.tone(523,.06,.06);snd.tone(659,.06,.06)}if(it.type==='key'){G.keys++;snd.tone(880,.08,.08)}return false}return true});if(G.enemies.length===0&&G.py<28){G.room++;G.py=RH-20;G.spawnRoom();snd.tone(440,.08,.06)}G.particles=G.particles.filter(function(p){p.x+=p.vx;p.y+=p.vy;p.life--;return p.life>0})}\nif(mode==='draw'){cls('#228822');for(var x=0;x<RW;x+=16)for(var y=16;y<RH;y+=16){if((x+y)%32===0)rect(x,y,16,16,'#1a7a1a')}rect(0,0,RW,18,'#333');rect(0,RH-2,RW,2,'#333');rect(0,18,2,RH-20,'#333');rect(RW-2,18,2,RH-20,'#333');if(G.enemies.length===0){rect(RW/2-10,16,20,4,'#000')}G.items.forEach(function(it){if(it.type==='heart'){O.fillStyle='#f00';circ(it.x,it.y,5,'#ff4444');txt('‚ô•',it.x,it.y,8,'#ff0000')}else{rect(it.x-3,it.y-4,6,8,'#ffcc00');txt('K',it.x,it.y,6,'#880')}});G.enemies.forEach(function(e){O.fillStyle=e.hit>0?'#fff':'#4444cc';O.fillRect(e.x-6,e.y-6,12,12);O.fillStyle='#fff';O.fillRect(e.x-3,e.y-3,3,2);O.fillRect(e.x+1,e.y-3,3,2)});if(G.hp>0){var blink=G.iframes>0&&G.iframes%4<2;if(!blink){O.fillStyle='#0a0';O.fillRect(G.px-5,G.py-6,10,12);O.fillStyle='#ffccaa';O.fillRect(G.px-3,G.py-8,6,5);O.fillStyle='#0a0';O.fillRect(G.px-4,G.py-10,8,3)}if(G.atk>0){var dx=[12,0,-12,0][G.dir],dy=[0,12,0,-12][G.dir];O.fillStyle='#ccc';O.fillRect(G.px+dx-2,G.py+dy-6,4,12)}}for(var i=0;i<G.maxHp/2;i++){var full=G.hp>=(i+1)*2,half=G.hp>=(i*2+1);O.fillStyle=full?'#ff0000':half?'#ff8888':'#444';txt(full?'‚ô•':half?'‚ô°':'‚ô°',10+i*12,8,8,full?'#f00':half?'#f88':'#444','left')}txt('ROOM '+(G.room+1),RW/2,8,8,'#fff');txt('KEYS:'+G.keys,RW-10,8,7,'#ffcc00','right');G.particles.forEach(function(p){rect(p.x,p.y,2,2,p.c)});if(G.hp<=0)txt('GAME OVER',RW/2,RH/2,16,'#ff4444');hud('HP: '+G.hp+'/'+G.maxHp+' ¬∑ ROOM: '+(G.room+1)+' ¬∑ KEYS: '+G.keys);controls('WASD/Arrows Move ¬∑ Space/Enter Attack ¬∑ Clear room ‚Üí go north')}"
    },
    {
      "id": "mega-striker",
      "name": "Mega Striker",
      "icon": "üîµ",
      "desc": "Run & gun platformer",
      "code": "if(mode==='init'){G.px=20;G.py=RH-40;G.vy=0;G.ground=true;G.hp=10;G.score=0;G.scroll=0;G.bullets=[];G.enemies=[];G.plats=[];G.cd=0;G.dir=1;G.dead=false;G.bossHp=0;G.bossX=0;G.bossY=0;G.bossPhase=false;for(var i=0;i<40;i++){G.plats.push({x:i*50,y:RH-16,w:50,h:16});if(Math.random()<.3)G.plats.push({x:i*50,y:RH-60-Math.random()*40,w:30,h:6});if(i>3&&Math.random()<.2)G.enemies.push({x:i*50+20,y:RH-36,hp:2,vx:-.3,type:'walk'})}G.bossX=40*50+50;G.bossY=RH-60;G.bossHp=20;}\nif(mode==='update'){if(G.dead)return;var spd=2;if(K('d')||K('ArrowRight')){G.px+=spd;G.dir=1}if(K('a')||K('ArrowLeft')){G.px-=spd;G.dir=-1}if((K('w')||K(' ')||K('ArrowUp'))&&G.ground){G.vy=-5.5;G.ground=false;snd.tone(450,.05,.05)}G.cd--;if((K('Enter')||K('f'))&&G.cd<=0){G.bullets.push({x:G.px+G.dir*8+G.scroll,y:G.py+4,vx:G.dir*5,life:50});G.cd=8;snd.tone(200,.03,.05,'sawtooth')}G.vy+=.25;G.py+=G.vy;G.ground=false;var wx=G.px+G.scroll;G.plats.forEach(function(p){if(wx+5>p.x&&wx-5<p.x+p.w&&G.py+16>=p.y&&G.py+16-G.vy<=p.y+3&&G.vy>=0){G.py=p.y-16;G.vy=0;G.ground=true}});if(G.py>RH+20){G.dead=true;snd.tone(80,.3,.1,'sawtooth');return}if(G.px>100){G.scroll+=G.px-100;G.px=100}G.bullets=G.bullets.filter(function(b){b.x+=b.vx;b.life--;return b.life>0&&b.x>G.scroll-10&&b.x<G.scroll+RW+10});G.enemies=G.enemies.filter(function(e){e.x+=e.vx;if(e.x<G.scroll-20)return false;var hit=false;G.bullets=G.bullets.filter(function(b){if(Math.abs(b.x-e.x)<8&&Math.abs(b.y-e.y-6)<10){hit=true;return false}return true});if(hit){e.hp--;snd.tone(400,.03,.06);if(e.hp<=0){G.score+=100;snd.noise(.05,.06,2000);return false}}if(Math.abs(wx-e.x)<8&&Math.abs(G.py-e.y)<14){G.hp--;snd.tone(150,.08,.06,'sawtooth');e.vx*=-1;if(G.hp<=0){G.dead=true;snd.tone(80,.3,.1,'sawtooth')}}return true});if(wx>G.bossX-RW&&G.bossHp>0){G.bossPhase=true;G.bullets=G.bullets.filter(function(b){if(Math.abs(b.x-G.bossX)<20&&Math.abs(b.y-G.bossY)<20){G.bossHp--;snd.hit();if(G.bossHp<=0){G.score+=1000;snd.win()}return false}return true});if(Math.abs(wx-G.bossX)<16&&Math.abs(G.py-G.bossY)<20){G.hp--;snd.tone(150,.08,.06,'sawtooth')}}}\nif(mode==='draw'){cls('#000');G.plats.forEach(function(p){var sx=p.x-G.scroll;if(sx>-60&&sx<RW+10){O.fillStyle=p.h>10?'#444':'#666';O.fillRect(sx,p.y,p.w,p.h)}});G.enemies.forEach(function(e){var sx=e.x-G.scroll;if(sx<-20||sx>RW+20)return;O.fillStyle='#cc4444';O.fillRect(sx-5,e.y,10,16);O.fillStyle='#ff8888';O.fillRect(sx-3,e.y+2,6,4)});if(G.bossPhase&&G.bossHp>0){var bsx=G.bossX-G.scroll;O.fillStyle='#cc00cc';O.fillRect(bsx-16,G.bossY-16,32,32);O.fillStyle='#ff66ff';O.fillRect(bsx-10,G.bossY-10,20,12);txt(G.bossHp+'',bsx,G.bossY-22,7,'#fff')}G.bullets.forEach(function(b){var sx=b.x-G.scroll;O.fillStyle='#44ffff';O.fillRect(sx-3,b.y-1,6,3)});if(!G.dead){O.fillStyle='#4488ff';O.fillRect(G.px-5,G.py,10,16);O.fillStyle='#ffccaa';O.fillRect(G.px-3,G.py-3,6,5);O.fillStyle='#4488ff';O.fillRect(G.px+(G.dir>0?5:-8),G.py+4,3,3)}rect(8,6,52,5,'#333');rect(8,6,Math.max(0,G.hp*5),5,'#44ff44');txt(String(G.score),RW-8,8,8,'#fff','right');if(G.dead)txt('GAME OVER',RW/2,RH/2,16,'#ff4444');if(G.bossHp<=0&&G.bossPhase)txt('YOU WIN!',RW/2,RH/2,16,'#44ff44');hud('HP: '+G.hp+' ¬∑ SCORE: '+G.score);controls('A/D Move ¬∑ W/Space Jump ¬∑ F/Enter Shoot')}"
    },
    {
      "id": "duck-patrol",
      "name": "Duck Patrol",
      "icon": "ü¶Ü",
      "desc": "Click to shoot flying targets",
      "code": "if(mode==='init'){G.score=0;G.round=1;G.ducks=[];G.shots=3;G.hits=0;G.needed=3;G.timer=300;G.flashes=[];G.roundOver=false;G.roundMsg=0;G.miss=0;function newRound(){G.ducks=[];G.shots=3;G.hits=0;G.timer=300;G.roundOver=false;for(var i=0;i<Math.min(2+Math.floor(G.round/3),5);i++)G.ducks.push({x:Math.random()*RW,y:RH-40,vx:(Math.random()-.5)*3,vy:-1.5-Math.random()*G.round*.2,alive:true,escaped:false})}newRound();G.newRound=newRound}\nif(mode==='update'){if(G.roundOver){G.roundMsg--;if(G.roundMsg<=0){G.round++;G.needed=Math.min(2+Math.floor(G.round/2),5);G.newRound()}return}G.timer--;G.ducks.forEach(function(d){if(!d.alive||d.escaped)return;d.x+=d.vx;d.y+=d.vy;if(d.x<0||d.x>RW)d.vx*=-1;if(d.y<-10)d.escaped=true});if(click()&&G.shots>0){G.shots--;G.flashes.push({x:mx,y:my,life:6});snd.noise(.04,.08,3000);var hitAny=false;G.ducks.forEach(function(d){if(d.alive&&!d.escaped&&Math.abs(mx-d.x)<14&&Math.abs(my-d.y)<14){d.alive=false;d.vy=2;G.hits++;G.score+=100*G.round;hitAny=true;snd.tone(600,.06,.08);snd.tone(800,.06,.08)}});if(!hitAny)G.miss++}var allDone=G.ducks.every(function(d){return!d.alive||d.escaped||d.y>RH});if(allDone||G.timer<=0||(G.shots<=0&&G.hits<G.needed)){G.roundOver=true;G.roundMsg=90;if(G.hits>=G.needed)snd.score();else snd.die()}G.flashes=G.flashes.filter(function(f){f.life--;return f.life>0})}\nif(mode==='draw'){cls('#5c94fc');rect(0,RH-30,RW,30,'#228822');rect(0,RH-34,RW,4,'#44aa44');for(var x=0;x<RW;x+=30){O.fillStyle='#1a6a1a';O.fillRect(x,RH-40,8,10);O.fillRect(x+2,RH-46,4,6)}G.ducks.forEach(function(d){if(d.escaped)return;if(d.alive){O.fillStyle='#cc8800';O.fillRect(d.x-6,d.y-4,12,8);O.fillStyle='#fff';O.fillRect(d.x-3,d.y-2,3,2);O.fillStyle='#000';O.fillRect(d.x-2,d.y-1,1,1);var wingY=Math.sin(Date.now()*.01)*3;O.fillStyle='#cc8800';O.fillRect(d.x-8,d.y-2+wingY,4,3);O.fillRect(d.x+4,d.y-2-wingY,4,3)}else{O.fillStyle='#666';O.fillRect(d.x-4,d.y-3,8,6)}});G.flashes.forEach(function(f){O.fillStyle='rgba(255,255,200,'+f.life/6+')';O.beginPath();O.arc(f.x,f.y,8,0,Math.PI*2);O.fill()});O.fillStyle='#000';O.fillRect(mx-1,my-8,2,6);O.fillRect(mx-1,my+2,2,6);O.fillRect(mx-8,my-1,6,2);O.fillRect(mx+2,my-1,6,2);txt('ROUND '+G.round,RW/2,12,10,'#fff');txt('SCORE: '+G.score,RW-10,12,8,'#ffcc00','right');for(var i=0;i<3;i++){O.fillStyle=i<G.shots?'#ffcc00':'#444';O.fillRect(10+i*10,RH-12,6,8)}txt(G.hits+'/'+G.needed+' HITS',RW/2,RH-12,7,'#fff');if(G.roundOver){var won=G.hits>=G.needed;txt(won?'NICE!':'MISS!',RW/2,RH/2,20,won?'#44ff44':'#ff4444')}hud('ROUND '+G.round+' ¬∑ SCORE: '+G.score+' ¬∑ SHOTS: '+G.shots);controls('Click/tap to shoot! Get '+G.needed+' hits per round')}"
    },
    {
      "id": "ice-ascent",
      "name": "Ice Ascent",
      "icon": "üßä",
      "desc": "Vertical climb, break ice",
      "code": "if(mode==='init'){G.px=RW/2;G.py=RH-30;G.vy=0;G.ground=true;G.scroll=0;G.score=0;G.hp=3;G.dead=false;G.atk=0;G.plats=[];G.ice=[];G.enemies=[];G.vegs=[];for(var i=0;i<50;i++){var y=RH-40-i*30;var x=20+Math.random()*(RW-40);G.plats.push({x:x,y:y,w:40,h:6});if(Math.random()<.4)G.ice.push({x:x+10,y:y-10,w:20,h:10,broken:false});if(Math.random()<.2)G.enemies.push({x:x+20,y:y-10,vx:.5,alive:true});if(Math.random()<.15)G.vegs.push({x:x+Math.random()*30,y:y-8,got:false})}}\nif(mode==='update'){if(G.dead)return;var spd=2;if(K('a')||K('ArrowLeft'))G.px-=spd;if(K('d')||K('ArrowRight'))G.px+=spd;G.px=Math.max(6,Math.min(RW-6,G.px));if((K('w')||K(' ')||K('ArrowUp'))&&G.ground){G.vy=-5.5;G.ground=false;snd.jump()}G.atk--;if((K('Enter')||K('f'))&&G.atk<=0){G.atk=8;snd.tone(300,.03,.05)}G.vy+=.25;G.py+=G.vy;G.ground=false;var wy=G.py+G.scroll;G.plats.forEach(function(p){if(G.px+5>p.x&&G.px-5<p.x+p.w&&wy+14>=p.y&&wy+14-G.vy<=p.y+3&&G.vy>=0){G.py=p.y-G.scroll-14;G.vy=0;G.ground=true}});if(G.atk>3){G.ice.forEach(function(ic){if(!ic.broken&&G.px+5>ic.x&&G.px-5<ic.x+ic.w&&Math.abs(wy-ic.y)<16){ic.broken=true;G.score+=10;snd.noise(.04,.06,3000)}});G.enemies.forEach(function(e){if(e.alive&&Math.abs(G.px-e.x)<12&&Math.abs(wy-e.y)<14){e.alive=false;G.score+=50;snd.hit()}})}G.enemies.forEach(function(e){if(!e.alive)return;e.x+=e.vx;if(e.x<10||e.x>RW-10)e.vx*=-1;if(G.atk<=3&&Math.abs(G.px-e.x)<8&&Math.abs(wy-e.y)<12){G.hp--;snd.tone(150,.1,.06,'sawtooth');if(G.hp<=0)G.dead=true}});G.vegs.forEach(function(v){if(!v.got&&Math.abs(G.px-v.x)<10&&Math.abs(wy-v.y)<10){v.got=true;G.score+=100;snd.pickup()}});if(G.py<RH/3)G.scroll-=RH/3-G.py,G.py=RH/3;if(G.py>RH+20){G.dead=true;snd.die()}}\nif(mode==='draw'){cls('#111133');for(var i=0;i<G.plats.length;i++){var p=G.plats[i],sy=p.y+G.scroll;if(sy<-10||sy>RH+10)continue;O.fillStyle='#668';O.fillRect(p.x,sy,p.w,p.h);O.fillStyle='#aaccff';O.fillRect(p.x,sy,p.w,2)}G.ice.forEach(function(ic){var sy=ic.y+G.scroll;if(sy<-10||sy>RH+10||ic.broken)return;O.fillStyle='#aaeeff';O.fillRect(ic.x,sy,ic.w,ic.h);O.fillStyle='#cceeff';O.fillRect(ic.x+2,sy+2,ic.w-4,3)});G.enemies.forEach(function(e){if(!e.alive)return;var sy=e.y+G.scroll;if(sy<-10||sy>RH+10)return;O.fillStyle='#cc44cc';O.fillRect(e.x-5,sy-5,10,10)});G.vegs.forEach(function(v){if(v.got)return;var sy=v.y+G.scroll;if(sy<-10||sy>RH+10)return;O.fillStyle='#44cc44';O.fillRect(v.x-3,sy-4,6,8);txt('V',v.x,sy,6,'#fff')});if(!G.dead){var py2=G.py;O.fillStyle='#4488ff';O.fillRect(G.px-5,py2,10,14);O.fillStyle='#ffccaa';O.fillRect(G.px-3,py2-3,6,5);if(G.atk>3){O.fillStyle='#aaa';O.fillRect(G.px-8,py2-2,4,10)}}for(var i=0;i<G.hp;i++)txt('‚ô•',10+i*12,10,8,'#ff4444','left');txt(String(G.score),RW-8,10,8,'#fff','right');if(G.dead)txt('GAME OVER',RW/2,RH/2,16,'#ff4444');hud('HP: '+G.hp+' ¬∑ SCORE: '+G.score);controls('A/D Move ¬∑ W/Space Jump ¬∑ F/Enter Hammer ¬∑ Break ice, dodge enemies, collect veggies')}"
    }
  ]
}
