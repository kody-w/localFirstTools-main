<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Recursive Ziggurat</title>
    <meta name="description" content="Explore an infinitely self-similar stepped pyramid where each level contains a smaller replica of itself">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { background: #0a0808; min-height: 100vh; font-family: monospace; color: #c0a080; overflow: hidden; }
        #canvas { position: fixed; top: 0; left: 0; cursor: pointer; }
        #controls {
            position: fixed; top: 20px; left: 20px; background: rgba(30,20,15,0.95);
            padding: 20px; border-radius: 10px; border: 1px solid rgba(200,150,100,0.3);
            z-index: 100;
        }
        h3 { margin-bottom: 15px; color: #e0c0a0; }
        .control-row { margin: 10px 0; }
        label { display: block; font-size: 11px; margin-bottom: 5px; opacity: 0.8; }
        input[type="range"] { width: 140px; }
        .value { float: right; color: #ffa050; font-size: 12px; }
        button {
            display: block; width: 100%; padding: 8px; margin: 8px 0;
            background: rgba(120,80,40,0.5); border: 1px solid rgba(200,150,100,0.4);
            color: #c0a080; cursor: pointer; border-radius: 6px;
        }
        #depth-display {
            position: fixed; top: 20px; right: 20px; background: rgba(30,20,15,0.95);
            padding: 20px; border-radius: 10px; border: 1px solid rgba(200,150,100,0.3);
            text-align: center; z-index: 100;
        }
        .stat-value { font-size: 32px; color: #ffa050; }
        .stat-label { font-size: 11px; opacity: 0.7; }
        #info { position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); font-size: 12px; opacity: 0.5; z-index: 100; }
    </style>
</head>
<body>
    <canvas id="canvas"></canvas>
    <div id="controls">
        <h3>Recursive Ziggurat</h3>
        <div class="control-row">
            <label>Rotation Speed <span class="value" id="rot-val">50</span></label>
            <input type="range" id="rotation" min="0" max="100" value="50">
        </div>
        <div class="control-row">
            <label>Glitch Intensity <span class="value" id="glitch-val">20</span></label>
            <input type="range" id="glitch" min="0" max="100" value="20">
        </div>
        <button id="zoom-in">Descend Deeper</button>
        <button id="zoom-out">Ascend</button>
        <button id="reset">Reset View</button>
    </div>
    <div id="depth-display">
        <div class="stat-value" id="depth">1</div>
        <div class="stat-label">Current Depth</div>
        <div style="margin-top:10px">
            <div class="stat-value" id="levels">âˆž</div>
            <div class="stat-label">Total Levels</div>
        </div>
    </div>
    <div id="info">Click to zoom | Each level contains itself | Infinite recursion</div>
    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        let W, H;
        function resize() { W = canvas.width = innerWidth; H = canvas.height = innerHeight; }
        resize(); window.onresize = resize;
        
        let zoom = 1;
        let targetZoom = 1;
        let rotation = 0;
        let rotationSpeed = 0.005;
        let glitchIntensity = 0.2;
        let depth = 1;
        let time = 0;
        
        function drawZiggurat(cx, cy, size, levels, recursionDepth) {
            if (size < 3 || recursionDepth > 6) return;
            
            const stepHeight = size * 0.08;
            const stepWidth = size * 0.15;
            
            for (let i = levels - 1; i >= 0; i--) {
                const levelSize = size - i * stepWidth * 2;
                const levelY = cy - i * stepHeight;
                
                const glitchX = glitchIntensity > 0 ? (Math.random() - 0.5) * glitchIntensity * 10 * Math.sin(time * 5 + i) : 0;
                const glitchY = glitchIntensity > 0 ? (Math.random() - 0.5) * glitchIntensity * 5 * Math.cos(time * 3 + i) : 0;
                
                const hue = 30 + i * 5 + recursionDepth * 20;
                const lightness = 40 - i * 3 - recursionDepth * 5;
                
                ctx.save();
                ctx.translate(cx + glitchX, levelY + glitchY);
                ctx.rotate(rotation + recursionDepth * 0.1);
                
                ctx.beginPath();
                ctx.moveTo(-levelSize / 2, stepHeight / 2);
                ctx.lineTo(-levelSize / 2 + levelSize * 0.1, -stepHeight / 2);
                ctx.lineTo(levelSize / 2 - levelSize * 0.1, -stepHeight / 2);
                ctx.lineTo(levelSize / 2, stepHeight / 2);
                ctx.closePath();
                
                const grad = ctx.createLinearGradient(-levelSize / 2, 0, levelSize / 2, 0);
                grad.addColorStop(0, "hsl(" + hue + ", 50%, " + (lightness - 10) + "%)");
                grad.addColorStop(0.5, "hsl(" + hue + ", 60%, " + lightness + "%)");
                grad.addColorStop(1, "hsl(" + hue + ", 50%, " + (lightness - 15) + "%)");
                ctx.fillStyle = grad;
                ctx.fill();
                
                ctx.strokeStyle = "hsl(" + hue + ", 70%, " + (lightness + 20) + "%)";
                ctx.lineWidth = 1;
                ctx.stroke();
                
                if (i === Math.floor(levels / 2) && recursionDepth < 5) {
                    ctx.beginPath();
                    ctx.arc(0, 0, levelSize * 0.05, 0, Math.PI * 2);
                    ctx.fillStyle = "rgba(255, 200, 100, " + (0.5 - recursionDepth * 0.1) + ")";
                    ctx.fill();
                }
                
                ctx.restore();
            }
            
            if (recursionDepth < 5) {
                const innerSize = size * 0.35;
                const innerY = cy - levels * stepHeight * 0.5;
                drawZiggurat(cx, innerY, innerSize, Math.floor(levels * 0.7), recursionDepth + 1);
            }
        }
        
        function drawBackground() {
            const grad = ctx.createRadialGradient(W/2, H/2, 0, W/2, H/2, Math.max(W, H));
            grad.addColorStop(0, '#1a1510');
            grad.addColorStop(0.5, '#0a0808');
            grad.addColorStop(1, '#050404');
            ctx.fillStyle = grad;
            ctx.fillRect(0, 0, W, H);
            
            for (let i = 0; i < 50; i++) {
                const x = (Math.sin(i * 1.5 + time * 0.1) + 1) / 2 * W;
                const y = (Math.cos(i * 2.3 + time * 0.05) + 1) / 2 * H;
                ctx.beginPath();
                ctx.arc(x, y, 1, 0, Math.PI * 2);
                ctx.fillStyle = "rgba(255, 200, 150, " + (0.2 + Math.sin(time + i) * 0.1) + ")";
                ctx.fill();
            }
        }
        
        function drawAura() {
            const grad = ctx.createRadialGradient(W/2, H/2, 0, W/2, H/2, 200 * zoom);
            grad.addColorStop(0, 'rgba(255, 180, 100, 0.1)');
            grad.addColorStop(0.5, 'rgba(200, 100, 50, 0.05)');
            grad.addColorStop(1, 'transparent');
            ctx.fillStyle = grad;
            ctx.fillRect(0, 0, W, H);
        }
        
        function animate() {
            time += 0.016;
            rotation += rotationSpeed;
            
            zoom += (targetZoom - zoom) * 0.05;
            
            drawBackground();
            
            ctx.save();
            ctx.translate(W/2, H/2);
            ctx.scale(zoom, zoom);
            ctx.translate(-W/2, -H/2);
            
            drawZiggurat(W/2, H/2 + 50, 400, 8, 0);
            
            ctx.restore();
            
            drawAura();
            
            if (glitchIntensity > 0.5 && Math.random() < 0.05) {
                ctx.fillStyle = "rgba(255, 200, 100, " + (glitchIntensity * 0.1) + ")";
                const gx = Math.random() * W;
                const gy = Math.random() * H;
                ctx.fillRect(gx, gy, Math.random() * 100, 2);
            }
            
            requestAnimationFrame(animate);
        }
        
        document.getElementById('rotation').oninput = e => {
            rotationSpeed = e.target.value / 5000;
            document.getElementById('rot-val').textContent = e.target.value;
        };
        
        document.getElementById('glitch').oninput = e => {
            glitchIntensity = e.target.value / 100;
            document.getElementById('glitch-val').textContent = e.target.value;
        };
        
        document.getElementById('zoom-in').onclick = () => {
            targetZoom *= 1.5;
            depth++;
            document.getElementById('depth').textContent = depth;
        };
        
        document.getElementById('zoom-out').onclick = () => {
            targetZoom = Math.max(0.5, targetZoom / 1.5);
            depth = Math.max(1, depth - 1);
            document.getElementById('depth').textContent = depth;
        };
        
        document.getElementById('reset').onclick = () => {
            targetZoom = 1;
            depth = 1;
            document.getElementById('depth').textContent = depth;
        };
        
        canvas.onclick = e => {
            const cx = W / 2;
            const cy = H / 2;
            const dx = e.clientX - cx;
            const dy = e.clientY - cy;
            const dist = Math.sqrt(dx * dx + dy * dy);
            
            if (dist < 150 * zoom) {
                targetZoom *= 1.5;
                depth++;
                document.getElementById('depth').textContent = depth;
            }
        };
        
        animate();
    </script>
</body>
</html>