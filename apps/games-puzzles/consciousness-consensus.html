<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Consciousness Consensus Engine</title>
    <meta name="description" content="Watch consciousness emerge from chaos as neural agents synchronize into unified patterns">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { background: #0a0a0a; overflow: hidden; font-family: monospace; color: #88ff88; }
        #canvas { position: fixed; top: 0; left: 0; }
        #controls {
            position: fixed; top: 20px; left: 20px; background: rgba(0,0,0,0.7);
            padding: 20px; border-radius: 10px; border: 1px solid #333; z-index: 100;
        }
        .control-row { margin: 10px 0; }
        label { display: block; font-size: 11px; margin-bottom: 5px; opacity: 0.7; }
        input[type="range"] { width: 150px; }
        #stats {
            position: fixed; top: 20px; right: 20px; background: rgba(0,0,0,0.7);
            padding: 20px; border-radius: 10px; border: 1px solid #333; z-index: 100;
            text-align: right;
        }
        .stat { margin: 5px 0; }
        .stat-value { font-size: 24px; color: #aaffaa; }
        .stat-label { font-size: 10px; opacity: 0.6; }
        #info {
            position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%);
            font-size: 12px; opacity: 0.5; z-index: 100;
        }
        button {
            padding: 8px 16px; background: #1a3a1a; border: 1px solid #3a5a3a;
            color: #88ff88; cursor: pointer; border-radius: 5px; margin-top: 10px;
        }
    </style>
</head>
<body>
    <canvas id="canvas"></canvas>
    <div id="controls">
        <h3 style="margin-bottom:15px">Neural Parameters</h3>
        <div class="control-row">
            <label>Agents: <span id="agent-val">100</span></label>
            <input type="range" id="agent-count" min="20" max="300" value="100">
        </div>
        <div class="control-row">
            <label>Coupling Strength: <span id="coupling-val">0.5</span></label>
            <input type="range" id="coupling" min="0" max="100" value="50">
        </div>
        <div class="control-row">
            <label>Signal Decay: <span id="decay-val">0.9</span></label>
            <input type="range" id="decay" min="80" max="99" value="90">
        </div>
        <button id="inject-btn">Inject Stimulus</button>
        <button id="lesion-btn">Lesion (Remove 10%)</button>
        <button id="reset-btn">Reset</button>
    </div>
    <div id="stats">
        <div class="stat"><div class="stat-value" id="sync-level">0%</div><div class="stat-label">Synchronization</div></div>
        <div class="stat"><div class="stat-value" id="active-count">0</div><div class="stat-label">Active Neurons</div></div>
        <div class="stat"><div class="stat-value" id="cluster-count">0</div><div class="stat-label">Clusters</div></div>
    </div>
    <div id="info">Click anywhere to inject stimulus | Watch consciousness emerge from chaos</div>
    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        let W, H;
        function resize() { W = canvas.width = innerWidth; H = canvas.height = innerHeight; }
        resize(); window.onresize = resize;
        
        let agents = [];
        let connections = [];
        let coupling = 0.5;
        let decay = 0.9;
        
        class Neuron {
            constructor(x, y) {
                this.x = x; this.y = y;
                this.belief = Math.random();
                this.activation = 0;
                this.phase = Math.random() * Math.PI * 2;
                this.neighbors = [];
            }
            update() {
                this.phase += 0.02 + this.activation * 0.05;
                let sum = 0;
                this.neighbors.forEach(n => {
                    sum += Math.sin(n.phase - this.phase) * coupling * 0.1;
                    if (n.activation > 0.5) this.activation += 0.1 * coupling;
                });
                this.phase += sum;
                this.activation *= decay;
                this.belief += (Math.sin(this.phase) * 0.5 + 0.5 - this.belief) * 0.01;
            }
            draw() {
                const r = 5 + this.activation * 10;
                const hue = this.belief * 120;
                const alpha = 0.3 + this.activation * 0.7;
                ctx.beginPath();
                ctx.arc(this.x, this.y, r, 0, Math.PI * 2);
                ctx.fillStyle = "hsla(" + hue + ", 80%, 50%, " + alpha + ")";
                ctx.fill();
                if (this.activation > 0.3) {
                    ctx.beginPath();
                    ctx.arc(this.x, this.y, r + 5, 0, Math.PI * 2);
                    ctx.strokeStyle = "hsla(" + hue + ", 80%, 50%, " + (alpha * 0.3) + ")";
                    ctx.stroke();
                }
            }
        }
        
        function init(count) {
            agents = [];
            connections = [];
            for (let i = 0; i < count; i++) {
                agents.push(new Neuron(100 + Math.random() * (W - 200), 100 + Math.random() * (H - 200)));
            }
            agents.forEach(a => {
                agents.forEach(b => {
                    if (a !== b) {
                        const d = Math.hypot(a.x - b.x, a.y - b.y);
                        if (d < 100) {
                            a.neighbors.push(b);
                            connections.push({a, b});
                        }
                    }
                });
            });
        }
        
        function injectStimulus(x, y) {
            agents.forEach(a => {
                const d = Math.hypot(a.x - x, a.y - y);
                if (d < 100) a.activation = 1;
            });
        }
        
        function calcSync() {
            if (agents.length === 0) return 0;
            let sumCos = 0, sumSin = 0;
            agents.forEach(a => { sumCos += Math.cos(a.phase); sumSin += Math.sin(a.phase); });
            return Math.sqrt(sumCos * sumCos + sumSin * sumSin) / agents.length;
        }
        
        function animate() {
            ctx.fillStyle = 'rgba(10, 10, 10, 0.2)';
            ctx.fillRect(0, 0, W, H);
            
            connections.forEach(c => {
                const alpha = 0.05 + (c.a.activation + c.b.activation) * 0.1;
                ctx.beginPath();
                ctx.moveTo(c.a.x, c.a.y);
                ctx.lineTo(c.b.x, c.b.y);
                ctx.strokeStyle = "rgba(50, 150, 50, " + alpha + ")";
                ctx.stroke();
            });
            
            agents.forEach(a => { a.update(); a.draw(); });
            
            const sync = calcSync();
            document.getElementById('sync-level').textContent = Math.round(sync * 100) + '%';
            document.getElementById('active-count').textContent = agents.filter(a => a.activation > 0.3).length;
            document.getElementById('cluster-count').textContent = Math.round(sync * 5);
            
            requestAnimationFrame(animate);
        }
        
        document.getElementById('agent-count').oninput = e => {
            document.getElementById('agent-val').textContent = e.target.value;
        };
        document.getElementById('coupling').oninput = e => {
            coupling = e.target.value / 100;
            document.getElementById('coupling-val').textContent = coupling.toFixed(2);
        };
        document.getElementById('decay').oninput = e => {
            decay = e.target.value / 100;
            document.getElementById('decay-val').textContent = decay.toFixed(2);
        };
        document.getElementById('inject-btn').onclick = () => injectStimulus(W/2, H/2);
        document.getElementById('lesion-btn').onclick = () => {
            const remove = Math.floor(agents.length * 0.1);
            for (let i = 0; i < remove; i++) {
                const idx = Math.floor(Math.random() * agents.length);
                agents.splice(idx, 1);
            }
            connections = connections.filter(c => agents.includes(c.a) && agents.includes(c.b));
        };
        document.getElementById('reset-btn').onclick = () => init(parseInt(document.getElementById('agent-count').value));
        canvas.onclick = e => injectStimulus(e.clientX, e.clientY);
        
        init(100);
        animate();
    </script>
</body>
</html>