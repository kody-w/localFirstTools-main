<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Imprint Erosion</title>
    <meta name="description" content="Touch leaves thermal trails that slowly cool and fade, creating a palimpsest of movement history revealed through heat">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { background: #0a0815; min-height: 100vh; font-family: 'Georgia', serif; color: #8090a0; overflow: hidden; }
        #canvas { position: fixed; top: 0; left: 0; cursor: crosshair; }
        #controls {
            position: fixed; top: 20px; left: 20px; background: rgba(15,12,25,0.95);
            padding: 20px; border-radius: 10px; border: 1px solid rgba(100,120,160,0.3);
            z-index: 100;
        }
        h3 { margin-bottom: 15px; color: #c0a080; font-weight: normal; }
        .control-row { margin: 10px 0; }
        label { display: block; font-size: 11px; margin-bottom: 5px; opacity: 0.8; }
        input[type="range"] { width: 140px; }
        .value { float: right; color: #e0b080; font-size: 12px; }
        button {
            display: block; width: 100%; padding: 10px; margin: 6px 0;
            background: rgba(100,80,60,0.4); border: 1px solid rgba(160,120,80,0.4);
            color: #b09070; cursor: pointer; border-radius: 6px; font-family: inherit;
        }
        #temp-display { position: fixed; top: 20px; right: 20px; font-size: 12px; color: #806050; z-index: 100; }
        #info { position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); font-size: 12px; opacity: 0.5; z-index: 100; }
    </style>
</head>
<body>
    <canvas id="canvas"></canvas>
    <div id="controls">
        <h3>Imprint Erosion</h3>
        <div class="control-row">
            <label>Heat Intensity <span class="value" id="heat-val">70</span></label>
            <input type="range" id="heat" min="20" max="100" value="70">
        </div>
        <div class="control-row">
            <label>Cooling Rate <span class="value" id="cool-val">30</span></label>
            <input type="range" id="cool" min="5" max="80" value="30">
        </div>
        <button id="breath-btn">Warm Breath</button>
        <button id="freeze-btn">Flash Freeze</button>
    </div>
    <div id="temp-display">Avg Temp: 0.0°</div>
    <div id="info">Move cursor to create heat trails | Watch thermal memories fade</div>
    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        let W, H;
        const resolution = 8;
        let heatMap = [];
        
        function resize() { 
            W = canvas.width = innerWidth; 
            H = canvas.height = innerHeight;
            initHeatMap();
        }
        
        function initHeatMap() {
            heatMap = [];
            for (let y = 0; y < H; y += resolution) {
                for (let x = 0; x < W; x += resolution) {
                    heatMap.push({
                        x, y,
                        temp: 0,
                        maxTemp: 0,
                        lastTouch: 0
                    });
                }
            }
        }
        
        resize(); window.onresize = resize;
        
        let heatIntensity = 0.7;
        let coolingRate = 0.3;
        let time = 0;
        let mouseX = -100, mouseY = -100;
        let isMoving = false;
        let lastMoveTime = 0;
        
        function applyHeat(x, y, amount) {
            const radius = 40;
            heatMap.forEach(cell => {
                const dist = Math.hypot(cell.x - x, cell.y - y);
                if (dist < radius) {
                    const intensity = (1 - dist / radius) * amount * heatIntensity;
                    cell.temp = Math.min(1, cell.temp + intensity);
                    cell.maxTemp = Math.max(cell.maxTemp, cell.temp);
                    cell.lastTouch = time;
                }
            });
        }
        
        function getTemperatureColor(temp, maxTemp) {
            if (temp < 0.01) return null;
            
            const age = Math.max(0, 1 - (maxTemp - temp) * 2);
            
            let r, g, b;
            if (temp > 0.8) {
                r = 255;
                g = 255 - (temp - 0.8) * 500;
                b = 200 - temp * 200;
            } else if (temp > 0.5) {
                r = 255;
                g = 100 + (0.8 - temp) * 400;
                b = 50;
            } else if (temp > 0.2) {
                r = 200 + temp * 100;
                g = 50 + temp * 100;
                b = 50 + (0.5 - temp) * 100;
            } else {
                r = 60 + temp * 400;
                g = 40 + temp * 50;
                b = 80 + temp * 200;
            }
            
            return { r: Math.min(255, r), g: Math.max(0, g), b: Math.max(0, b), a: temp * 0.9 };
        }
        
        function drawHeatMap() {
            ctx.fillStyle = '#0a0815';
            ctx.fillRect(0, 0, W, H);
            
            let totalTemp = 0;
            let activeCount = 0;
            
            heatMap.forEach(cell => {
                if (cell.temp < 0.01) return;
                
                const color = getTemperatureColor(cell.temp, cell.maxTemp);
                if (!color) return;
                
                ctx.fillStyle = "rgba(" + Math.floor(color.r) + "," + Math.floor(color.g) + "," + Math.floor(color.b) + "," + color.a + ")";
                ctx.fillRect(cell.x, cell.y, resolution, resolution);
                
                totalTemp += cell.temp;
                activeCount++;
                
                if (cell.temp > 0.6) {
                    ctx.fillStyle = "rgba(255, 255, 200, " + ((cell.temp - 0.6) * 0.5) + ")";
                    ctx.beginPath();
                    ctx.arc(cell.x + resolution/2, cell.y + resolution/2, resolution * cell.temp, 0, Math.PI * 2);
                    ctx.fill();
                }
            });
            
            const avgTemp = activeCount > 0 ? (totalTemp / activeCount * 100).toFixed(1) : 0;
            document.getElementById('temp-display').textContent = 'Avg Temp: ' + avgTemp + '°';
        }
        
        function coolDown() {
            const coolAmount = coolingRate * 0.001;
            
            heatMap.forEach(cell => {
                if (cell.temp > 0) {
                    const timeSinceTouch = time - cell.lastTouch;
                    const decayMultiplier = 1 + timeSinceTouch * 0.1;
                    cell.temp = Math.max(0, cell.temp - coolAmount * decayMultiplier);
                    
                    if (cell.temp < 0.05) {
                        cell.maxTemp *= 0.99;
                    }
                }
            });
        }
        
        function diffuseHeat() {
            const cols = Math.ceil(W / resolution);
            const rows = Math.ceil(H / resolution);
            
            const newTemps = heatMap.map(c => c.temp);
            
            heatMap.forEach((cell, i) => {
                if (cell.temp < 0.01) return;
                
                const col = Math.floor(cell.x / resolution);
                const row = Math.floor(cell.y / resolution);
                
                const neighbors = [
                    row > 0 ? i - cols : -1,
                    row < rows - 1 ? i + cols : -1,
                    col > 0 ? i - 1 : -1,
                    col < cols - 1 ? i + 1 : -1
                ].filter(n => n >= 0 && n < heatMap.length);
                
                const diffusion = cell.temp * 0.02;
                neighbors.forEach(ni => {
                    if (heatMap[ni].temp < cell.temp) {
                        newTemps[ni] += diffusion / neighbors.length;
                        newTemps[i] -= diffusion / neighbors.length;
                    }
                });
            });
            
            heatMap.forEach((cell, i) => {
                cell.temp = Math.max(0, Math.min(1, newTemps[i]));
            });
        }
        
        function animate() {
            time += 0.016;
            
            if (isMoving) {
                applyHeat(mouseX, mouseY, 0.1);
            }
            
            coolDown();
            diffuseHeat();
            drawHeatMap();
            
            requestAnimationFrame(animate);
        }
        
        canvas.onmousemove = e => {
            mouseX = e.clientX;
            mouseY = e.clientY;
            isMoving = true;
            lastMoveTime = time;
            
            if (e.clientX > 200 || e.clientY > 280) {
                applyHeat(e.clientX, e.clientY, 0.15);
            }
        };
        
        canvas.onmousedown = e => {
            if (e.clientX > 200 || e.clientY > 280) {
                applyHeat(e.clientX, e.clientY, 0.5);
            }
        };
        
        setInterval(() => {
            if (time - lastMoveTime > 0.1) {
                isMoving = false;
            }
        }, 100);
        
        document.getElementById('heat').oninput = e => {
            heatIntensity = e.target.value / 100;
            document.getElementById('heat-val').textContent = e.target.value;
        };
        
        document.getElementById('cool').oninput = e => {
            coolingRate = e.target.value / 100;
            document.getElementById('cool-val').textContent = e.target.value;
        };
        
        document.getElementById('breath-btn').onclick = () => {
            for (let i = 0; i < 20; i++) {
                const angle = Math.random() * Math.PI * 2;
                const dist = Math.random() * 100;
                applyHeat(
                    W/2 + Math.cos(angle) * dist,
                    H/2 + Math.sin(angle) * dist,
                    0.3
                );
            }
        };
        
        document.getElementById('freeze-btn').onclick = () => {
            heatMap.forEach(cell => {
                cell.temp *= 0.3;
            });
        };
        
        animate();
    </script>
</body>
</html>