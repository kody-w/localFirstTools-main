<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Glacial Core</title>
    <meta name="description" content="Drill through layers of ancient ice to reveal preserved moments frozen in time, each stratum holding atmospheric memories">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { background: #0a0f18; min-height: 100vh; font-family: 'Georgia', serif; color: #90a0c0; overflow: hidden; }
        #canvas { position: fixed; top: 0; left: 0; cursor: crosshair; }
        #controls {
            position: fixed; top: 20px; left: 20px; background: rgba(10,18,30,0.95);
            padding: 20px; border-radius: 10px; border: 1px solid rgba(100,150,200,0.3);
            z-index: 100;
        }
        h3 { margin-bottom: 15px; color: #a0c0e0; font-weight: normal; }
        .control-row { margin: 10px 0; }
        label { display: block; font-size: 11px; margin-bottom: 5px; opacity: 0.8; }
        input[type="range"] { width: 140px; }
        .value { float: right; color: #b0d0f0; font-size: 12px; }
        button {
            display: block; width: 100%; padding: 10px; margin: 6px 0;
            background: rgba(60,100,140,0.4); border: 1px solid rgba(100,150,200,0.4);
            color: #90b0d0; cursor: pointer; border-radius: 6px; font-family: inherit;
        }
        #depth-display { position: fixed; top: 20px; right: 20px; font-size: 12px; color: #607090; z-index: 100; text-align: right; }
        #memory-panel {
            position: fixed; bottom: 80px; left: 50%; transform: translateX(-50%);
            background: rgba(10,18,30,0.95); padding: 15px 25px; border-radius: 10px;
            border: 1px solid rgba(100,150,200,0.3); z-index: 100;
            font-size: 13px; color: #a0c0e0; text-align: center;
            opacity: 0; transition: opacity 0.5s;
        }
        #info { position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); font-size: 12px; opacity: 0.5; z-index: 100; }
    </style>
</head>
<body>
    <canvas id="canvas"></canvas>
    <div id="controls">
        <h3>Glacial Core</h3>
        <div class="control-row">
            <label>Drill Intensity <span class="value" id="drill-val">50</span></label>
            <input type="range" id="drill" min="20" max="100" value="50">
        </div>
        <div class="control-row">
            <label>Core Width <span class="value" id="width-val">60</span></label>
            <input type="range" id="width" min="30" max="120" value="60">
        </div>
        <button id="freeze-btn">Freeze New Layer</button>
        <button id="reset-btn">Reset Core</button>
    </div>
    <div id="depth-display">
        <div>Depth: <span id="current-depth">0</span>m</div>
        <div>Era: <span id="current-era">Present</span></div>
    </div>
    <div id="memory-panel"></div>
    <div id="info">Click and drag down to drill | Reveal frozen memories in ancient ice</div>
    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        let W, H;
        function resize() { W = canvas.width = innerWidth; H = canvas.height = innerHeight; initLayers(); }
        
        const ERAS = [
            { name: 'Present Day', years: 0, memory: 'The last breath of autumn, captured in crystalline silence', hue: 200, sat: 40 },
            { name: 'Industrial Age', years: 150, memory: 'Soot particles from distant factories drift through frozen air', hue: 180, sat: 35 },
            { name: 'Medieval Period', years: 800, memory: 'Smoke from a thousand hearths rises into winter clouds', hue: 190, sat: 45 },
            { name: 'Roman Empire', years: 2000, memory: 'Volcanic ash from Vesuvius settles in alpine snows', hue: 200, sat: 50 },
            { name: 'Bronze Age', years: 4000, memory: 'First metal forges leave traces in the pristine ice', hue: 210, sat: 55 },
            { name: 'Neolithic', years: 8000, memory: 'Pollen from ancient forests paints the compressed layers', hue: 195, sat: 60 },
            { name: 'Ice Age End', years: 12000, memory: 'The great thaw begins, mammoths walk the tundra', hue: 220, sat: 65 },
            { name: 'Last Glacial', years: 50000, memory: 'Endless winter stretches across continents', hue: 230, sat: 70 },
            { name: 'Primordial Ice', years: 100000, memory: 'Atmosphere from a world before memory', hue: 240, sat: 75 }
        ];
        
        let drillIntensity = 0.5;
        let coreWidth = 60;
        let time = 0;
        
        let layers = [];
        let drillDepth = 0;
        let maxDrillDepth = 0;
        const particles = [];
        const bubbles = [];
        
        let isDrilling = false;
        
        function initLayers() {
            layers = [];
            const layerHeight = H / ERAS.length;
            
            ERAS.forEach((era, i) => {
                layers.push({
                    y: i * layerHeight,
                    height: layerHeight,
                    era: era,
                    revealed: false,
                    revealProgress: 0,
                    bubbleCount: Math.floor(Math.random() * 10) + 5
                });
                
                for (let j = 0; j < layers[i].bubbleCount; j++) {
                    bubbles.push({
                        x: W/2 + (Math.random() - 0.5) * coreWidth,
                        y: layers[i].y + Math.random() * layerHeight,
                        size: 1 + Math.random() * 3,
                        layer: i
                    });
                }
            });
        }
        
        resize(); window.onresize = resize;
        
        function getCurrentEra() {
            const layerIndex = Math.floor(drillDepth / (H / ERAS.length));
            return ERAS[Math.min(layerIndex, ERAS.length - 1)];
        }
        
        function drawBackground() {
            const gradient = ctx.createLinearGradient(0, 0, 0, H);
            gradient.addColorStop(0, '#0a0f18');
            gradient.addColorStop(1, '#050810');
            ctx.fillStyle = gradient;
            ctx.fillRect(0, 0, W, H);
        }
        
        function drawIceLayers() {
            const coreX = W / 2;
            
            layers.forEach((layer, i) => {
                const era = layer.era;
                
                const gradient = ctx.createLinearGradient(coreX - coreWidth, 0, coreX + coreWidth, 0);
                gradient.addColorStop(0, "hsla(" + era.hue + ", " + era.sat + "%, 30%, 0.3)");
                gradient.addColorStop(0.3, "hsla(" + era.hue + ", " + era.sat + "%, 50%, 0.6)");
                gradient.addColorStop(0.5, "hsla(" + era.hue + ", " + era.sat + "%, 60%, 0.8)");
                gradient.addColorStop(0.7, "hsla(" + era.hue + ", " + era.sat + "%, 50%, 0.6)");
                gradient.addColorStop(1, "hsla(" + era.hue + ", " + era.sat + "%, 30%, 0.3)");
                
                ctx.fillStyle = gradient;
                ctx.fillRect(coreX - coreWidth, layer.y, coreWidth * 2, layer.height);
                
                ctx.strokeStyle = "hsla(" + era.hue + ", 30%, 70%, 0.3)";
                ctx.lineWidth = 1;
                ctx.beginPath();
                ctx.moveTo(coreX - coreWidth, layer.y);
                ctx.lineTo(coreX + coreWidth, layer.y);
                ctx.stroke();
                
                if (layer.revealed && layer.revealProgress < 1) {
                    layer.revealProgress += 0.02;
                }
                
                if (layer.revealed) {
                    const glow = layer.revealProgress;
                    const glowGradient = ctx.createRadialGradient(
                        coreX, layer.y + layer.height/2, 0,
                        coreX, layer.y + layer.height/2, coreWidth * 2
                    );
                    glowGradient.addColorStop(0, "hsla(" + (era.hue + 30) + ", 70%, 70%, " + (glow * 0.3) + ")");
                    glowGradient.addColorStop(1, "transparent");
                    ctx.fillStyle = glowGradient;
                    ctx.fillRect(coreX - coreWidth * 2, layer.y, coreWidth * 4, layer.height);
                }
            });
        }
        
        function drawBubbles() {
            bubbles.forEach(bubble => {
                const layer = layers[bubble.layer];
                if (!layer) return;
                
                const isRevealed = drillDepth > bubble.y;
                const alpha = isRevealed ? 0.8 : 0.3;
                
                ctx.beginPath();
                ctx.arc(bubble.x, bubble.y, bubble.size, 0, Math.PI * 2);
                ctx.fillStyle = "rgba(200, 230, 255, " + alpha + ")";
                ctx.fill();
                
                if (isRevealed) {
                    ctx.beginPath();
                    ctx.arc(bubble.x - bubble.size * 0.3, bubble.y - bubble.size * 0.3, bubble.size * 0.3, 0, Math.PI * 2);
                    ctx.fillStyle = "rgba(255, 255, 255, 0.6)";
                    ctx.fill();
                }
            });
        }
        
        function drawDrillLine() {
            const coreX = W / 2;
            
            ctx.strokeStyle = 'rgba(255, 100, 50, 0.8)';
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.moveTo(coreX - coreWidth * 0.8, drillDepth);
            ctx.lineTo(coreX + coreWidth * 0.8, drillDepth);
            ctx.stroke();
            
            const gradient = ctx.createRadialGradient(coreX, drillDepth, 0, coreX, drillDepth, coreWidth);
            gradient.addColorStop(0, 'rgba(255, 150, 50, 0.3)');
            gradient.addColorStop(1, 'transparent');
            ctx.fillStyle = gradient;
            ctx.fillRect(coreX - coreWidth, drillDepth - 20, coreWidth * 2, 40);
        }
        
        function drawParticles() {
            for (let i = particles.length - 1; i >= 0; i--) {
                const p = particles[i];
                p.x += p.vx;
                p.y += p.vy;
                p.vy += 0.05;
                p.life -= 0.02;
                
                if (p.life <= 0) {
                    particles.splice(i, 1);
                    continue;
                }
                
                ctx.beginPath();
                ctx.arc(p.x, p.y, p.size * p.life, 0, Math.PI * 2);
                ctx.fillStyle = "hsla(" + p.hue + ", 60%, 70%, " + p.life + ")";
                ctx.fill();
            }
        }
        
        function showMemory(era) {
            const panel = document.getElementById('memory-panel');
            panel.innerHTML = '<div style="font-size: 10px; opacity: 0.6;">' + era.name + ' (' + era.years + ' years ago)</div>' + era.memory;
            panel.style.opacity = 1;
            
            setTimeout(() => {
                panel.style.opacity = 0;
            }, 4000);
        }
        
        function updateDisplay() {
            const depthMeters = Math.floor(drillDepth / 3);
            document.getElementById('current-depth').textContent = depthMeters;
            
            const era = getCurrentEra();
            document.getElementById('current-era').textContent = era.name;
        }
        
        function drill(y) {
            if (y > drillDepth) {
                drillDepth += drillIntensity * 2;
                drillDepth = Math.min(drillDepth, y, H - 10);
                
                if (drillDepth > maxDrillDepth) {
                    maxDrillDepth = drillDepth;
                    
                    layers.forEach(layer => {
                        if (!layer.revealed && drillDepth > layer.y + layer.height * 0.3) {
                            layer.revealed = true;
                            showMemory(layer.era);
                            
                            for (let i = 0; i < 20; i++) {
                                particles.push({
                                    x: W/2 + (Math.random() - 0.5) * coreWidth,
                                    y: layer.y + layer.height * 0.5,
                                    vx: (Math.random() - 0.5) * 3,
                                    vy: (Math.random() - 0.5) * 3,
                                    size: 2 + Math.random() * 3,
                                    hue: layer.era.hue,
                                    life: 1
                                });
                            }
                        }
                    });
                }
                
                for (let i = 0; i < 3; i++) {
                    particles.push({
                        x: W/2 + (Math.random() - 0.5) * coreWidth * 0.5,
                        y: drillDepth,
                        vx: (Math.random() - 0.5) * 2,
                        vy: Math.random() * -2,
                        size: 1 + Math.random() * 2,
                        hue: 200,
                        life: 1
                    });
                }
            }
        }
        
        function animate() {
            time += 0.016;
            
            drawBackground();
            drawIceLayers();
            drawBubbles();
            drawDrillLine();
            drawParticles();
            updateDisplay();
            
            requestAnimationFrame(animate);
        }
        
        canvas.onmousedown = e => {
            if (e.clientX < 200 && e.clientY < 250) return;
            isDrilling = true;
        };
        
        canvas.onmousemove = e => {
            if (isDrilling) {
                drill(e.clientY);
            }
        };
        
        canvas.onmouseup = () => { isDrilling = false; };
        canvas.onmouseleave = () => { isDrilling = false; };
        
        document.getElementById('drill').oninput = e => {
            drillIntensity = e.target.value / 100;
            document.getElementById('drill-val').textContent = e.target.value;
        };
        
        document.getElementById('width').oninput = e => {
            coreWidth = parseInt(e.target.value);
            document.getElementById('width-val').textContent = e.target.value;
        };
        
        document.getElementById('freeze-btn').onclick = () => {
            if (drillDepth > 50) {
                for (let i = 0; i < 30; i++) {
                    particles.push({
                        x: W/2 + (Math.random() - 0.5) * coreWidth * 2,
                        y: Math.random() * drillDepth,
                        vx: 0,
                        vy: -Math.random() * 0.5,
                        size: 2 + Math.random() * 2,
                        hue: 200 + Math.random() * 40,
                        life: 1
                    });
                }
            }
        };
        
        document.getElementById('reset-btn').onclick = () => {
            drillDepth = 0;
            maxDrillDepth = 0;
            particles.length = 0;
            initLayers();
        };
        
        animate();
    </script>
</body>
</html>