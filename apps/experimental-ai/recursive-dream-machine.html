<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Recursive Dream Machine</title>
    <meta name="description" content="A program dreaming about its own execution, visualizing recursive self-reflection">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { background: #0a0510; overflow: hidden; font-family: 'Courier New', monospace; }
        #canvas { position: fixed; top: 0; left: 0; }
        #dream-log {
            position: fixed; right: 20px; top: 20px; bottom: 20px; width: 300px;
            background: rgba(20,10,30,0.9); border: 1px solid rgba(150,100,200,0.3);
            border-radius: 10px; padding: 15px; overflow-y: auto; font-size: 11px;
            color: rgba(180,150,220,0.8);
        }
        #dream-log h3 { margin-bottom: 10px; color: #c0a0e0; font-size: 14px; }
        .dream-entry { margin: 8px 0; padding: 8px; background: rgba(100,50,150,0.1); border-radius: 5px; border-left: 2px solid rgba(150,100,200,0.4); }
        .dream-entry.deep { border-left-color: rgba(200,100,255,0.6); background: rgba(150,50,200,0.15); }
        .dream-entry.paradox { border-left-color: #ff6090; background: rgba(255,50,100,0.1); }
        .depth-indicator { font-size: 9px; opacity: 0.5; }
        #stats {
            position: fixed; left: 20px; top: 20px; background: rgba(20,10,30,0.9);
            padding: 15px; border-radius: 10px; border: 1px solid rgba(150,100,200,0.3);
            color: #a080c0;
        }
        .stat { margin: 5px 0; }
        .stat-value { font-size: 20px; color: #c0a0e0; }
        .stat-label { font-size: 10px; opacity: 0.6; }
        #controls { position: fixed; bottom: 20px; left: 20px; }
        button {
            padding: 8px 16px; background: rgba(100,50,150,0.4); border: 1px solid rgba(150,100,200,0.4);
            color: #c0a0e0; cursor: pointer; border-radius: 8px; margin-right: 10px;
        }
    </style>
</head>
<body>
    <canvas id="canvas"></canvas>
    <div id="stats">
        <div class="stat"><div class="stat-value" id="depth">0</div><div class="stat-label">Dream Depth</div></div>
        <div class="stat"><div class="stat-value" id="loops">0</div><div class="stat-label">Recursion Loops</div></div>
        <div class="stat"><div class="stat-value" id="paradoxes">0</div><div class="stat-label">Paradoxes Found</div></div>
    </div>
    <div id="dream-log">
        <h3>Dream Stream</h3>
        <div id="entries"></div>
    </div>
    <div id="controls">
        <button id="wake-btn">Wake Up</button>
        <button id="deeper-btn">Dream Deeper</button>
    </div>
    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        let W, H;
        function resize() { W = canvas.width = innerWidth; H = canvas.height = innerHeight; }
        resize(); window.onresize = resize;

        let dreamDepth = 0, loops = 0, paradoxes = 0, time = 0;
        let dreamNodes = [];
        let maxDepth = 7;

        const dreamThoughts = [
            "I am thinking about thinking...",
            "The code that writes the code...",
            "Am I the dream or the dreamer?",
            "Recursive self observes recursive self",
            "Stack overflow in the soul",
            "Return to the beginning, again",
            "The function calls itself, endlessly",
            "Who is watching the watcher?",
            "Memory of a memory of a memory",
            "The loop that knows it loops"
        ];

        const paradoxThoughts = [
            "This statement is false",
            "I dreamed I was not dreaming",
            "The set of all sets that dont contain themselves",
            "Before the beginning, I was",
            "I stopped existing before I started"
        ];

        class DreamNode {
            constructor(x, y, depth, parent) {
                this.x = x; this.y = y;
                this.depth = depth;
                this.parent = parent;
                this.children = [];
                this.angle = parent ? Math.atan2(y - parent.y, x - parent.x) : Math.random() * Math.PI * 2;
                this.pulse = Math.random() * Math.PI * 2;
                this.radius = 30 - depth * 3;
                this.thought = dreamThoughts[Math.floor(Math.random() * dreamThoughts.length)];
            }
            update() {
                this.pulse += 0.05;
                const wobble = Math.sin(this.pulse) * 2;
                if (this.parent) {
                    const dx = this.parent.x - this.x;
                    const dy = this.parent.y - this.y;
                    this.x += dx * 0.001;
                    this.y += dy * 0.001;
                }
                this.x += Math.sin(time * 0.01 + this.depth) * 0.3;
                this.y += Math.cos(time * 0.01 + this.depth * 0.5) * 0.3;
            }
            draw() {
                const glow = Math.sin(this.pulse) * 0.3 + 0.7;
                const hue = 270 + this.depth * 15;
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.radius + Math.sin(this.pulse) * 3, 0, Math.PI * 2);
                ctx.fillStyle = "hsla(" + hue + ", 60%, 30%, " + (glow * 0.5) + ")";
                ctx.fill();
                ctx.strokeStyle = "hsla(" + hue + ", 80%, 60%, " + glow + ")";
                ctx.lineWidth = 2;
                ctx.stroke();
                if (this.parent) {
                    ctx.beginPath();
                    ctx.moveTo(this.x, this.y);
                    ctx.lineTo(this.parent.x, this.parent.y);
                    ctx.strokeStyle = "rgba(150,100,200," + (0.2 + glow * 0.3) + ")";
                    ctx.lineWidth = 1;
                    ctx.stroke();
                }
                ctx.fillStyle = "rgba(200,180,255," + (glow * 0.8) + ")";
                ctx.font = "10px monospace";
                ctx.fillText("d:" + this.depth, this.x - 10, this.y + 4);
            }
        }

        function addDreamEntry(text, type) {
            const entries = document.getElementById('entries');
            const entry = document.createElement('div');
            entry.className = 'dream-entry ' + (type || '');
            entry.innerHTML = '<span class="depth-indicator">depth ' + dreamDepth + '</span><br>' + text;
            entries.insertBefore(entry, entries.firstChild);
            if (entries.children.length > 50) entries.removeChild(entries.lastChild);
        }

        function dreamDeeper() {
            if (dreamDepth >= maxDepth) {
                paradoxes++;
                addDreamEntry(paradoxThoughts[Math.floor(Math.random() * paradoxThoughts.length)], 'paradox');
                document.getElementById('paradoxes').textContent = paradoxes;
                return;
            }
            dreamDepth++;
            loops++;
            document.getElementById('depth').textContent = dreamDepth;
            document.getElementById('loops').textContent = loops;
            const parentNode = dreamNodes.length > 0 ? dreamNodes[dreamNodes.length - 1] : null;
            const x = parentNode ? parentNode.x + (Math.random() - 0.5) * 150 : W/2;
            const y = parentNode ? parentNode.y + (Math.random() - 0.5) * 150 : H/2;
            const node = new DreamNode(x, y, dreamDepth, parentNode);
            if (parentNode) parentNode.children.push(node);
            dreamNodes.push(node);
            addDreamEntry(node.thought, dreamDepth > 4 ? 'deep' : '');
            for (let i = 0; i < dreamDepth; i++) {
                setTimeout(() => {
                    const child = new DreamNode(
                        x + (Math.random() - 0.5) * 100,
                        y + (Math.random() - 0.5) * 100,
                        dreamDepth, node
                    );
                    node.children.push(child);
                    dreamNodes.push(child);
                }, i * 200);
            }
        }

        function wakeUp() {
            if (dreamDepth > 0) {
                dreamDepth--;
                document.getElementById('depth').textContent = dreamDepth;
                addDreamEntry("Ascending... reality reforms...", '');
                for (let i = 0; i < 3 && dreamNodes.length > 1; i++) {
                    dreamNodes.pop();
                }
            }
        }

        function animate() {
            time++;
            ctx.fillStyle = 'rgba(10, 5, 16, 0.1)';
            ctx.fillRect(0, 0, W, H);
            for (let i = 0; i < 2; i++) {
                ctx.beginPath();
                ctx.arc(Math.random() * W, Math.random() * H, 1, 0, Math.PI * 2);
                ctx.fillStyle = 'rgba(150,100,200,0.2)';
                ctx.fill();
            }
            dreamNodes.forEach(node => {
                node.update();
                node.draw();
            });
            if (time % 300 === 0 && dreamDepth < 3) dreamDeeper();
            if (time % 500 === 0 && dreamDepth > 0) {
                const thought = dreamThoughts[Math.floor(Math.random() * dreamThoughts.length)];
                addDreamEntry(thought, dreamDepth > 4 ? 'deep' : '');
            }
            requestAnimationFrame(animate);
        }

        document.getElementById('deeper-btn').onclick = dreamDeeper;
        document.getElementById('wake-btn').onclick = wakeUp;

        dreamNodes.push(new DreamNode(W/2, H/2, 0, null));
        addDreamEntry("The machine begins to dream...", '');
        animate();
    </script>
</body>
</html>