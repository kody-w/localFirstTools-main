<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Typographic Terrarium</title>
    <meta name="description" content="A digital ecosystem where letters are living organisms that hunt, breed, and evolve">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { background: #0a1a10; overflow: hidden; font-family: monospace; color: #80c080; }
        #canvas { position: fixed; top: 0; left: 0; }
        #controls {
            position: fixed; top: 20px; left: 20px; background: rgba(10,30,20,0.9);
            padding: 20px; border-radius: 10px; border: 1px solid rgba(80,160,80,0.3); z-index: 100;
        }
        h3 { margin-bottom: 15px; color: #a0e0a0; }
        button {
            display: block; width: 100%; padding: 10px; margin: 8px 0;
            background: rgba(50,100,50,0.4); border: 1px solid rgba(80,160,80,0.4);
            color: #80c080; cursor: pointer; border-radius: 8px;
        }
        #stats {
            position: fixed; top: 20px; right: 20px; background: rgba(10,30,20,0.9);
            padding: 20px; border-radius: 10px; border: 1px solid rgba(80,160,80,0.3);
        }
        .stat { margin: 8px 0; }
        .stat-label { font-size: 10px; opacity: 0.6; }
        .stat-value { font-size: 18px; color: #a0e0a0; }
        #legend {
            position: fixed; bottom: 20px; left: 20px; background: rgba(10,30,20,0.9);
            padding: 15px; border-radius: 10px; border: 1px solid rgba(80,160,80,0.3);
            font-size: 11px;
        }
        .legend-item { margin: 5px 0; display: flex; align-items: center; gap: 10px; }
        .legend-color { width: 20px; height: 20px; border-radius: 3px; }
    </style>
</head>
<body>
    <canvas id="canvas"></canvas>
    <div id="controls">
        <h3>Terrarium Controls</h3>
        <button id="feed-btn">Feed (Add Punctuation)</button>
        <button id="breed-btn">Force Breeding</button>
        <button id="predator-btn">Add Predator (X)</button>
        <button id="light-btn">Toggle Sunlight</button>
    </div>
    <div id="stats">
        <div class="stat"><div class="stat-label">Vowels (Producers)</div><div class="stat-value" id="vowel-count">0</div></div>
        <div class="stat"><div class="stat-label">Consonants (Hunters)</div><div class="stat-value" id="consonant-count">0</div></div>
        <div class="stat"><div class="stat-label">Punctuation (Food)</div><div class="stat-value" id="punct-count">0</div></div>
        <div class="stat"><div class="stat-label">Generations</div><div class="stat-value" id="gen-count">0</div></div>
    </div>
    <div id="legend">
        <div class="legend-item"><div class="legend-color" style="background:#ffff80"></div>Vowels - Photosynthesize</div>
        <div class="legend-item"><div class="legend-color" style="background:#80ff80"></div>Consonants - Hunt punctuation</div>
        <div class="legend-item"><div class="legend-color" style="background:#ff8080"></div>Predators - Hunt letters</div>
        <div class="legend-item"><div class="legend-color" style="background:#8080ff"></div>Punctuation - Food source</div>
    </div>
    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        let W, H;
        function resize() { W = canvas.width = innerWidth; H = canvas.height = innerHeight; }
        resize(); window.onresize = resize;

        const vowels = 'AEIOU';
        const consonants = 'BCDFGHJKLMNPQRSTVWXYZ';
        const punctuation = '.,;:!?';
        let organisms = [];
        let sunlight = true;
        let generation = 0;

        class LetterOrganism {
            constructor(x, y, char, parent1, parent2) {
                this.x = x; this.y = y;
                this.char = char;
                this.type = this.getType(char);
                this.energy = 50 + Math.random() * 50;
                this.age = 0;
                this.size = 20 + Math.random() * 10;
                this.vx = (Math.random() - 0.5) * 2;
                this.vy = (Math.random() - 0.5) * 2;
                this.generation = parent1 ? Math.max(parent1.generation, parent2 ? parent2.generation : 0) + 1 : 0;
                this.hue = this.getHue();
            }
            getType(char) {
                if (vowels.includes(char)) return 'vowel';
                if (consonants.includes(char)) return 'consonant';
                if (char === 'X') return 'predator';
                return 'food';
            }
            getHue() {
                if (this.type === 'vowel') return 60;
                if (this.type === 'consonant') return 120;
                if (this.type === 'predator') return 0;
                return 240;
            }
            update() {
                this.age++;
                if (this.type === 'vowel' && sunlight) {
                    this.energy += 0.5;
                    this.size = Math.min(40, this.size + 0.01);
                }
                if (this.type === 'consonant' || this.type === 'predator') {
                    this.energy -= 0.2;
                    this.hunt();
                }
                if (this.type === 'food') this.energy -= 0.05;
                this.x += this.vx;
                this.y += this.vy;
                if (this.x < 0 || this.x > W) this.vx *= -1;
                if (this.y < 0 || this.y > H) this.vy *= -1;
                this.x = Math.max(0, Math.min(W, this.x));
                this.y = Math.max(0, Math.min(H, this.y));
                if (this.energy > 100 && Math.random() < 0.01) this.tryBreed();
                return this.energy > 0;
            }
            hunt() {
                const targetType = this.type === 'predator' ? ['vowel', 'consonant'] : ['food'];
                organisms.forEach(o => {
                    if (o !== this && targetType.includes(o.type)) {
                        const dx = o.x - this.x;
                        const dy = o.y - this.y;
                        const dist = Math.hypot(dx, dy);
                        if (dist < 100) {
                            this.vx += (dx / dist) * 0.1;
                            this.vy += (dy / dist) * 0.1;
                        }
                        if (dist < this.size) {
                            this.energy += o.energy * 0.5;
                            o.energy = 0;
                        }
                    }
                });
            }
            tryBreed() {
                const partner = organisms.find(o => 
                    o !== this && o.type === this.type && 
                    Math.hypot(o.x - this.x, o.y - this.y) < 50 &&
                    o.energy > 60
                );
                if (partner) {
                    this.energy -= 30;
                    partner.energy -= 30;
                    const childChar = Math.random() < 0.5 ? this.char : partner.char;
                    if (Math.random() < 0.1) {
                        const pool = this.type === 'vowel' ? vowels : consonants;
                        organisms.push(new LetterOrganism(
                            (this.x + partner.x) / 2,
                            (this.y + partner.y) / 2,
                            pool[Math.floor(Math.random() * pool.length)],
                            this, partner
                        ));
                    } else {
                        organisms.push(new LetterOrganism(
                            (this.x + partner.x) / 2,
                            (this.y + partner.y) / 2,
                            childChar, this, partner
                        ));
                    }
                    generation = Math.max(generation, organisms[organisms.length-1].generation);
                }
            }
            draw() {
                const glow = this.energy / 100;
                ctx.save();
                ctx.translate(this.x, this.y);
                if (this.type === 'vowel' && sunlight) {
                    ctx.beginPath();
                    ctx.arc(0, 0, this.size + 10, 0, Math.PI * 2);
                    ctx.fillStyle = 'rgba(255, 255, 100, 0.1)';
                    ctx.fill();
                }
                ctx.font = 'bold ' + this.size + 'px monospace';
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                ctx.fillStyle = 'hsla(' + this.hue + ', 80%, ' + (40 + glow * 30) + '%, ' + (0.5 + glow * 0.5) + ')';
                ctx.fillText(this.char, 0, 0);
                ctx.restore();
            }
        }

        function init() {
            organisms = [];
            for (let i = 0; i < 10; i++) {
                organisms.push(new LetterOrganism(
                    Math.random() * W, Math.random() * H,
                    vowels[Math.floor(Math.random() * vowels.length)]
                ));
            }
            for (let i = 0; i < 15; i++) {
                organisms.push(new LetterOrganism(
                    Math.random() * W, Math.random() * H,
                    consonants[Math.floor(Math.random() * consonants.length)]
                ));
            }
            for (let i = 0; i < 20; i++) {
                organisms.push(new LetterOrganism(
                    Math.random() * W, Math.random() * H,
                    punctuation[Math.floor(Math.random() * punctuation.length)]
                ));
            }
        }

        function animate() {
            ctx.fillStyle = sunlight ? 'rgba(10, 26, 16, 0.1)' : 'rgba(5, 10, 8, 0.1)';
            ctx.fillRect(0, 0, W, H);
            organisms = organisms.filter(o => o.update());
            organisms.forEach(o => o.draw());
            document.getElementById('vowel-count').textContent = organisms.filter(o => o.type === 'vowel').length;
            document.getElementById('consonant-count').textContent = organisms.filter(o => o.type === 'consonant').length;
            document.getElementById('punct-count').textContent = organisms.filter(o => o.type === 'food').length;
            document.getElementById('gen-count').textContent = generation;
            requestAnimationFrame(animate);
        }

        document.getElementById('feed-btn').onclick = () => {
            for (let i = 0; i < 10; i++) {
                organisms.push(new LetterOrganism(
                    Math.random() * W, Math.random() * H,
                    punctuation[Math.floor(Math.random() * punctuation.length)]
                ));
            }
        };
        document.getElementById('breed-btn').onclick = () => {
            organisms.filter(o => o.type !== 'food').forEach(o => o.energy = 110);
        };
        document.getElementById('predator-btn').onclick = () => {
            organisms.push(new LetterOrganism(Math.random() * W, Math.random() * H, 'X'));
        };
        document.getElementById('light-btn').onclick = () => {
            sunlight = !sunlight;
        };

        init();
        animate();
    </script>
</body>
</html>