<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Agent Library Azure Deployment - Microsoft AI Solutions</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f5f5f5;
            color: #333;
            line-height: 1.6;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Header Styles */
        .header {
            background: linear-gradient(135deg, #0078d4 0%, #005a9e 100%);
            color: white;
            padding: 2.5rem 0;
            text-align: center;
            margin-bottom: 2rem;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
            font-weight: 300;
        }

        .header p {
            font-size: 1.2rem;
            opacity: 0.9;
        }

        /* Workflow Stepper */
        .workflow-stepper {
            background: white;
            padding: 2rem;
            border-radius: 10px;
            box-shadow: 0 2px 15px rgba(0, 0, 0, 0.08);
            margin-bottom: 2rem;
        }

        .workflow-steps {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .workflow-step {
            flex: 1;
            text-align: center;
            position: relative;
            padding: 1rem;
        }

        .workflow-step::after {
            content: '';
            position: absolute;
            top: 50%;
            right: -50%;
            width: 100%;
            height: 2px;
            background: #e0e0e0;
            transform: translateY(-50%);
        }

        .workflow-step:last-child::after {
            display: none;
        }

        .workflow-step.active .step-number {
            background: #0078d4;
            color: white;
        }

        .workflow-step.completed .step-number {
            background: #00d4aa;
            color: white;
        }

        .step-number {
            display: inline-block;
            width: 40px;
            height: 40px;
            background: #e0e0e0;
            color: #666;
            border-radius: 50%;
            line-height: 40px;
            font-weight: bold;
            margin-bottom: 0.5rem;
        }

        /* Main Content Area */
        .content-area {
            display: grid;
            grid-template-columns: 3fr 1fr;
            gap: 2rem;
        }

        /* Agent Library Section */
        .agent-library {
            background: white;
            padding: 2rem;
            border-radius: 10px;
            box-shadow: 0 2px 15px rgba(0, 0, 0, 0.08);
        }

        .search-section {
            margin-bottom: 2rem;
        }

        .search-box {
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .search-input {
            flex: 1;
            padding: 12px 20px;
            border: 2px solid #e0e0e0;
            border-radius: 6px;
            font-size: 1rem;
        }

        .search-input:focus {
            outline: none;
            border-color: #0078d4;
            box-shadow: 0 0 0 3px rgba(0, 120, 212, 0.1);
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 6px;
            font-size: 1rem;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
        }

        .btn-primary {
            background: #0078d4;
            color: white;
        }

        .btn-primary:hover {
            background: #005a9e;
            transform: translateY(-1px);
        }

        .btn-secondary {
            background: #e0e0e0;
            color: #333;
        }

        .btn-azure {
            background: #0078d4;
            color: white;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn-azure:hover {
            background: #106ebe;
        }

        .btn-success {
            background: #00d4aa;
            color: white;
        }

        .btn-success:hover {
            background: #00b090;
        }

        /* Filters */
        .filters {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            margin-bottom: 2rem;
        }

        .filter-group {
            flex: 1;
            min-width: 200px;
        }

        .filter-label {
            display: block;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: #555;
        }

        .filter-select {
            width: 100%;
            padding: 8px;
            border: 2px solid #e0e0e0;
            border-radius: 4px;
            background: white;
        }

        /* Agent Grid */
        .agent-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 1.5rem;
        }

        .agent-card {
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            padding: 1.5rem;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
        }

        .agent-card:hover {
            border-color: #0078d4;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            transform: translateY(-2px);
        }

        .agent-card.selected {
            border-color: #00d4aa;
            background: #f0fcf9;
        }

        .agent-card.selected::after {
            content: '‚úì';
            position: absolute;
            top: 1rem;
            right: 1rem;
            width: 30px;
            height: 30px;
            background: #00d4aa;
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }

        .agent-header {
            margin-bottom: 1rem;
        }

        .agent-name {
            font-size: 1.2rem;
            font-weight: 500;
            color: #0078d4;
            margin-bottom: 0.25rem;
        }

        .agent-type {
            font-size: 0.9rem;
            color: #666;
        }

        .agent-description {
            color: #555;
            margin-bottom: 1rem;
            font-size: 0.95rem;
        }

        .agent-tags {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }

        .tag {
            padding: 0.25rem 0.5rem;
            background: #f0f0f0;
            border-radius: 4px;
            font-size: 0.75rem;
            color: #555;
        }

        .tag.capability {
            background: #e3f2fd;
            color: #1565c0;
        }

        /* Selection Sidebar */
        .selection-sidebar {
            position: sticky;
            top: 20px;
            height: fit-content;
        }

        .selection-panel {
            background: white;
            padding: 1.5rem;
            border-radius: 10px;
            box-shadow: 0 2px 15px rgba(0, 0, 0, 0.08);
            margin-bottom: 1rem;
        }

        .selection-header {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 1rem;
            color: #0078d4;
        }

        .selected-agents-list {
            max-height: 400px;
            overflow-y: auto;
        }

        .selected-agent-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.75rem;
            background: #f8f9fa;
            border-radius: 6px;
            margin-bottom: 0.5rem;
        }

        .selected-agent-name {
            font-weight: 500;
            color: #333;
        }

        .remove-btn {
            background: none;
            border: none;
            color: #dc3545;
            cursor: pointer;
            font-size: 1.2rem;
        }

        /* Deployment Configuration */
        .deployment-config {
            background: white;
            padding: 2rem;
            border-radius: 10px;
            box-shadow: 0 2px 15px rgba(0, 0, 0, 0.08);
            display: none;
        }

        .config-section {
            margin-bottom: 2rem;
        }

        .config-section h3 {
            color: #0078d4;
            margin-bottom: 1rem;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: #555;
        }

        .form-group input,
        .form-group select {
            width: 100%;
            padding: 10px;
            border: 2px solid #e0e0e0;
            border-radius: 4px;
            font-size: 1rem;
        }

        .help-text {
            font-size: 0.85rem;
            color: #666;
            margin-top: 0.25rem;
        }

        /* Code Preview */
        .code-preview {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 1.5rem;
            border-radius: 8px;
            overflow-x: auto;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 0.9rem;
            max-height: 500px;
            overflow-y: auto;
        }

        /* Deployment Steps */
        .deployment-step {
            background: #f8f9fa;
            padding: 1.5rem;
            border-radius: 8px;
            margin-bottom: 1rem;
            border: 2px solid #e0e0e0;
            transition: all 0.3s;
        }

        .deployment-step.active {
            border-color: #0078d4;
            background: #f0f8ff;
        }

        .deployment-step.completed {
            border-color: #00d4aa;
            background: #f0fcf9;
        }

        .step-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .step-header h4 {
            color: #0078d4;
            margin: 0;
        }

        .step-status {
            padding: 0.25rem 0.75rem;
            border-radius: 12px;
            font-size: 0.85rem;
            font-weight: 600;
            background: #e0e0e0;
            color: #666;
        }

        .step-status.in-progress {
            background: #fff3cd;
            color: #856404;
        }

        .step-status.completed {
            background: #d4edda;
            color: #155724;
        }

        .step-status.error {
            background: #f8d7da;
            color: #721c24;
        }

        .deployment-log {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 1rem;
            border-radius: 8px;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 0.85rem;
            max-height: 300px;
            overflow-y: auto;
        }

        .log-entry {
            margin-bottom: 0.5rem;
            display: flex;
            align-items: start;
            gap: 0.5rem;
        }

        .log-timestamp {
            color: #858585;
            font-size: 0.8rem;
        }

        .log-message {
            flex: 1;
        }

        .log-success {
            color: #4ec9b0;
        }

        .log-error {
            color: #f44747;
        }

        .log-info {
            color: #3794ff;
        }

        /* Modal */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }

        .modal-content {
            background: white;
            padding: 2rem;
            border-radius: 10px;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
            width: 90%;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #666;
        }

        /* Loading State */
        .loading {
            text-align: center;
            padding: 2rem;
            color: #666;
        }

        .spinner {
            display: inline-block;
            width: 40px;
            height: 40px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #0078d4;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Stats Cards */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .stat-card {
            background: #f0f8ff;
            padding: 1rem;
            border-radius: 8px;
            text-align: center;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: #0078d4;
        }

        .stat-label {
            font-size: 0.85rem;
            color: #666;
        }

        .notice-box {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 2rem;
        }

        .notice-box h4 {
            color: #856404;
            margin-bottom: 0.5rem;
        }

        .skip-section {
            background: #e8f5e9;
            padding: 1rem;
            border-radius: 6px;
            margin-top: 1rem;
        }

        .skip-section h5 {
            color: #2e7d32;
            margin-bottom: 0.5rem;
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>Agent Library Azure Deployment</h1>
            <p>Select and deploy multiple AI agents to Azure in minutes</p>
        </header>

        <!-- Configuration Notice -->
        <div class="notice-box" id="configNotice" style="display: none;">
            <h4>‚ö†Ô∏è GitHub Repository Not Configured</h4>
            <p>To use your own agents, update the GitHub configuration in the code:</p>
            <code>GITHUB_OWNER = 'YOUR-GITHUB-USERNAME'</code><br>
            <code>GITHUB_REPO = 'YOUR-REPO-NAME'</code>
            <p style="margin-top: 0.5rem;">Currently using mock data for demonstration.</p>
        </div>

        <!-- Workflow Stepper -->
        <div class="workflow-stepper">
            <div class="workflow-steps">
                <div class="workflow-step active" id="step-1">
                    <div class="step-number">1</div>
                    <div>Select Agents</div>
                </div>
                <div class="workflow-step" id="step-2">
                    <div class="step-number">2</div>
                    <div>Configure Deployment</div>
                </div>
                <div class="workflow-step" id="step-3">
                    <div class="step-number">3</div>
                    <div>Deploy to Azure</div>
                </div>
            </div>
        </div>

        <!-- Step 1: Agent Selection -->
        <div id="step1-content" class="content-area">
            <div class="agent-library">
                <h2 style="margin-bottom: 1.5rem;">Available AI Agents</h2>
                
                <!-- Search Section -->
                <div class="search-section">
                    <div class="search-box">
                        <input type="text" class="search-input" id="searchInput" 
                               placeholder="Search agents by name, description, or capability...">
                        <button class="btn btn-primary" onclick="agentDeployment.searchAgents()">
                            üîç Search
                        </button>
                    </div>
                </div>

                <!-- Filters -->
                <div class="filters">
                    <div class="filter-group">
                        <label class="filter-label">Agent Type</label>
                        <select class="filter-select" id="typeFilter" onchange="agentDeployment.filterAgents()">
                            <option value="">All Types</option>
                            <option value="conversational">Conversational</option>
                            <option value="analytical">Analytical</option>
                            <option value="automation">Automation</option>
                            <option value="extraction">Data Extraction</option>
                            <option value="monitoring">Monitoring</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label class="filter-label">Department</label>
                        <select class="filter-select" id="departmentFilter" onchange="agentDeployment.filterAgents()">
                            <option value="">All Departments</option>
                            <option value="sales">Sales</option>
                            <option value="hr">Human Resources</option>
                            <option value="finance">Finance</option>
                            <option value="operations">Operations</option>
                            <option value="it">IT</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label class="filter-label">Complexity</label>
                        <select class="filter-select" id="complexityFilter" onchange="agentDeployment.filterAgents()">
                            <option value="">All Levels</option>
                            <option value="low">Low</option>
                            <option value="medium">Medium</option>
                            <option value="high">High</option>
                        </select>
                    </div>
                </div>

                <!-- Agent Grid -->
                <div class="agent-grid" id="agentGrid">
                    <div class="loading">
                        <div class="spinner"></div>
                        <p>Loading agents...</p>
                    </div>
                </div>
            </div>

            <!-- Selection Sidebar -->
            <div class="selection-sidebar">
                <div class="selection-panel">
                    <h3 class="selection-header">Selected Agents (<span id="selectedCount">0</span>)</h3>
                    <div class="selected-agents-list" id="selectedAgentsList">
                        <p style="color: #666; text-align: center;">No agents selected</p>
                    </div>
                    <div style="margin-top: 1.5rem;">
                        <button class="btn btn-primary" style="width: 100%;" 
                                onclick="agentDeployment.proceedToConfiguration()"
                                id="proceedBtn" disabled>
                            Continue to Configuration ‚Üí
                        </button>
                    </div>
                </div>

                <div class="selection-panel">
                    <h4>Quick Actions</h4>
                    <button class="btn btn-secondary" style="width: 100%; margin-bottom: 0.5rem;"
                            onclick="agentDeployment.selectPreset('sales')">
                        Select Sales Bundle
                    </button>
                    <button class="btn btn-secondary" style="width: 100%; margin-bottom: 0.5rem;"
                            onclick="agentDeployment.selectPreset('hr')">
                        Select HR Bundle
                    </button>
                    <button class="btn btn-secondary" style="width: 100%;"
                            onclick="agentDeployment.clearSelection()">
                        Clear All
                    </button>
                </div>
            </div>
        </div>

        <!-- Step 2: Deployment Configuration -->
        <div id="step2-content" class="deployment-config">
            <h2 style="margin-bottom: 2rem;">Configure Your Deployment</h2>

            <!-- Selected Agents Summary -->
            <div class="config-section">
                <h3>Selected Agents Summary</h3>
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-value" id="totalAgentsCount">0</div>
                        <div class="stat-label">Total Agents</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="estimatedCost">$0</div>
                        <div class="stat-label">Est. Monthly Cost</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="deploymentTime">0</div>
                        <div class="stat-label">Deploy Time (min)</div>
                    </div>
                </div>

                <div id="agentConfigList" style="margin-top: 1rem;">
                    <!-- Agent-specific configurations will be added here -->
                </div>
            </div>

            <!-- Deployment Method Selection -->
            <div class="config-section">
                <h3>Choose Deployment Method</h3>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                    <button class="btn btn-primary" onclick="agentDeployment.showStepByStep()">
                        üìã Step-by-Step Deployment
                    </button>
                    <button class="btn btn-secondary" onclick="agentDeployment.showQuickDeploy()">
                        ‚ö° Quick Deploy (Advanced)
                    </button>
                </div>
            </div>

            <!-- Step-by-Step Deployment -->
            <div class="config-section" id="stepByStepSection" style="display: none;">
                <h3>Step-by-Step Deployment</h3>
                <p style="margin-bottom: 1.5rem;">Follow these steps to deploy your agents to Azure:</p>

                <!-- Step 1: Resource Group -->
                <div class="deployment-step" id="deploy-step-1">
                    <div class="step-header">
                        <h4>Step 1: Create Resource Group</h4>
                        <span class="step-status" id="step1-status">Not Started</span>
                    </div>
                    <p>First, we'll create a resource group to contain all your agent resources.</p>
                    
                    <div class="form-group">
                        <label for="deploymentName">Resource Group Name</label>
                        <input type="text" id="deploymentName" placeholder="ai-agents-rg" value="ai-agents-rg">
                    </div>
                    
                    <div class="form-group">
                        <label for="location">Azure Region</label>
                        <select id="location">
                            <option value="eastus">East US</option>
                            <option value="westus2">West US 2</option>
                            <option value="centralus">Central US</option>
                            <option value="westeurope">West Europe</option>
                            <option value="northeurope">North Europe</option>
                            <option value="uksouth">UK South</option>
                            <option value="eastasia">East Asia</option>
                            <option value="australiaeast">Australia East</option>
                        </select>
                    </div>

                    <button class="btn btn-azure" onclick="agentDeployment.createResourceGroup()">
                        <svg style="width: 16px; height: 16px;" viewBox="0 0 18 18">
                            <path fill="white" d="M0 0h18v18H0z" opacity="0"/>
                            <path fill="currentColor" d="M9.75 2.5l4.5 3.2v8.8c0 .28-.22.5-.5.5h-10a.5.5 0 01-.5-.5V5.7l4.5-3.2V5H6.5v2.25H5.25V2.5h4.5zm2.25 9V7.67L13.25 9v2.5H12zm-3.25 0V9h1.5v2.5h-1.5zm-3.5 0V9L6.5 7.67V11.5H5.25z"/>
                        </svg>
                        Create Resource Group
                    </button>

                    <div class="skip-section">
                        <h5>Already have a resource group?</h5>
                        <button class="btn btn-secondary" onclick="agentDeployment.skipResourceGroup()">
                            Skip This Step
                        </button>
                    </div>
                </div>

                <!-- Step 2: OpenAI Service -->
                <div class="deployment-step" id="deploy-step-2" style="opacity: 0.5;">
                    <div class="step-header">
                        <h4>Step 2: Deploy Azure OpenAI</h4>
                        <span class="step-status" id="step2-status">Waiting</span>
                    </div>
                    <p>Next, we'll deploy Azure OpenAI service with GPT-4 model.</p>
                    
                    <div class="form-group">
                        <label>OpenAI Resource Name</label>
                        <input type="text" id="openaiResourceName" placeholder="ai-agents-openai" value="ai-agents-openai" disabled>
                    </div>

                    <div class="form-group" id="openaiEndpointGroup" style="display: none;">
                        <label>Existing OpenAI Endpoint (Optional)</label>
                        <input type="text" id="existingOpenaiEndpoint" placeholder="https://your-resource.openai.azure.com/">
                    </div>

                    <button class="btn btn-azure" id="deployOpenAIBtn" onclick="agentDeployment.deployOpenAI()" disabled>
                        <svg style="width: 16px; height: 16px;" viewBox="0 0 18 18">
                            <path fill="white" d="M0 0h18v18H0z" opacity="0"/>
                            <path fill="currentColor" d="M9.75 2.5l4.5 3.2v8.8c0 .28-.22.5-.5.5h-10a.5.5 0 01-.5-.5V5.7l4.5-3.2V5H6.5v2.25H5.25V2.5h4.5zm2.25 9V7.67L13.25 9v2.5H12zm-3.25 0V9h1.5v2.5h-1.5zm-3.5 0V9L6.5 7.67V11.5H5.25z"/>
                        </svg>
                        Deploy OpenAI Service
                    </button>

                    <div class="skip-section">
                        <h5>Already have Azure OpenAI?</h5>
                        <button class="btn btn-secondary" id="skipOpenAIBtn" onclick="agentDeployment.skipOpenAI()" disabled>
                            Skip This Step
                        </button>
                    </div>
                </div>

                <!-- Step 3: Deploy Agents -->
                <div class="deployment-step" id="deploy-step-3" style="opacity: 0.5;">
                    <div class="step-header">
                        <h4>Step 3: Deploy AI Agents</h4>
                        <span class="step-status" id="step3-status">Waiting</span>
                    </div>
                    <p>Finally, we'll deploy all your selected agents with their required services.</p>
                    
                    <div class="form-group">
                        <label>Environment</label>
                        <select id="environment" disabled>
                            <option value="dev">Development</option>
                            <option value="staging">Staging</option>
                            <option value="production">Production</option>
                        </select>
                    </div>

                    <button class="btn btn-azure" id="deployAgentsBtn" onclick="agentDeployment.deployAgents()" disabled>
                        <svg style="width: 16px; height: 16px;" viewBox="0 0 18 18">
                            <path fill="white" d="M0 0h18v18H0z" opacity="0"/>
                            <path fill="currentColor" d="M9.75 2.5l4.5 3.2v8.8c0 .28-.22.5-.5.5h-10a.5.5 0 01-.5-.5V5.7l4.5-3.2V5H6.5v2.25H5.25V2.5h4.5zm2.25 9V7.67L13.25 9v2.5H12zm-3.25 0V9h1.5v2.5h-1.5zm-3.5 0V9L6.5 7.67V11.5H5.25z"/>
                        </svg>
                        Deploy All Agents
                    </button>
                </div>
            </div>

            <!-- Quick Deploy Section -->
            <div class="config-section" id="quickDeploySection" style="display: none;">
                <h3>Quick Deployment</h3>
                
                <div class="form-group">
                    <label for="quickDeploymentName">Deployment Name</label>
                    <input type="text" id="quickDeploymentName" placeholder="e.g., production-agents">
                    <p class="help-text">This will be used as the resource group name in Azure</p>
                </div>

                <div class="form-group">
                    <label for="quickLocation">Azure Region</label>
                    <select id="quickLocation">
                        <option value="eastus">East US</option>
                        <option value="westus2">West US 2</option>
                        <option value="centralus">Central US</option>
                        <option value="westeurope">West Europe</option>
                        <option value="northeurope">North Europe</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="quickEnvironment">Environment</label>
                    <select id="quickEnvironment">
                        <option value="dev">Development</option>
                        <option value="staging">Staging</option>
                        <option value="production">Production</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="quickOpenaiEndpoint">Azure OpenAI Endpoint</label>
                    <input type="text" id="quickOpenaiEndpoint" 
                           placeholder="https://your-resource.openai.azure.com/">
                    <p class="help-text">Your Azure OpenAI resource endpoint</p>
                </div>

                <h3 style="margin-top: 2rem;">Deployment Preview</h3>
                <div class="code-preview" id="deploymentPreview">
                    <!-- JSON preview will be shown here -->
                </div>

                <div style="display: flex; gap: 1rem; margin-top: 2rem;">
                    <button class="btn btn-primary" onclick="agentDeployment.generateDeployment(event)">
                        Generate Deployment
                    </button>
                    <button class="btn btn-azure" onclick="agentDeployment.deployToAzure()">
                        <svg style="width: 20px; height: 20px;" viewBox="0 0 18 18">
                            <path fill="white" d="M0 0h18v18H0z" opacity="0"/>
                            <path fill="currentColor" d="M9.75 2.5l4.5 3.2v8.8c0 .28-.22.5-.5.5h-10a.5.5 0 01-.5-.5V5.7l4.5-3.2V5H6.5v2.25H5.25V2.5h4.5zm2.25 9V7.67L13.25 9v2.5H12zm-3.25 0V9h1.5v2.5h-1.5zm-3.5 0V9L6.5 7.67V11.5H5.25z"/>
                        </svg>
                        Deploy to Azure
                    </button>
                </div>
            </div>

            <!-- Deployment Status -->
            <div class="config-section" id="deploymentStatus" style="display: none;">
                <h3>Deployment Status</h3>
                <div class="deployment-log" id="deploymentLog">
                    <!-- Deployment progress will be shown here -->
                </div>
            </div>

            <div style="display: flex; gap: 1rem; margin-top: 2rem;">
                <button class="btn btn-secondary" onclick="agentDeployment.goToStep(1)">
                    ‚Üê Back to Selection
                </button>
                <button class="btn btn-secondary" onclick="agentDeployment.downloadDeploymentPackage()">
                    üì• Download Deployment Package
                </button>
            </div>
        </div>

        <!-- Step 3: Deployment Progress -->
        <div id="step3-content" class="deployment-config" style="display: none;">
            <h2>Deployment Complete</h2>
            <div id="deploymentCompleteContent">
                <!-- Deployment completion content will be shown here -->
            </div>
        </div>
    </div>

    <!-- Agent Details Modal -->
    <div class="modal" id="agentModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalAgentName">Agent Details</h2>
                <button class="close-btn" onclick="agentDeployment.closeModal()">√ó</button>
            </div>
            <div id="modalContent">
                <!-- Agent details will be loaded here -->
            </div>
        </div>
    </div>

    <script>
        class AgentDeployment {
            constructor() {
                // GitHub configuration
                this.GITHUB_OWNER = 'kody-w';
                this.GITHUB_REPO = 'AI-Agent-Library';
                this.AGENT_FILES_URL = `https://raw.githubusercontent.com/${this.GITHUB_OWNER}/${this.GITHUB_REPO}/main/agents/`;

                // State management
                this.agentsLibrary = [];
                this.selectedAgents = new Set();
                this.currentStep = 1;
                this.deploymentConfig = {
                    name: '',
                    location: 'eastus',
                    environment: 'dev',
                    openaiEndpoint: '',
                    openaiResourceName: '',
                    deploymentModel: 'gpt-4',
                    agents: [],
                    resourceGroupCreated: false,
                    openaiDeployed: false
                };

                // Initialize
                this.init();
            }

            async init() {
                try {
                    await this.loadAgentsLibrary();
                    this.renderAgents();
                } catch (error) {
                    console.error('Failed to load agents:', error);
                    this.showError('Failed to load agent library');
                }
            }

            async loadAgentsLibrary() {
                try {
                    // Check if GitHub repo is configured
                    if (this.GITHUB_OWNER === 'YOUR-GITHUB-USERNAME' || this.GITHUB_REPO === 'YOUR-REPO-NAME') {
                        console.log('GitHub repository not configured. Using mock data.');
                        document.getElementById('configNotice').style.display = 'block';
                        this.loadMockAgents();
                        return;
                    }

                    // Try to get the list of files in the agents directory
                    const response = await fetch(`https://api.github.com/repos/${this.GITHUB_OWNER}/${this.GITHUB_REPO}/contents/agents`);
                    
                    if (!response.ok) {
                        console.log(`GitHub API returned ${response.status}. Using mock data.`);
                        this.loadMockAgents();
                        return;
                    }
                    
                    const files = await response.json();
                    const pythonFiles = files.filter(file => file.name.endsWith('.py'));
                    
                    if (pythonFiles.length === 0) {
                        console.log('No Python files found in /agents directory. Using mock data.');
                        this.loadMockAgents();
                        return;
                    }
                    
                    // Load each Python file and extract metadata
                    const agents = await Promise.all(pythonFiles.map(async (file) => {
                        try {
                            const fileResponse = await fetch(file.download_url);
                            const content = await fileResponse.text();
                            return this.extractAgentMetadata(content, file.name);
                        } catch (error) {
                            console.error(`Error loading ${file.name}:`, error);
                            return null;
                        }
                    }));
                    
                    this.agentsLibrary = agents.filter(agent => agent !== null);
                    
                    if (this.agentsLibrary.length === 0) {
                        this.loadMockAgents();
                    }
                } catch (error) {
                    console.error('Error fetching agents:', error);
                    this.loadMockAgents();
                }
            }

            extractAgentMetadata(pythonContent, filename) {
                const metadataRegex = /"""[\s\S]*?"""/;
                const match = pythonContent.match(metadataRegex);
                
                if (!match) return null;
                
                const docstring = match[0];
                
                const extractField = (fieldName, defaultValue = '') => {
                    const regex = new RegExp(`${fieldName}:\\s*(.+)`, 'i');
                    const fieldMatch = docstring.match(regex);
                    return fieldMatch ? fieldMatch[1].trim() : defaultValue;
                };
                
                const extractList = (fieldName) => {
                    const value = extractField(fieldName);
                    return value ? value.split(',').map(item => item.trim()) : [];
                };
                
                const agentId = filename.replace('.py', '').replace(/_/g, '-');
                
                return {
                    id: agentId,
                    name: extractField('Agent', agentId),
                    type: extractField('Type', 'conversational'),
                    department: extractField('Department', 'operations'),
                    complexity: extractField('Complexity', 'medium'),
                    description: extractField('Description', 'AI Agent'),
                    capabilities: extractList('Capabilities'),
                    requirements: {
                        azure_services: extractList('Azure Services'),
                        dependencies: extractList('Dependencies'),
                        estimated_cost: parseInt(extractField('Estimated Cost', '100'))
                    },
                    file: filename,
                    config: {
                        environment_variables: extractList('Environment Variables')
                    }
                };
            }

            loadMockAgents() {
                this.agentsLibrary = [
                    {
                        id: 'voice-to-crm',
                        name: 'Voice to CRM Agent',
                        type: 'conversational',
                        department: 'sales',
                        complexity: 'medium',
                        description: 'Converts voice recordings to CRM entries using speech-to-text and natural language processing.',
                        capabilities: ['Speech Recognition', 'NLP', 'CRM Integration', 'Multi-language'],
                        requirements: {
                            azure_services: ['Cognitive Services', 'Function Apps', 'Storage Account'],
                            dependencies: ['azure-cognitiveservices-speech', 'openai', 'dynamics365'],
                            estimated_cost: 150
                        },
                        file: 'voice_to_crm.py',
                        config: {
                            environment_variables: [
                                'SPEECH_KEY',
                                'SPEECH_REGION',
                                'OPENAI_API_KEY',
                                'CRM_ENDPOINT'
                            ]
                        }
                    },
                    {
                        id: 'email-classifier',
                        name: 'Email Intelligence Agent',
                        type: 'analytical',
                        department: 'operations',
                        complexity: 'low',
                        description: 'Classifies and routes emails based on content, sentiment, and priority.',
                        capabilities: ['Email Processing', 'Classification', 'Sentiment Analysis', 'Auto-routing'],
                        requirements: {
                            azure_services: ['Logic Apps', 'Cognitive Services', 'Service Bus'],
                            dependencies: ['openai', 'sendgrid', 'microsoft-graph'],
                            estimated_cost: 75
                        },
                        file: 'email_classifier.py',
                        config: {
                            environment_variables: [
                                'OPENAI_API_KEY',
                                'GRAPH_CLIENT_ID',
                                'GRAPH_CLIENT_SECRET'
                            ]
                        }
                    },
                    {
                        id: 'hr-onboarding',
                        name: 'HR Onboarding Assistant',
                        type: 'automation',
                        department: 'hr',
                        complexity: 'high',
                        description: 'Automates employee onboarding with document processing and task orchestration.',
                        capabilities: ['Document Processing', 'Workflow Automation', 'Task Management', 'Integration'],
                        requirements: {
                            azure_services: ['Logic Apps', 'Form Recognizer', 'Key Vault', 'Storage'],
                            dependencies: ['azure-ai-formrecognizer', 'microsoft-graph', 'power-automate'],
                            estimated_cost: 200
                        },
                        file: 'hr_onboarding.py',
                        config: {
                            environment_variables: [
                                'FORM_RECOGNIZER_KEY',
                                'FORM_RECOGNIZER_ENDPOINT',
                                'GRAPH_API_KEY'
                            ]
                        }
                    },
                    {
                        id: 'expense-analyzer',
                        name: 'Expense Report Analyzer',
                        type: 'extraction',
                        department: 'finance',
                        complexity: 'medium',
                        description: 'Extracts and validates expense data from receipts and invoices.',
                        capabilities: ['OCR', 'Data Extraction', 'Validation', 'Reporting'],
                        requirements: {
                            azure_services: ['Form Recognizer', 'Logic Apps', 'Cosmos DB'],
                            dependencies: ['azure-ai-formrecognizer', 'pandas', 'reportlab'],
                            estimated_cost: 100
                        },
                        file: 'expense_analyzer.py',
                        config: {
                            environment_variables: [
                                'FORM_RECOGNIZER_KEY',
                                'COSMOS_DB_CONNECTION',
                                'STORAGE_CONNECTION'
                            ]
                        }
                    },
                    {
                        id: 'customer-sentiment',
                        name: 'Customer Sentiment Monitor',
                        type: 'monitoring',
                        department: 'sales',
                        complexity: 'low',
                        description: 'Monitors customer interactions across channels for sentiment and satisfaction.',
                        capabilities: ['Sentiment Analysis', 'Real-time Monitoring', 'Alerting', 'Dashboard'],
                        requirements: {
                            azure_services: ['Event Hubs', 'Stream Analytics', 'Power BI'],
                            dependencies: ['azure-eventhub', 'textblob', 'plotly'],
                            estimated_cost: 120
                        },
                        file: 'customer_sentiment.py',
                        config: {
                            environment_variables: [
                                'EVENT_HUB_CONNECTION',
                                'COGNITIVE_SERVICE_KEY',
                                'POWERBI_WORKSPACE'
                            ]
                        }
                    }
                ];
            }

            renderAgents(agents = this.agentsLibrary) {
                const grid = document.getElementById('agentGrid');
                
                if (agents.length === 0) {
                    grid.innerHTML = '<p style="text-align: center; color: #666;">No agents found</p>';
                    return;
                }

                grid.innerHTML = agents.map(agent => `
                    <div class="agent-card ${this.selectedAgents.has(agent.id) ? 'selected' : ''}" 
                         onclick="agentDeployment.toggleAgent('${agent.id}')"
                         id="agent-${agent.id}">
                        <div class="agent-header">
                            <h3 class="agent-name">${agent.name}</h3>
                            <p class="agent-type">${agent.type} | ${agent.department}</p>
                        </div>
                        <p class="agent-description">${agent.description}</p>
                        <div class="agent-tags">
                            ${agent.capabilities.slice(0, 3).map(cap => 
                                `<span class="tag capability">${cap}</span>`
                            ).join('')}
                            <span class="tag">$${agent.requirements.estimated_cost}/mo</span>
                        </div>
                        <button class="btn btn-secondary" style="margin-top: 1rem; font-size: 0.9rem;"
                                onclick="event.stopPropagation(); agentDeployment.showAgentDetails('${agent.id}')">
                            View Details
                        </button>
                    </div>
                `).join('');
            }

            toggleAgent(agentId) {
                if (this.selectedAgents.has(agentId)) {
                    this.selectedAgents.delete(agentId);
                    document.getElementById(`agent-${agentId}`).classList.remove('selected');
                } else {
                    this.selectedAgents.add(agentId);
                    document.getElementById(`agent-${agentId}`).classList.add('selected');
                }
                this.updateSelectionSidebar();
            }

            updateSelectionSidebar() {
                const count = this.selectedAgents.size;
                document.getElementById('selectedCount').textContent = count;
                
                const list = document.getElementById('selectedAgentsList');
                const proceedBtn = document.getElementById('proceedBtn');
                
                if (count === 0) {
                    list.innerHTML = '<p style="color: #666; text-align: center;">No agents selected</p>';
                    proceedBtn.disabled = true;
                } else {
                    proceedBtn.disabled = false;
                    const selectedAgentDetails = Array.from(this.selectedAgents).map(id => 
                        this.agentsLibrary.find(a => a.id === id)
                    );
                    
                    list.innerHTML = selectedAgentDetails.map(agent => `
                        <div class="selected-agent-item">
                            <div>
                                <div class="selected-agent-name">${agent.name}</div>
                                <div style="font-size: 0.85rem; color: #666;">
                                    $${agent.requirements.estimated_cost}/mo
                                </div>
                            </div>
                            <button class="remove-btn" onclick="agentDeployment.toggleAgent('${agent.id}')">
                                √ó
                            </button>
                        </div>
                    `).join('');
                }
            }

            searchAgents() {
                const searchTerm = document.getElementById('searchInput').value.toLowerCase();
                const filtered = this.agentsLibrary.filter(agent => 
                    agent.name.toLowerCase().includes(searchTerm) ||
                    agent.description.toLowerCase().includes(searchTerm) ||
                    agent.capabilities.some(cap => cap.toLowerCase().includes(searchTerm))
                );
                this.renderAgents(filtered);
            }

            filterAgents() {
                const type = document.getElementById('typeFilter').value;
                const department = document.getElementById('departmentFilter').value;
                const complexity = document.getElementById('complexityFilter').value;

                let filtered = [...this.agentsLibrary];

                if (type) filtered = filtered.filter(a => a.type === type);
                if (department) filtered = filtered.filter(a => a.department === department);
                if (complexity) filtered = filtered.filter(a => a.complexity === complexity);

                this.renderAgents(filtered);
            }

            selectPreset(preset) {
                this.clearSelection();
                
                const presets = {
                    sales: ['voice-to-crm', 'customer-sentiment'],
                    hr: ['hr-onboarding', 'expense-analyzer']
                };

                const agentIds = presets[preset] || [];
                agentIds.forEach(id => {
                    if (this.agentsLibrary.find(a => a.id === id)) {
                        this.toggleAgent(id);
                    }
                });
            }

            clearSelection() {
                this.selectedAgents.forEach(id => {
                    document.getElementById(`agent-${id}`).classList.remove('selected');
                });
                this.selectedAgents.clear();
                this.updateSelectionSidebar();
            }

            showAgentDetails(agentId) {
                const agent = this.agentsLibrary.find(a => a.id === agentId);
                if (!agent) return;

                document.getElementById('modalAgentName').textContent = agent.name;
                document.getElementById('modalContent').innerHTML = `
                    <div style="margin-bottom: 1.5rem;">
                        <p style="font-size: 1.1rem; margin-bottom: 1rem;">${agent.description}</p>
                        <div style="display: flex; gap: 1rem; margin-bottom: 1rem;">
                            <span class="tag" style="background: #e3f2fd; color: #1565c0;">
                                ${agent.type}
                            </span>
                            <span class="tag" style="background: #f3e5f5; color: #7b1fa2;">
                                ${agent.department}
                            </span>
                            <span class="tag" style="background: #e8f5e9; color: #388e3c;">
                                ${agent.complexity} complexity
                            </span>
                        </div>
                    </div>

                    <h4 style="color: #0078d4; margin-bottom: 0.5rem;">Capabilities</h4>
                    <ul style="margin-bottom: 1.5rem;">
                        ${agent.capabilities.map(cap => `<li>${cap}</li>`).join('')}
                    </ul>

                    <h4 style="color: #0078d4; margin-bottom: 0.5rem;">Azure Services Required</h4>
                    <ul style="margin-bottom: 1.5rem;">
                        ${agent.requirements.azure_services.map(service => `<li>${service}</li>`).join('')}
                    </ul>

                    <h4 style="color: #0078d4; margin-bottom: 0.5rem;">Dependencies</h4>
                    <div style="margin-bottom: 1.5rem;">
                        ${agent.requirements.dependencies.map(dep => 
                            `<span class="tag" style="margin-right: 0.5rem; margin-bottom: 0.5rem;">${dep}</span>`
                        ).join('')}
                    </div>

                    <h4 style="color: #0078d4; margin-bottom: 0.5rem;">Configuration</h4>
                    <div class="code-preview" style="font-size: 0.85rem;">
                        Environment Variables:<br>
                        ${agent.config.environment_variables.map(env => `- ${env}`).join('<br>')}
                    </div>

                    <div style="text-align: center; margin-top: 2rem; padding-top: 1.5rem; border-top: 1px solid #e0e0e0;">
                        <h3 style="color: #0078d4;">Estimated Cost: $${agent.requirements.estimated_cost}/month</h3>
                    </div>
                `;

                document.getElementById('agentModal').style.display = 'flex';
            }

            closeModal() {
                document.getElementById('agentModal').style.display = 'none';
            }

            proceedToConfiguration() {
                if (this.selectedAgents.size === 0) return;

                // Update step indicator
                this.goToStep(2);

                // Populate configuration
                this.updateConfigurationSummary();
                
                // Store selected agents
                const selectedAgentDetails = Array.from(this.selectedAgents).map(id => 
                    this.agentsLibrary.find(a => a.id === id)
                );
                this.deploymentConfig.agents = selectedAgentDetails;
            }

            showStepByStep() {
                document.getElementById('stepByStepSection').style.display = 'block';
                document.getElementById('quickDeploySection').style.display = 'none';
                document.getElementById('deploymentStatus').style.display = 'block';
                
                // Check if user wants to skip prerequisites
                if (confirm('Do you already have a Resource Group and Azure OpenAI deployed? Click OK to skip setup steps.')) {
                    this.enableAllSteps();
                }
            }

            showQuickDeploy() {
                document.getElementById('stepByStepSection').style.display = 'none';
                document.getElementById('quickDeploySection').style.display = 'block';
                this.generateDeploymentPreview();
            }

            enableAllSteps() {
                document.getElementById('deploy-step-1').style.opacity = '1';
                document.getElementById('deploy-step-2').style.opacity = '1';
                document.getElementById('deploy-step-3').style.opacity = '1';
                document.getElementById('deployOpenAIBtn').disabled = false;
                document.getElementById('skipOpenAIBtn').disabled = false;
                document.getElementById('openaiResourceName').disabled = false;
                document.getElementById('openaiEndpointGroup').style.display = 'block';
                document.getElementById('deployAgentsBtn').disabled = false;
                document.getElementById('environment').disabled = false;
                
                this.addDeploymentLog('info', 'Prerequisites check skipped - all steps enabled');
            }

            // Step-by-step deployment methods
            skipResourceGroup() {
                const resourceGroupName = document.getElementById('deploymentName').value;
                
                if (!resourceGroupName) {
                    alert('Please enter your existing resource group name');
                    return;
                }

                this.deploymentConfig.name = resourceGroupName;
                this.deploymentConfig.location = document.getElementById('location').value;
                this.deploymentConfig.resourceGroupCreated = true;
                
                const step1Status = document.getElementById('step1-status');
                step1Status.textContent = 'Completed';
                step1Status.className = 'step-status completed';
                document.getElementById('deploy-step-1').classList.add('completed');
                this.addDeploymentLog('success', `Using existing resource group: ${resourceGroupName}`);
                
                document.getElementById('deploy-step-2').style.opacity = '1';
                document.getElementById('deployOpenAIBtn').disabled = false;
                document.getElementById('skipOpenAIBtn').disabled = false;
                document.getElementById('openaiResourceName').disabled = false;
                document.getElementById('openaiEndpointGroup').style.display = 'block';
            }

            skipOpenAI() {
                const openaiEndpoint = document.getElementById('existingOpenaiEndpoint').value;
                const openaiResourceName = document.getElementById('openaiResourceName').value;
                
                if (!openaiEndpoint && !openaiResourceName) {
                    alert('Please enter either your OpenAI resource name or endpoint URL');
                    return;
                }

                if (!openaiEndpoint && openaiResourceName) {
                    this.deploymentConfig.openaiEndpoint = `https://${openaiResourceName}.openai.azure.com/`;
                    this.deploymentConfig.openaiResourceName = openaiResourceName;
                } else if (openaiEndpoint) {
                    this.deploymentConfig.openaiEndpoint = openaiEndpoint;
                    const match = openaiEndpoint.match(/https:\/\/(.+?)\.openai\.azure\.com/);
                    if (match) {
                        this.deploymentConfig.openaiResourceName = match[1];
                    } else {
                        this.deploymentConfig.openaiResourceName = openaiResourceName || 'custom-openai';
                    }
                }

                this.deploymentConfig.openaiDeployed = true;
                
                const step2Status = document.getElementById('step2-status');
                step2Status.textContent = 'Completed';
                step2Status.className = 'step-status completed';
                document.getElementById('deploy-step-2').classList.add('completed');
                
                this.addDeploymentLog('success', `Using existing Azure OpenAI service`);
                this.addDeploymentLog('info', `Endpoint: ${this.deploymentConfig.openaiEndpoint}`);
                
                document.getElementById('deploy-step-3').style.opacity = '1';
                document.getElementById('deployAgentsBtn').disabled = false;
                document.getElementById('environment').disabled = false;
            }

            async createResourceGroup() {
                const resourceGroupName = document.getElementById('deploymentName').value;
                const location = document.getElementById('location').value;

                if (!resourceGroupName) {
                    alert('Please enter a resource group name');
                    return;
                }

                const step1Status = document.getElementById('step1-status');
                step1Status.textContent = 'In Progress';
                step1Status.className = 'step-status in-progress';
                this.addDeploymentLog('info', `Creating resource group: ${resourceGroupName}...`);

                this.deploymentConfig.name = resourceGroupName;
                this.deploymentConfig.location = location;

                const subscriptionId = prompt('Please enter your Azure Subscription ID (you can find this in Azure Portal):');
                
                if (!subscriptionId) {
                    step1Status.textContent = 'Not Started';
                    step1Status.className = 'step-status';
                    this.addDeploymentLog('error', 'Subscription ID is required');
                    return;
                }

                const portalUrl = `https://portal.azure.com/#create/Microsoft.ResourceGroup/subscriptionId/${subscriptionId}/resourceGroupName/${resourceGroupName}/location/${location}`;
                
                window.open(portalUrl, '_blank');

                setTimeout(() => {
                    const confirmed = confirm(`Have you created the resource group '${resourceGroupName}' in Azure Portal?`);
                    
                    if (confirmed) {
                        this.deploymentConfig.resourceGroupCreated = true;
                        this.deploymentConfig.subscriptionId = subscriptionId;
                        
                        step1Status.textContent = 'Completed';
                        step1Status.className = 'step-status completed';
                        document.getElementById('deploy-step-1').classList.add('completed');
                        this.addDeploymentLog('success', `Resource group '${resourceGroupName}' created successfully`);
                        
                        document.getElementById('deploy-step-2').style.opacity = '1';
                        document.getElementById('deployOpenAIBtn').disabled = false;
                        document.getElementById('openaiResourceName').disabled = false;
                    } else {
                        step1Status.textContent = 'Not Started';
                        step1Status.className = 'step-status';
                        this.addDeploymentLog('info', 'Resource group creation cancelled');
                    }
                }, 1000);
            }

            async deployOpenAI() {
                const openaiResourceName = document.getElementById('openaiResourceName').value;

                if (!openaiResourceName) {
                    alert('Please enter an OpenAI resource name');
                    return;
                }

                const step2Status = document.getElementById('step2-status');
                step2Status.textContent = 'In Progress';
                step2Status.className = 'step-status in-progress';
                this.addDeploymentLog('info', `Preparing Azure OpenAI deployment...`);

                const deploymentFiles = this.generateOpenAIDeploymentFiles(openaiResourceName, this.deploymentConfig.location);

                this.showDeploymentModal('Azure OpenAI Deployment', `
                    <h4>Deploy Azure OpenAI Service</h4>
                    <p>Follow these steps to deploy Azure OpenAI:</p>
                    
                    <ol>
                        <li>Click the button below to open Azure Portal</li>
                        <li>Select "Build your own template in the editor"</li>
                        <li>Copy and paste the template below</li>
                        <li>Click "Save" and then "Create"</li>
                    </ol>
                    
                    <div class="code-preview" style="max-height: 300px; margin: 1rem 0;">
                        ${JSON.stringify(deploymentFiles.template, null, 2)}
                    </div>
                    
                    <button class="btn btn-azure" onclick="window.open('https://portal.azure.com/#create/Microsoft.Template', '_blank')">
                        Open Azure Portal
                    </button>
                    
                    <div style="margin-top: 1rem;">
                        <button class="btn btn-primary" onclick="agentDeployment.confirmOpenAIDeployment('${openaiResourceName}')">
                            I've Deployed OpenAI
                        </button>
                    </div>
                `);
            }

            generateOpenAIDeploymentFiles(resourceName, location) {
                const template = {
                    "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                        "accountName": {
                            "type": "string",
                            "defaultValue": resourceName,
                            "metadata": {
                                "description": "Name for the Azure OpenAI resource"
                            }
                        },
                        "location": {
                            "type": "string",
                            "defaultValue": location,
                            "metadata": {
                                "description": "Location for the resource"
                            }
                        }
                    },
                    "resources": [
                        {
                            "type": "Microsoft.CognitiveServices/accounts",
                            "apiVersion": "2023-05-01",
                            "name": "[parameters('accountName')]",
                            "location": "[parameters('location')]",
                            "sku": {
                                "name": "S0"
                            },
                            "kind": "OpenAI",
                            "properties": {
                                "customSubDomainName": "[parameters('accountName')]",
                                "publicNetworkAccess": "Enabled"
                            }
                        },
                        {
                            "type": "Microsoft.CognitiveServices/accounts/deployments",
                            "apiVersion": "2023-05-01",
                            "name": "[concat(parameters('accountName'), '/gpt-4')]",
                            "dependsOn": [
                                "[resourceId('Microsoft.CognitiveServices/accounts', parameters('accountName'))]"
                            ],
                            "properties": {
                                "model": {
                                    "format": "OpenAI",
                                    "name": "gpt-4",
                                    "version": "0613"
                                },
                                "scaleSettings": {
                                    "scaleType": "Standard"
                                }
                            }
                        }
                    ],
                    "outputs": {
                        "endpoint": {
                            "type": "string",
                            "value": "[reference(resourceId('Microsoft.CognitiveServices/accounts', parameters('accountName'))).endpoint]"
                        }
                    }
                };

                return { template };
            }

            confirmOpenAIDeployment(resourceName) {
                this.closeDeploymentModal();
                
                const step2Status = document.getElementById('step2-status');
                step2Status.textContent = 'Completed';
                step2Status.className = 'step-status completed';
                document.getElementById('deploy-step-2').classList.add('completed');
                
                this.deploymentConfig.openaiDeployed = true;
                this.deploymentConfig.openaiResourceName = resourceName;
                this.deploymentConfig.openaiEndpoint = `https://${resourceName}.openai.azure.com/`;
                
                this.addDeploymentLog('success', `Azure OpenAI service configured`);
                this.addDeploymentLog('info', `Endpoint: ${this.deploymentConfig.openaiEndpoint}`);
                
                document.getElementById('deploy-step-3').style.opacity = '1';
                document.getElementById('deployAgentsBtn').disabled = false;
                document.getElementById('environment').disabled = false;
            }

            async deployAgents() {
                const environment = document.getElementById('environment').value;
                
                const step3Status = document.getElementById('step3-status');
                step3Status.textContent = 'In Progress';
                step3Status.className = 'step-status in-progress';
                this.addDeploymentLog('info', `Preparing deployment for ${this.selectedAgents.size} agents...`);

                try {
                    const selectedAgentDetails = Array.from(this.selectedAgents).map(id => 
                        this.agentsLibrary.find(a => a.id === id)
                    );

                    this.showDeploymentModal('Fetching Agent Code', `
                        <div class="loading">
                            <div class="spinner"></div>
                            <p>Fetching agent code from GitHub...</p>
                        </div>
                    `);

                    const agentsWithCode = await Promise.all(selectedAgentDetails.map(async (agent) => {
                        try {
                            const response = await fetch(`${this.AGENT_FILES_URL}${agent.file}`);
                            const pythonCode = await response.text();
                            this.addDeploymentLog('success', `Fetched code for ${agent.name}`);
                            return { ...agent, pythonCode };
                        } catch (error) {
                            this.addDeploymentLog('error', `Failed to fetch ${agent.file}`);
                            return { ...agent, pythonCode: this.generatePlaceholderCode(agent) };
                        }
                    }));

                    this.deploymentConfig.agents = agentsWithCode;
                    this.deploymentConfig.environment = environment;

                    const armTemplate = await this.generateCompleteDeploymentTemplate();

                    this.showDeploymentModal('Deploy AI Agents', `
                        <h4>Deploy Your AI Agents</h4>
                        <p>Final step! Deploy all your selected agents:</p>
                        
                        <div style="background: #f0f8ff; padding: 1rem; border-radius: 8px; margin: 1rem 0;">
                            <h5>Selected Agents (${agentsWithCode.length}):</h5>
                            ${agentsWithCode.map(agent => `
                                <div style="margin: 0.5rem 0;">
                                    ‚Ä¢ ${agent.name} (${agent.type})
                                </div>
                            `).join('')}
                        </div>
                        
                        <ol>
                            <li>Click "Download Template" below</li>
                            <li>Click "Open Azure Portal"</li>
                            <li>Select "Build your own template in the editor"</li>
                            <li>Copy the template from the download</li>
                            <li>Click "Save" and then "Create"</li>
                        </ol>
                        
                        <div style="display: flex; gap: 1rem; margin-top: 1.5rem;">
                            <button class="btn btn-primary" onclick="agentDeployment.downloadArmTemplate()">
                                üì• Download Template
                            </button>
                            <button class="btn btn-azure" onclick="window.open('https://portal.azure.com/#create/Microsoft.Template', '_blank')">
                                Open Azure Portal
                            </button>
                        </div>
                        
                        <div style="margin-top: 1rem;">
                            <button class="btn btn-success" onclick="agentDeployment.confirmAgentDeployment()">
                                ‚úì I've Deployed the Agents
                            </button>
                        </div>
                    `);

                } catch (error) {
                    step3Status.textContent = 'Error';
                    step3Status.className = 'step-status error';
                    this.addDeploymentLog('error', `Deployment preparation failed: ${error.message}`);
                }
            }

            async generateCompleteDeploymentTemplate() {
                const deploymentName = this.deploymentConfig.name;
                const location = this.deploymentConfig.location;
                const environment = this.deploymentConfig.environment;

                const armTemplate = {
                    "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                        "deploymentPrefix": {
                            "type": "string",
                            "defaultValue": deploymentName,
                            "metadata": {
                                "description": "Prefix for all resources"
                            }
                        }
                    },
                    "variables": {
                        "storageAccountName": "[toLower(concat(parameters('deploymentPrefix'), 'storage', uniqueString(resourceGroup().id)))]",
                        "appServicePlanName": "[concat(parameters('deploymentPrefix'), '-plan')]",
                        "keyVaultName": "[concat(parameters('deploymentPrefix'), '-kv')]",
                        "openAIEndpoint": this.deploymentConfig.openaiEndpoint
                    },
                    "resources": [
                        {
                            "type": "Microsoft.KeyVault/vaults",
                            "apiVersion": "2021-06-01-preview",
                            "name": "[variables('keyVaultName')]",
                            "location": location,
                            "properties": {
                                "sku": {
                                    "family": "A",
                                    "name": "standard"
                                },
                                "tenantId": "[subscription().tenantId]",
                                "accessPolicies": []
                            }
                        },
                        {
                            "type": "Microsoft.Storage/storageAccounts",
                            "apiVersion": "2021-04-01",
                            "name": "[variables('storageAccountName')]",
                            "location": location,
                            "sku": {
                                "name": "Standard_LRS"
                            },
                            "kind": "StorageV2"
                        },
                        {
                            "type": "Microsoft.Web/serverfarms",
                            "apiVersion": "2021-01-15",
                            "name": "[variables('appServicePlanName')]",
                            "location": location,
                            "sku": {
                                "name": environment === 'production' ? "P1v2" : "B1",
                                "tier": environment === 'production' ? "PremiumV2" : "Basic"
                            },
                            "properties": {
                                "reserved": true
                            }
                        }
                    ]
                };

                // Add Function App for each agent
                this.deploymentConfig.agents.forEach(agent => {
                    const functionAppName = `[concat(parameters('deploymentPrefix'), '-${agent.id}')]`;
                    
                    const functionAppResource = {
                        "type": "Microsoft.Web/sites",
                        "apiVersion": "2021-01-15",
                        "name": functionAppName,
                        "location": location,
                        "kind": "functionapp,linux",
                        "dependsOn": [
                            "[resourceId('Microsoft.Web/serverfarms', variables('appServicePlanName'))]",
                            "[resourceId('Microsoft.Storage/storageAccounts', variables('storageAccountName'))]"
                        ],
                        "properties": {
                            "serverFarmId": "[resourceId('Microsoft.Web/serverfarms', variables('appServicePlanName'))]",
                            "siteConfig": {
                                "appSettings": [
                                    {
                                        "name": "AzureWebJobsStorage",
                                        "value": "[concat('DefaultEndpointsProtocol=https;AccountName=', variables('storageAccountName'), ';AccountKey=', listKeys(resourceId('Microsoft.Storage/storageAccounts', variables('storageAccountName')), '2021-04-01').keys[0].value)]"
                                    },
                                    {
                                        "name": "FUNCTIONS_EXTENSION_VERSION",
                                        "value": "~4"
                                    },
                                    {
                                        "name": "FUNCTIONS_WORKER_RUNTIME",
                                        "value": "python"
                                    },
                                    {
                                        "name": "OPENAI_ENDPOINT",
                                        "value": "[variables('openAIEndpoint')]"
                                    }
                                ],
                                "linuxFxVersion": "PYTHON|3.9"
                            }
                        }
                    };

                    armTemplate.resources.push(functionAppResource);

                    // Add agent-specific Azure services
                    if (agent.requirements.azure_services.includes('Cognitive Services')) {
                        armTemplate.resources.push({
                            "type": "Microsoft.CognitiveServices/accounts",
                            "apiVersion": "2021-10-01",
                            "name": `[concat(parameters('deploymentPrefix'), '-${agent.id}-cognitive')]`,
                            "location": location,
                            "sku": {
                                "name": "S0"
                            },
                            "kind": "CognitiveServices"
                        });
                    }

                    if (agent.requirements.azure_services.includes('Logic Apps')) {
                        armTemplate.resources.push({
                            "type": "Microsoft.Logic/workflows",
                            "apiVersion": "2019-05-01",
                            "name": `[concat(parameters('deploymentPrefix'), '-${agent.id}-logic')]`,
                            "location": location,
                            "properties": {
                                "state": "Enabled",
                                "definition": {
                                    "$schema": "https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#",
                                    "contentVersion": "1.0.0.0",
                                    "triggers": {},
                                    "actions": {}
                                }
                            }
                        });
                    }

                    if (agent.requirements.azure_services.includes('Form Recognizer')) {
                        armTemplate.resources.push({
                            "type": "Microsoft.CognitiveServices/accounts",
                            "apiVersion": "2021-10-01",
                            "name": `[concat(parameters('deploymentPrefix'), '-${agent.id}-formrecognizer')]`,
                            "location": location,
                            "sku": {
                                "name": "S0"
                            },
                            "kind": "FormRecognizer"
                        });
                    }

                    if (agent.requirements.azure_services.includes('Cosmos DB')) {
                        armTemplate.resources.push({
                            "type": "Microsoft.DocumentDB/databaseAccounts",
                            "apiVersion": "2021-10-15",
                            "name": `[concat(parameters('deploymentPrefix'), '-${agent.id}-cosmos')]`,
                            "location": location,
                            "properties": {
                                "databaseAccountOfferType": "Standard",
                                "locations": [
                                    {
                                        "locationName": location,
                                        "failoverPriority": 0
                                    }
                                ]
                            }
                        });
                    }
                });

                this.deploymentConfig.armTemplate = armTemplate;
                return armTemplate;
            }

            generatePlaceholderCode(agent) {
                return `"""
Agent: ${agent.name}
Type: ${agent.type}
Department: ${agent.department}
Description: ${agent.description}
Note: Failed to fetch actual code from GitHub
"""

import azure.functions as func
import logging

def main(req: func.HttpRequest) -> func.HttpResponse:
    logging.info('${agent.name} processing request')
    return func.HttpResponse("Agent placeholder", status_code=200)
`;
            }

            downloadArmTemplate() {
                const filename = `${this.deploymentConfig.name}-agents-template.json`;
                this.downloadJSON(this.deploymentConfig.armTemplate, filename);
                this.addDeploymentLog('info', `Template downloaded: ${filename}`);
            }

            confirmAgentDeployment() {
                this.closeDeploymentModal();
                
                const step3Status = document.getElementById('step3-status');
                step3Status.textContent = 'Completed';
                step3Status.className = 'step-status completed';
                document.getElementById('deploy-step-3').classList.add('completed');
                
                this.addDeploymentLog('success', `All agents deployed successfully!`);
                this.addDeploymentLog('info', 'üéâ Deployment complete! Your AI agents are ready to use.');
                
                this.showDeploymentSummary();
            }

            showDeploymentModal(title, content) {
                const existingModal = document.getElementById('deploymentModal');
                if (existingModal) {
                    existingModal.remove();
                }

                const modal = document.createElement('div');
                modal.id = 'deploymentModal';
                modal.className = 'modal';
                modal.style.display = 'flex';
                modal.innerHTML = `
                    <div class="modal-content" style="max-width: 800px;">
                        <div class="modal-header">
                            <h2>${title}</h2>
                            <button class="close-btn" onclick="agentDeployment.closeDeploymentModal()">√ó</button>
                        </div>
                        <div style="padding: 1rem 0;">
                            ${content}
                        </div>
                    </div>
                `;
                document.body.appendChild(modal);
            }

            closeDeploymentModal() {
                const modal = document.getElementById('deploymentModal');
                if (modal) {
                    modal.remove();
                }
            }

            showDeploymentSummary() {
                this.goToStep(3);
                
                const summaryContent = `
                    <div style="background: #d4edda; padding: 1.5rem; border-radius: 8px; margin-bottom: 2rem;">
                        <h3 style="color: #155724; margin-bottom: 0.5rem;">‚úÖ Deployment Successful!</h3>
                        <p style="margin: 0; color: #155724;">Your AI agents are now deployed and ready to use.</p>
                    </div>
                    
                    <h3>Deployed Resources:</h3>
                    <ul style="margin-bottom: 2rem;">
                        <li><strong>Resource Group:</strong> ${this.deploymentConfig.name}</li>
                        <li><strong>Azure OpenAI:</strong> ${this.deploymentConfig.openaiResourceName}</li>
                        <li><strong>Endpoint:</strong> ${this.deploymentConfig.openaiEndpoint}</li>
                        <li><strong>Environment:</strong> ${this.deploymentConfig.environment}</li>
                        <li><strong>Agents:</strong> ${this.deploymentConfig.agents.length} deployed</li>
                    </ul>
                    
                    <h3>Deployed Agents:</h3>
                    <div style="display: grid; gap: 1rem; margin-bottom: 2rem;">
                        ${this.deploymentConfig.agents.map(agent => `
                            <div style="background: #f8f9fa; padding: 1rem; border-radius: 8px;">
                                <h4 style="margin-bottom: 0.5rem; color: #0078d4;">${agent.name}</h4>
                                <p style="margin-bottom: 0.5rem;">${agent.description}</p>
                                <div style="font-size: 0.9rem; color: #666;">
                                    Function App: ${this.deploymentConfig.name}-${agent.id}
                                </div>
                            </div>
                        `).join('')}
                    </div>
                    
                    <h3>Next Steps:</h3>
                    <ol style="margin-bottom: 2rem;">
                        <li>Go to Azure Portal and navigate to your resource group</li>
                        <li>Configure API keys for each Function App</li>
                        <li>Test your agents using the Function App URLs</li>
                        <li>Monitor performance using Azure Application Insights</li>
                    </ol>
                    
                    <div style="display: flex; gap: 1rem;">
                        <button class="btn btn-primary" onclick="agentDeployment.downloadDeploymentPackage()">
                            üì• Download Complete Package
                        </button>
                        <button class="btn btn-azure" onclick="window.open('https://portal.azure.com/', '_blank')">
                            Open Azure Portal
                        </button>
                        <button class="btn btn-secondary" onclick="agentDeployment.startOver()">
                            Deploy More Agents
                        </button>
                    </div>
                `;
                
                document.getElementById('deploymentCompleteContent').innerHTML = summaryContent;
            }

            // Quick deployment methods
            async generateDeployment(event) {
                this.showLoading(true, 'Generating deployment...');

                try {
                    this.deploymentConfig.name = document.getElementById('quickDeploymentName').value || 'agent-deployment';
                    this.deploymentConfig.location = document.getElementById('quickLocation').value;
                    this.deploymentConfig.environment = document.getElementById('quickEnvironment').value;
                    this.deploymentConfig.openaiEndpoint = document.getElementById('quickOpenaiEndpoint').value;

                    const selectedAgentDetails = Array.from(this.selectedAgents).map(id => 
                        this.agentsLibrary.find(a => a.id === id)
                    );

                    const agentsWithCode = await Promise.all(selectedAgentDetails.map(async (agent) => {
                        try {
                            const response = await fetch(`${this.AGENT_FILES_URL}${agent.file}`);
                            const pythonCode = await response.text();
                            return { ...agent, pythonCode };
                        } catch (error) {
                            console.error(`Failed to fetch ${agent.file}:`, error);
                            return { ...agent, pythonCode: this.generatePlaceholderCode(agent) };
                        }
                    }));

                    this.deploymentConfig.agents = agentsWithCode;
                    await this.generateDeploymentPreview();

                    const deploymentPackage = {
                        armTemplate: this.deploymentConfig.armTemplate,
                        agents: agentsWithCode.map(agent => ({
                            id: agent.id,
                            name: agent.name,
                            file: agent.file,
                            pythonCode: agent.pythonCode
                        })),
                        deploymentScript: this.generateDeploymentScript(),
                        requirements: this.generateRequirements(),
                        readme: this.generateReadme()
                    };

                    this.downloadDeploymentPackage(deploymentPackage);
                } catch (error) {
                    console.error('Error generating deployment:', error);
                    alert('Failed to generate deployment. Please try again.');
                } finally {
                    this.showLoading(false);
                }
            }

            async generateDeploymentPreview() {
                const armTemplate = await this.generateCompleteDeploymentTemplate();
                document.getElementById('deploymentPreview').textContent = JSON.stringify(armTemplate, null, 2);
            }

            deployToAzure() {
                const armTemplateUrl = encodeURIComponent(
                    `https://raw.githubusercontent.com/${this.GITHUB_OWNER}/${this.GITHUB_REPO}/main/deployments/${this.deploymentConfig.name}/azuredeploy.json`
                );
                
                const azureDeployUrl = `https://portal.azure.com/#create/Microsoft.Template/uri/${armTemplateUrl}`;
                
                this.goToStep(3);
                
                setTimeout(() => {
                    window.open(azureDeployUrl, '_blank');
                }, 2000);
            }

            generateDeploymentScript() {
                return `#!/bin/bash
# Azure Multi-Agent Deployment Script
# Generated by Agent Library Deployment Tool

echo "Starting deployment of ${this.deploymentConfig.agents.length} agents..."

# Variables
RESOURCE_GROUP="${this.deploymentConfig.name}"
LOCATION="${this.deploymentConfig.location}"
DEPLOYMENT_NAME="${this.deploymentConfig.name}"

# Deploy ARM template
echo "Deploying Azure resources..."
az deployment group create \\
    --name $DEPLOYMENT_NAME \\
    --resource-group $RESOURCE_GROUP \\
    --template-file azuredeploy.json

# Deploy agent code to Function Apps
${this.deploymentConfig.agents.map(agent => `
echo "Deploying ${agent.name}..."
cd agents/${agent.id}
func azure functionapp publish $DEPLOYMENT_NAME-${agent.id}
cd ../..
`).join('\n')}

echo "Deployment complete!"
echo "Resource Group: $RESOURCE_GROUP"
echo "Agents deployed: ${this.deploymentConfig.agents.length}"
`;
            }

            generateRequirements() {
                const allDependencies = new Set();
                this.deploymentConfig.agents.forEach(agent => {
                    agent.requirements.dependencies.forEach(dep => {
                        allDependencies.add(dep);
                    });
                });

                return `# Python Requirements for Agent Deployment
azure-functions
${Array.from(allDependencies).join('\n')}
`;
            }

            generateReadme() {
                return `# Agent Deployment Package

This package contains ${this.deploymentConfig.agents.length} AI agents ready for deployment to Azure.

## Deployed Agents

${this.deploymentConfig.agents.map(agent => `
### ${agent.name}
- **Type**: ${agent.type}
- **Department**: ${agent.department}
- **Estimated Cost**: $${agent.requirements.estimated_cost}/month
- **Description**: ${agent.description}
`).join('\n')}

## Deployment Instructions

1. Install Azure CLI and Function Core Tools
2. Login to Azure: \`az login\`
3. Run the deployment script: \`./deploy.sh\`

## Configuration

Update the following environment variables in the Azure Portal:
${Array.from(new Set(this.deploymentConfig.agents.flatMap(a => a.config.environment_variables))).map(env => `- ${env}`).join('\n')}

## Support

For issues or questions, contact the AI Solutions team.
`;
            }

            downloadDeploymentPackage(deploymentPackage) {
                const timestamp = new Date().toISOString().split('T')[0];
                const filename = `agent-deployment-${this.deploymentConfig.name}-${timestamp}.json`;
                
                const blob = new Blob([JSON.stringify(deploymentPackage || this.deploymentConfig, null, 2)], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = filename;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);

                if (deploymentPackage) {
                    alert(`Deployment package downloaded!\n\nNext steps:\n1. Extract the package\n2. Review the configuration\n3. Run deploy.sh or click "Deploy to Azure"`);
                }
            }

            downloadJSON(data, filename) {
                const jsonStr = JSON.stringify(data, null, 2);
                const blob = new Blob([jsonStr], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = filename;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            }

            addDeploymentLog(type, message) {
                const logContainer = document.getElementById('deploymentLog');
                const deploymentStatus = document.getElementById('deploymentStatus');
                
                if (!deploymentStatus.style.display || deploymentStatus.style.display === 'none') {
                    deploymentStatus.style.display = 'block';
                }

                const timestamp = new Date().toLocaleTimeString();
                const logEntry = document.createElement('div');
                logEntry.className = 'log-entry';
                logEntry.innerHTML = `
                    <span class="log-timestamp">[${timestamp}]</span>
                    <span class="log-message log-${type}">${message}</span>
                `;
                
                logContainer.appendChild(logEntry);
                logContainer.scrollTop = logContainer.scrollHeight;
            }

            goToStep(step) {
                document.querySelectorAll('.workflow-step').forEach((el, index) => {
                    el.classList.remove('active', 'completed');
                    if (index < step - 1) {
                        el.classList.add('completed');
                    } else if (index === step - 1) {
                        el.classList.add('active');
                    }
                });

                document.getElementById('step1-content').style.display = 'none';
                document.getElementById('step2-content').style.display = 'none';
                document.getElementById('step3-content').style.display = 'none';

                if (step === 1) {
                    document.getElementById('step1-content').style.display = 'grid';
                } else if (step === 2) {
                    document.getElementById('step2-content').style.display = 'block';
                } else if (step === 3) {
                    document.getElementById('step3-content').style.display = 'block';
                }

                this.currentStep = step;
            }

            updateConfigurationSummary() {
                const selectedAgentDetails = Array.from(this.selectedAgents).map(id => 
                    this.agentsLibrary.find(a => a.id === id)
                );

                const totalCost = selectedAgentDetails.reduce((sum, agent) => 
                    sum + agent.requirements.estimated_cost, 0
                );
                document.getElementById('totalAgentsCount').textContent = selectedAgentDetails.length;
                document.getElementById('estimatedCost').textContent = `$${totalCost}`;
                document.getElementById('deploymentTime').textContent = 5 + (selectedAgentDetails.length * 2);

                const configList = document.getElementById('agentConfigList');
                configList.innerHTML = selectedAgentDetails.map(agent => `
                    <div style="background: #f8f9fa; padding: 1rem; border-radius: 6px; margin-bottom: 0.5rem;">
                        <h4 style="margin-bottom: 0.5rem;">${agent.name}</h4>
                        <div style="display: flex; gap: 1rem; font-size: 0.9rem; color: #666;">
                            <span>Type: ${agent.type}</span>
                            <span>Cost: $${agent.requirements.estimated_cost}/mo</span>
                            <span>File: ${agent.file}</span>
                        </div>
                    </div>
                `).join('');
            }

            showLoading(show, text = 'Loading...') {
                const btn = event?.target;
                if (btn && btn.classList.contains('btn')) {
                    if (show) {
                        btn.disabled = true;
                        btn.setAttribute('data-original-text', btn.textContent);
                        btn.textContent = text;
                    } else {
                        btn.disabled = false;
                        btn.textContent = btn.getAttribute('data-original-text') || 'Generate Deployment';
                    }
                }
            }

            startOver() {
                this.clearSelection();
                this.deploymentConfig = {
                    name: '',
                    location: 'eastus',
                    environment: 'dev',
                    openaiEndpoint: '',
                    openaiResourceName: '',
                    deploymentModel: 'gpt-4',
                    agents: [],
                    resourceGroupCreated: false,
                    openaiDeployed: false
                };
                this.goToStep(1);
                
                // Reset deployment steps
                document.querySelectorAll('.deployment-step').forEach(step => {
                    step.classList.remove('completed', 'active');
                    step.style.opacity = step.id === 'deploy-step-1' ? '1' : '0.5';
                });
                
                // Reset status indicators
                document.getElementById('step1-status').textContent = 'Not Started';
                document.getElementById('step1-status').className = 'step-status';
                document.getElementById('step2-status').textContent = 'Waiting';
                document.getElementById('step2-status').className = 'step-status';
                document.getElementById('step3-status').textContent = 'Waiting';
                document.getElementById('step3-status').className = 'step-status';
                
                // Clear deployment log
                document.getElementById('deploymentLog').innerHTML = '';
                document.getElementById('deploymentStatus').style.display = 'none';
            }

            showError(message) {
                console.error(message);
                alert(message);
            }
        }

        // Initialize when DOM is ready
        let agentDeployment;
        document.addEventListener('DOMContentLoaded', () => {
            agentDeployment = new AgentDeployment();

            // Close modal when clicking outside
            window.onclick = (event) => {
                const modal = document.getElementById('agentModal');
                if (event.target === modal) {
                    agentDeployment.closeModal();
                }
            };
        });
    </script>
</body>
</html>