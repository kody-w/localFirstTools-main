<!DOCTYPE html>
<html lang="en" data-clue-1="VGhlIGpvdXJuZXkgYmVnaW5zIGluIHRoZSBzaGFkb3dz">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Inspection Ritual</title>
    <meta name="description" content="The puzzle is the browser. The answer hides where developers dare to look.">
    <!-- tags: puzzle, arg, mystery, meta, devtools, secrets, experimental -->
    <!-- FRAGMENT_2: Look deeper. The console speaks when you listen. -->
    <style>
        /* CSS Custom Property Clue: --secret-3: "45 78 70 6c 6f 72 65 20 74 68 65 20 6e 65 74 77 6f 72 6b"; */
        :root {
            --ritual-color: #1a1a2e;
            --glow: #4a9eff;
            --warning: #ff6b6b;
            --secret-4: "Count the watchers. They number the path.";
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            background: var(--ritual-color);
            min-height: 100vh;
            font-family: 'Courier New', monospace;
            color: #666;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }

        .container {
            text-align: center;
            padding: 40px;
            max-width: 600px;
        }

        h1 {
            font-size: 2em;
            color: #444;
            margin-bottom: 20px;
            letter-spacing: 0.2em;
            /* Clue hidden in letter-spacing: 0.2 = 2nd letter of alphabet = B */
        }

        .glitch-text {
            position: relative;
            animation: glitch 2s infinite;
        }

        @keyframes glitch {
            0%, 90%, 100% { opacity: 1; transform: translateX(0); }
            92% { opacity: 0.8; transform: translateX(-2px); }
            94% { opacity: 0.6; transform: translateX(2px); }
            96% { opacity: 0.9; transform: translateX(-1px); }
        }

        .cryptic-message {
            margin: 30px 0;
            padding: 30px;
            border: 1px solid #333;
            background: rgba(0, 0, 0, 0.3);
            position: relative;
        }

        .cryptic-message::before {
            content: "ERROR_0x4F50454E";
            position: absolute;
            top: -10px;
            left: 20px;
            background: var(--ritual-color);
            padding: 0 10px;
            font-size: 0.7em;
            color: #ff6b6b;
        }

        .message-text {
            font-size: 0.9em;
            line-height: 1.8;
            color: #555;
        }

        .hidden-watcher {
            position: fixed;
            width: 4px;
            height: 4px;
            background: rgba(74, 158, 255, 0.3);
            border-radius: 50%;
            pointer-events: none;
            /* There are 7 watchers. 7 is a clue. */
        }

        /* Seven watchers hidden across the page */
        .watcher-1 { top: 10%; left: 5%; }
        .watcher-2 { top: 30%; right: 8%; }
        .watcher-3 { bottom: 15%; left: 12%; }
        .watcher-4 { top: 50%; right: 3%; }
        .watcher-5 { bottom: 40%; right: 15%; }
        .watcher-6 { top: 20%; left: 45%; }
        .watcher-7 { bottom: 5%; left: 50%; }

        .input-field {
            margin: 30px 0;
        }

        .input-field input {
            width: 100%;
            padding: 15px;
            background: rgba(0, 0, 0, 0.5);
            border: 1px solid #333;
            color: #aaa;
            font-family: inherit;
            font-size: 1em;
            text-align: center;
            letter-spacing: 0.1em;
        }

        .input-field input:focus {
            outline: none;
            border-color: var(--glow);
            box-shadow: 0 0 20px rgba(74, 158, 255, 0.2);
        }

        .input-field input::placeholder {
            color: #444;
        }

        .submit-btn {
            padding: 15px 50px;
            background: transparent;
            border: 1px solid #444;
            color: #666;
            font-family: inherit;
            font-size: 1em;
            cursor: pointer;
            transition: all 0.3s ease;
            letter-spacing: 0.1em;
        }

        .submit-btn:hover {
            border-color: var(--glow);
            color: var(--glow);
        }

        .result {
            margin-top: 30px;
            padding: 20px;
            opacity: 0;
            transition: opacity 0.5s ease;
        }

        .result.visible {
            opacity: 1;
        }

        .result.success {
            color: #4ecdc4;
            border: 1px solid #4ecdc4;
        }

        .result.failure {
            color: #ff6b6b;
            border: 1px solid #ff6b6b;
        }

        .hint-text {
            margin-top: 40px;
            font-size: 0.75em;
            color: #333;
        }

        .progress-bar {
            margin: 20px 0;
            height: 4px;
            background: #222;
            border-radius: 2px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            width: 0%;
            background: linear-gradient(90deg, #4a9eff, #4ecdc4);
            transition: width 0.5s ease;
        }

        .fragment-display {
            margin: 20px 0;
            padding: 15px;
            background: rgba(74, 158, 255, 0.1);
            border-radius: 5px;
            font-size: 0.85em;
        }

        .fragment {
            display: inline-block;
            padding: 3px 8px;
            margin: 3px;
            background: rgba(74, 158, 255, 0.2);
            border-radius: 3px;
            color: #4a9eff;
        }

        .fragment.found {
            background: rgba(78, 205, 196, 0.3);
            color: #4ecdc4;
        }

        .victory-screen {
            display: none;
        }

        .victory-screen.visible {
            display: block;
            animation: fadeIn 1s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .victory-title {
            font-size: 2em;
            color: #4ecdc4;
            margin-bottom: 20px;
        }

        /* Hidden element only visible in DevTools */
        .devtools-only {
            position: fixed;
            top: -9999px;
            left: -9999px;
            /* When you find this: The final answer is the first letter of each fragment, in order. */
        }
    </style>
</head>
<body>
    <!-- Watchers observe your journey -->
    <div class="hidden-watcher watcher-1" data-fragment="O"></div>
    <div class="hidden-watcher watcher-2" data-fragment="P"></div>
    <div class="hidden-watcher watcher-3" data-fragment="E"></div>
    <div class="hidden-watcher watcher-4" data-fragment="N"></div>
    <div class="hidden-watcher watcher-5" data-fragment="E"></div>
    <div class="hidden-watcher watcher-6" data-fragment="Y"></div>
    <div class="hidden-watcher watcher-7" data-fragment="E"></div>

    <div class="devtools-only" id="secretHint">
        <!-- CONGRATULATIONS, INSPECTOR. You found the hidden element.
             The watchers each hold a letter. Count them: 7.
             Their data-fragment attributes spell something.
             O-P-E-N-E-Y-E... but what is OPENEYE?
             The answer to enter below is: OPENEYES (add the S from "seekers")
        -->
    </div>

    <div class="container">
        <div class="main-puzzle" id="mainPuzzle">
            <h1 class="glitch-text">THE INSPECTION RITUAL</h1>

            <div class="cryptic-message">
                <p class="message-text">
                    This page is broken.<br><br>
                    Or is it?<br><br>
                    The truth hides in layers visible only to those who know where to look.
                    Developers see what users cannot. The browser speaks in whispers.
                    <br><br>
                    <span style="color: #444;">Find the seven watchers. Collect the fragments. Speak the word.</span>
                </p>
            </div>

            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>

            <div class="fragment-display">
                <span>Fragments found: </span>
                <span id="fragmentDisplay">
                    <span class="fragment" id="f1">?</span>
                    <span class="fragment" id="f2">?</span>
                    <span class="fragment" id="f3">?</span>
                    <span class="fragment" id="f4">?</span>
                    <span class="fragment" id="f5">?</span>
                    <span class="fragment" id="f6">?</span>
                    <span class="fragment" id="f7">?</span>
                    <span class="fragment" id="f8" style="opacity: 0.3;">S</span>
                </span>
            </div>

            <div class="input-field">
                <input type="text" id="answerInput" placeholder="Enter the word..." autocomplete="off" spellcheck="false">
            </div>

            <button class="submit-btn" id="submitBtn">SUBMIT</button>

            <div class="result" id="result"></div>

            <div class="hint-text">
                <p>Hint: Press F12. Right-click â†’ Inspect. The ritual awaits.</p>
                <p style="margin-top: 10px;">Type <code style="color: #4a9eff;">I'm lost</code> in the console for guidance.</p>
            </div>
        </div>

        <div class="victory-screen" id="victoryScreen">
            <div class="victory-title">THE RITUAL IS COMPLETE</div>
            <p style="color: #888; margin: 20px 0; line-height: 1.8;">
                You have proven yourself a true inspector of the digital realm.
                <br><br>
                The seven watchers revealed their fragments: O-P-E-N-E-Y-E
                <br>
                Combined with the seeker's mark (S), the word was spoken.
                <br><br>
                <span style="color: #4ecdc4;">OPENEYES</span> - To see beyond the surface.
            </p>

            <div style="margin: 30px 0; padding: 20px; border: 1px solid #333;">
                <p style="color: #666; font-size: 0.9em;">Your journey:</p>
                <p style="color: #4a9eff; margin-top: 10px;" id="journeyStats"></p>
            </div>

            <button class="submit-btn" onclick="location.reload()">BEGIN ANEW</button>
        </div>
    </div>

    <script>
        // The Inspection Ritual - An ARG that teaches web inspection

        const state = {
            fragmentsFound: new Set(),
            attempts: 0,
            startTime: Date.now(),
            consoleOpened: false,
            elementsInspected: 0
        };

        const fragments = ['O', 'P', 'E', 'N', 'E', 'Y', 'E'];
        const finalAnswer = 'OPENEYES';

        // Console messages for those who open DevTools
        console.log('%cðŸ”® THE RITUAL BEGINS', 'color: #4a9eff; font-size: 20px; font-weight: bold;');
        console.log('%cWelcome, Inspector. You have taken the first step.', 'color: #888;');
        console.log('');
        console.log('%cCLUE 1: The page contains seven hidden watchers.', 'color: #4ecdc4;');
        console.log('%cCLUE 2: Each watcher holds a fragment in its data-attribute.', 'color: #4ecdc4;');
        console.log('%cCLUE 3: The fragments spell a word. Add "S" to complete it.', 'color: #4ecdc4;');
        console.log('');
        console.log('%cType: document.querySelectorAll(".hidden-watcher")', 'color: #feca57;');
        console.log('%cOr simply inspect the elements to find their secrets.', 'color: #888;');

        // Track if DevTools might be open (approximate)
        let devToolsOpen = false;

        const checkDevTools = () => {
            const threshold = 160;
            const widthThreshold = window.outerWidth - window.innerWidth > threshold;
            const heightThreshold = window.outerHeight - window.innerHeight > threshold;

            if (widthThreshold || heightThreshold) {
                if (!devToolsOpen) {
                    devToolsOpen = true;
                    console.log('%câœ“ DevTools detected! You\'re on the right path.', 'color: #4ecdc4;');
                    state.consoleOpened = true;
                }
            }
        };

        setInterval(checkDevTools, 500);

        // Special console command
        window["I'm lost"] = function() {
            console.log('%cðŸ“ GUIDANCE FOR THE LOST', 'color: #feca57; font-size: 16px;');
            console.log('');
            console.log('1. Look at the HTML structure. Find elements with class "hidden-watcher"');
            console.log('2. Each watcher has a "data-fragment" attribute with a letter');
            console.log('3. The letters spell: O-P-E-N-E-Y-E');
            console.log('4. The 8th fragment "S" is shown in the UI (for "seekers")');
            console.log('5. Enter "OPENEYES" in the input field');
            console.log('');
            console.log('%cThe answer is: OPENEYES', 'color: #4ecdc4; font-size: 14px;');
        };

        // Also allow just typing it
        Object.defineProperty(window, 'hint', {
            get: function() {
                console.log('%cHint: Inspect the .hidden-watcher elements. Look at data-fragment.', 'color: #4a9eff;');
                return 'Check the console';
            }
        });

        // Track element inspection (when elements are clicked/selected)
        document.querySelectorAll('.hidden-watcher').forEach((watcher, index) => {
            // Create a MutationObserver to detect when element is inspected
            // (This is approximate - DevTools inspection doesn't trigger events)

            watcher.addEventListener('click', () => {
                const fragment = watcher.dataset.fragment;
                if (!state.fragmentsFound.has(index)) {
                    state.fragmentsFound.add(index);
                    document.getElementById(`f${index + 1}`).textContent = fragment;
                    document.getElementById(`f${index + 1}`).classList.add('found');
                    updateProgress();
                    console.log(`%câœ“ Fragment ${index + 1} found: ${fragment}`, 'color: #4ecdc4;');
                }
            });
        });

        // Helper function to reveal fragments for those inspecting
        window.revealFragment = function(index) {
            if (index < 1 || index > 7) return 'Invalid index (1-7)';
            const fragment = fragments[index - 1];
            state.fragmentsFound.add(index - 1);
            document.getElementById(`f${index}`).textContent = fragment;
            document.getElementById(`f${index}`).classList.add('found');
            updateProgress();
            return `Fragment ${index}: ${fragment}`;
        };

        // Console helper
        window.showAllFragments = function() {
            fragments.forEach((f, i) => revealFragment(i + 1));
            return 'All fragments revealed: ' + fragments.join('-');
        };

        function updateProgress() {
            const progress = (state.fragmentsFound.size / 7) * 100;
            document.getElementById('progressFill').style.width = progress + '%';
        }

        // Answer submission
        document.getElementById('submitBtn').addEventListener('click', checkAnswer);
        document.getElementById('answerInput').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') checkAnswer();
        });

        function checkAnswer() {
            const input = document.getElementById('answerInput').value.toUpperCase().trim();
            const result = document.getElementById('result');
            state.attempts++;

            if (input === finalAnswer) {
                // Victory!
                result.textContent = 'THE WORD IS SPOKEN. THE RITUAL IS COMPLETE.';
                result.className = 'result visible success';

                setTimeout(() => {
                    document.getElementById('mainPuzzle').style.display = 'none';
                    document.getElementById('victoryScreen').classList.add('visible');

                    const elapsed = Math.round((Date.now() - state.startTime) / 1000);
                    document.getElementById('journeyStats').innerHTML = `
                        Time: ${elapsed} seconds<br>
                        Attempts: ${state.attempts}<br>
                        Console accessed: ${state.consoleOpened ? 'Yes' : 'No'}<br>
                        Fragments discovered: ${state.fragmentsFound.size}/7
                    `;

                    console.log('%cðŸŽ‰ RITUAL COMPLETE!', 'color: #4ecdc4; font-size: 24px;');
                    console.log('You have mastered the art of inspection.');
                }, 2000);

            } else if (input === 'OPENEYE') {
                result.textContent = 'So close... but something is missing. Remember the seekers.';
                result.className = 'result visible failure';
            } else if (input.length > 0) {
                const hints = [
                    'The watchers hold the answer.',
                    'Have you inspected the hidden elements?',
                    'Seven letters from the watchers, one from the seekers.',
                    'O-P-E-N-E-Y-E + S',
                    'The answer is literally in the elements.'
                ];
                const hint = hints[Math.min(state.attempts - 1, hints.length - 1)];
                result.textContent = `Incorrect. ${hint}`;
                result.className = 'result visible failure';
            }
        }

        // Easter egg: clicking the glitch text
        document.querySelector('.glitch-text').addEventListener('click', () => {
            console.log('%cðŸ‘ï¸ The title sees you looking.', 'color: #ff6b6b;');
            console.log('Hint: Right-click on the small glowing dots. Or inspect them.');
        });

        // Make watchers slightly more visible on hover (desktop)
        document.querySelectorAll('.hidden-watcher').forEach(w => {
            w.style.cursor = 'pointer';
            w.addEventListener('mouseenter', () => {
                w.style.background = 'rgba(74, 158, 255, 0.8)';
                w.style.width = '8px';
                w.style.height = '8px';
            });
            w.addEventListener('mouseleave', () => {
                w.style.background = 'rgba(74, 158, 255, 0.3)';
                w.style.width = '4px';
                w.style.height = '4px';
            });
        });

        // Network tab Easter egg - fake request with clue
        if (window.fetch) {
            // This won't actually fetch, but appears in network tab attempts
            setTimeout(() => {
                try {
                    fetch('/api/ritual/clue?answer=look_at_data_attributes').catch(() => {});
                } catch(e) {}
            }, 3000);
        }

        // Initial state - auto-reveal the 8th fragment
        document.getElementById('f8').classList.add('found');
    </script>
</body>
</html>
