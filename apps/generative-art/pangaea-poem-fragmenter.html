<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pangaea Poem Fragmenter</title>
    <meta name="description" content="Watch your poetry drift apart as continents split over 250 million years">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { background: #0a1525; min-height: 100vh; font-family: Georgia, serif; color: #c0d0e0; overflow: hidden; }
        #canvas { position: fixed; top: 0; left: 0; }
        #controls {
            position: fixed; top: 20px; left: 20px; background: rgba(10,30,50,0.9);
            padding: 20px; border-radius: 10px; border: 1px solid rgba(100,150,200,0.3); z-index: 100; width: 280px;
        }
        h3 { margin-bottom: 15px; color: #a0c0e0; }
        textarea {
            width: 100%; height: 120px; padding: 10px; background: rgba(20,40,60,0.8);
            border: 1px solid rgba(100,150,200,0.3); color: #c0d0e0; border-radius: 5px;
            font-family: Georgia, serif; font-size: 14px; resize: none;
        }
        button {
            display: block; width: 100%; padding: 10px; margin: 8px 0;
            background: rgba(50,100,150,0.4); border: 1px solid rgba(100,150,200,0.4);
            color: #a0c0e0; cursor: pointer; border-radius: 8px;
        }
        #timeline {
            position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%);
            background: rgba(10,30,50,0.9); padding: 15px 40px; border-radius: 10px;
            border: 1px solid rgba(100,150,200,0.3); text-align: center;
        }
        #era { font-size: 18px; color: #a0c0e0; }
        #years { font-size: 12px; opacity: 0.6; margin-top: 5px; }
        input[type="range"] { width: 200px; margin-top: 10px; }
        #fragments {
            position: fixed; top: 20px; right: 20px; background: rgba(10,30,50,0.9);
            padding: 15px; border-radius: 10px; border: 1px solid rgba(100,150,200,0.3);
            max-height: 300px; overflow-y: auto; width: 200px; font-size: 12px;
        }
        .fragment { margin: 5px 0; padding: 5px; background: rgba(50,80,120,0.3); border-radius: 3px; }
    </style>
</head>
<body>
    <canvas id="canvas"></canvas>
    <div id="controls">
        <h3>Write Your Poem on Pangaea</h3>
        <textarea id="poem-input" placeholder="Enter your poem here...
Each line will be placed on a different tectonic plate..."></textarea>
        <button id="fragment-btn">Begin Continental Drift</button>
        <button id="reset-btn">Reform Pangaea</button>
    </div>
    <div id="timeline">
        <div id="era">Pangaea United</div>
        <div id="years">250 Million Years Ago</div>
        <input type="range" id="time-slider" min="0" max="250" value="0">
    </div>
    <div id="fragments">
        <h4 style="margin-bottom:10px">Drifted Fragments</h4>
        <div id="fragment-list"></div>
    </div>
    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        let W, H;
        function resize() { W = canvas.width = innerWidth; H = canvas.height = innerHeight; }
        resize(); window.onresize = resize;

        let plates = [];
        let driftTime = 0;
        let drifting = false;

        const continentColors = [
            'rgba(139, 90, 43, 0.8)', 'rgba(160, 100, 50, 0.8)',
            'rgba(180, 120, 60, 0.8)', 'rgba(150, 95, 45, 0.8)',
            'rgba(170, 110, 55, 0.8)', 'rgba(145, 85, 40, 0.8)'
        ];

        class TectonicPlate {
            constructor(x, y, text, index) {
                this.originX = x; this.originY = y;
                this.x = x; this.y = y;
                this.text = text;
                this.index = index;
                this.angle = (index / 6) * Math.PI * 2;
                this.driftSpeed = 0.5 + Math.random() * 0.5;
                this.rotation = 0;
                this.rotSpeed = (Math.random() - 0.5) * 0.001;
                this.width = 150 + text.length * 5;
                this.height = 80;
                this.color = continentColors[index % continentColors.length];
                this.vertices = this.generateShape();
            }
            generateShape() {
                const points = [];
                const sides = 6 + Math.floor(Math.random() * 4);
                for (let i = 0; i < sides; i++) {
                    const angle = (i / sides) * Math.PI * 2;
                    const r = 40 + Math.random() * 30;
                    points.push({
                        x: Math.cos(angle) * r * (this.width / 100),
                        y: Math.sin(angle) * r * (this.height / 80)
                    });
                }
                return points;
            }
            update(time) {
                const drift = time * this.driftSpeed * 0.5;
                this.x = this.originX + Math.cos(this.angle) * drift;
                this.y = this.originY + Math.sin(this.angle) * drift;
                this.rotation += this.rotSpeed * time * 0.01;
            }
            draw() {
                ctx.save();
                ctx.translate(this.x, this.y);
                ctx.rotate(this.rotation);
                ctx.beginPath();
                this.vertices.forEach((v, i) => {
                    if (i === 0) ctx.moveTo(v.x, v.y);
                    else ctx.lineTo(v.x, v.y);
                });
                ctx.closePath();
                ctx.fillStyle = this.color;
                ctx.fill();
                ctx.strokeStyle = 'rgba(80, 60, 40, 0.5)';
                ctx.lineWidth = 2;
                ctx.stroke();
                ctx.fillStyle = '#1a2a3a';
                ctx.font = '14px Georgia';
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                const words = this.text.split(' ');
                words.forEach((word, i) => {
                    ctx.fillText(word, 0, (i - words.length/2 + 0.5) * 18);
                });
                ctx.restore();
            }
        }

        function createPlates(poem) {
            plates = [];
            const lines = poem.split('\n').filter(l => l.trim());
            const cx = W / 2;
            const cy = H / 2;
            lines.forEach((line, i) => {
                const angle = (i / lines.length) * Math.PI * 2;
                const dist = 20 + Math.random() * 30;
                const x = cx + Math.cos(angle) * dist;
                const y = cy + Math.sin(angle) * dist;
                plates.push(new TectonicPlate(x, y, line.trim(), i));
            });
        }

        function updateFragmentList() {
            const list = document.getElementById('fragment-list');
            list.innerHTML = '';
            plates.forEach(p => {
                const div = document.createElement('div');
                div.className = 'fragment';
                div.textContent = p.text.substring(0, 25) + (p.text.length > 25 ? '...' : '');
                list.appendChild(div);
            });
        }

        function drawOcean() {
            const gradient = ctx.createRadialGradient(W/2, H/2, 0, W/2, H/2, Math.max(W, H));
            gradient.addColorStop(0, '#0a2540');
            gradient.addColorStop(1, '#051525');
            ctx.fillStyle = gradient;
            ctx.fillRect(0, 0, W, H);
            for (let i = 0; i < 50; i++) {
                ctx.beginPath();
                ctx.arc(Math.random() * W, Math.random() * H, 1, 0, Math.PI * 2);
                ctx.fillStyle = 'rgba(100, 150, 200, 0.1)';
                ctx.fill();
            }
        }

        function animate() {
            drawOcean();
            plates.forEach(p => {
                p.update(driftTime);
                p.draw();
            });
            if (drifting && driftTime < 250) {
                driftTime += 0.1;
                document.getElementById('time-slider').value = driftTime;
                updateTimeline();
            }
            requestAnimationFrame(animate);
        }

        function updateTimeline() {
            const mya = Math.round(250 - driftTime);
            document.getElementById('years').textContent = mya + ' Million Years Ago';
            if (driftTime < 50) document.getElementById('era').textContent = 'Pangaea Breaking';
            else if (driftTime < 100) document.getElementById('era').textContent = 'Gondwana & Laurasia';
            else if (driftTime < 180) document.getElementById('era').textContent = 'Continental Separation';
            else document.getElementById('era').textContent = 'Modern Configuration';
        }

        document.getElementById('fragment-btn').onclick = () => {
            const poem = document.getElementById('poem-input').value;
            if (poem.trim()) {
                createPlates(poem);
                updateFragmentList();
                drifting = true;
            }
        };

        document.getElementById('reset-btn').onclick = () => {
            driftTime = 0;
            drifting = false;
            const poem = document.getElementById('poem-input').value;
            if (poem.trim()) createPlates(poem);
            document.getElementById('time-slider').value = 0;
            updateTimeline();
        };

        document.getElementById('time-slider').oninput = e => {
            driftTime = parseFloat(e.target.value);
            drifting = false;
            updateTimeline();
        };

        document.getElementById('poem-input').value = "In the beginning we were one\nA single mass of dreams\nBut time pulled us apart\nAcross the silent seas\nNow fragments of our story\nFloat on separate shores";
        createPlates(document.getElementById('poem-input').value);
        updateFragmentList();
        animate();
    </script>
</body>
</html>